!function(){var t,e,s={5826:function(t,e,s){var i,n,r;r=this,i=[s(4749)],void 0===(n=function(t){return r.returnExportsGlobal=function(t){return function(t){"use strict";var e={axisTitle:"",axisClass:"ct-axis-title",offset:{x:0,y:0},textAnchor:"middle",flipTitle:!1},s={axisX:e,axisY:e},i=function(t){return t instanceof Function?t():t},n=function(t){return t instanceof Function?t():t};t.plugins=t.plugins||{},t.plugins.ctAxisTitle=function(e){return e=t.extend({},s,e),function(s){s.on("created",(function(s){if(!e.axisX.axisTitle&&!e.axisY.axisTitle)throw new Error("ctAxisTitle plugin - You must provide at least one axis title");if(!s.axisX&&!s.axisY)throw new Error("ctAxisTitle plugin can only be used on charts that have at least one axis");var r,o,a,l=t.normalizePadding(s.options.chartPadding);if(e.axisX.axisTitle&&s.axisX&&(r=s.axisX.axisLength/2+s.options.axisY.offset+l.left,o=l.top,"end"===s.options.axisY.position&&(r-=s.options.axisY.offset),"end"===s.options.axisX.position&&(o+=s.axisY.axisLength),(a=new t.Svg("text")).addClass(n(e.axisX.axisClass)),a.text(i(e.axisX.axisTitle)),a.attr({x:r+e.axisX.offset.x,y:o+e.axisX.offset.y,"text-anchor":e.axisX.textAnchor}),s.svg.append(a,!0)),e.axisY.axisTitle&&s.axisY){r=0,o=s.axisY.axisLength/2+l.top,"start"===s.options.axisX.position&&(o+=s.options.axisX.offset),"end"===s.options.axisY.position&&(r=s.axisX.axisLength);var c="rotate("+(e.axisY.flipTitle?-90:90)+", "+r+", "+o+")";(a=new t.Svg("text")).addClass(n(e.axisY.axisClass)),a.text(i(e.axisY.axisTitle)),a.attr({x:r+e.axisY.offset.x,y:o+e.axisY.offset.y,transform:c,"text-anchor":e.axisY.textAnchor}),s.svg.append(a,!0)}}))}}}(t),t.plugins.ctAxisTitle}(t)}.apply(e,i))||(t.exports=n)},1759:function(t,e,s){var i=s(4569),n=s(6889),r=s(4877),o=i.TypeError;t.exports=function(t){if(n(t))return t;throw o(r(t)+" is not a function")}},2605:function(t,e,s){var i=s(4569),n=s(6889),r=i.String,o=i.TypeError;t.exports=function(t){if("object"==typeof t||n(t))return t;throw o("Can't set "+r(t)+" as a prototype")}},8695:function(t){t.exports=function(){}},9730:function(t,e,s){var i=s(4569),n=s(397),r=i.TypeError;t.exports=function(t,e){if(n(e,t))return t;throw r("Incorrect invocation")}},6879:function(t,e,s){var i=s(4569),n=s(9574),r=i.String,o=i.TypeError;t.exports=function(t){if(n(t))return t;throw o(r(t)+" is not an object")}},9760:function(t,e,s){var i=s(7816),n=s(2005),r=s(2077),o=function(t){return function(e,s,o){var a,l=i(e),c=r(l),h=n(o,c);if(t&&s!=s){for(;c>h;)if((a=l[h++])!=a)return!0}else for(;c>h;h++)if((t||h in l)&&l[h]===s)return t||h||0;return!t&&-1}};t.exports={includes:o(!0),indexOf:o(!1)}},8937:function(t,e,s){var i=s(4569),n=s(2005),r=s(2077),o=s(592),a=i.Array,l=Math.max;t.exports=function(t,e,s){for(var i=r(t),c=n(e,i),h=n(void 0===s?i:s,i),u=a(l(h-c,0)),d=0;c<h;c++,d++)o(u,d,t[c]);return u.length=d,u}},4936:function(t,e,s){var i=s(8937),n=Math.floor,r=function(t,e){var s=t.length,l=n(s/2);return s<8?o(t,e):a(t,r(i(t,0,l),e),r(i(t,l),e),e)},o=function(t,e){for(var s,i,n=t.length,r=1;r<n;){for(i=r,s=t[r];i&&e(t[i-1],s)>0;)t[i]=t[--i];i!==r++&&(t[i]=s)}return t},a=function(t,e,s,i){for(var n=e.length,r=s.length,o=0,a=0;o<n||a<r;)t[o+a]=o<n&&a<r?i(e[o],s[a])<=0?e[o++]:s[a++]:o<n?e[o++]:s[a++];return t};t.exports=r},8154:function(t,e,s){var i=s(5169),n=i({}.toString),r=i("".slice);t.exports=function(t){return r(n(t),8,-1)}},5885:function(t,e,s){var i=s(4569),n=s(2401),r=s(6889),o=s(8154),a=s(2735)("toStringTag"),l=i.Object,c="Arguments"==o(function(){return arguments}());t.exports=n?o:function(t){var e,s,i;return void 0===t?"Undefined":null===t?"Null":"string"==typeof(s=function(t,e){try{return t[e]}catch(t){}}(e=l(t),a))?s:c?o(e):"Object"==(i=o(e))&&r(e.callee)?"Arguments":i}},5949:function(t,e,s){var i=s(8790);t.exports=!i((function(){function t(){}return t.prototype.constructor=null,Object.getPrototypeOf(new t)!==t.prototype}))},6745:function(t,e,s){"use strict";var i=s(3327).IteratorPrototype,n=s(4045),r=s(3196),o=s(6482),a=s(8830),l=function(){return this};t.exports=function(t,e,s,c){var h=e+" Iterator";return t.prototype=n(i,{next:r(+!c,s)}),o(t,h,!1,!0),a[h]=l,t}},8444:function(t,e,s){var i=s(41),n=s(6445),r=s(3196);t.exports=i?function(t,e,s){return n.f(t,e,r(1,s))}:function(t,e,s){return t[e]=s,t}},3196:function(t){t.exports=function(t,e){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:e}}},592:function(t,e,s){"use strict";var i=s(4773),n=s(6445),r=s(3196);t.exports=function(t,e,s){var o=i(e);o in t?n.f(t,o,r(0,s)):t[o]=s}},5329:function(t,e,s){"use strict";var i=s(1301),n=s(5784),r=s(1567),o=s(9717),a=s(6889),l=s(6745),c=s(6066),h=s(2370),u=s(6482),d=s(8444),p=s(1120),m=s(2735),g=s(8830),f=s(3327),v=o.PROPER,y=o.CONFIGURABLE,b=f.IteratorPrototype,x=f.BUGGY_SAFARI_ITERATORS,w=m("iterator"),k="keys",E="values",S="entries",L=function(){return this};t.exports=function(t,e,s,o,m,f,A){l(s,e,o);var C,M,_,T=function(t){if(t===m&&N)return N;if(!x&&t in I)return I[t];switch(t){case k:case E:case S:return function(){return new s(this,t)}}return function(){return new s(this)}},P=e+" Iterator",O=!1,I=t.prototype,j=I[w]||I["@@iterator"]||m&&I[m],N=!x&&j||T(m),U="Array"==e&&I.entries||j;if(U&&(C=c(U.call(new t)))!==Object.prototype&&C.next&&(r||c(C)===b||(h?h(C,b):a(C[w])||p(C,w,L)),u(C,P,!0,!0),r&&(g[P]=L)),v&&m==E&&j&&j.name!==E&&(!r&&y?d(I,"name",E):(O=!0,N=function(){return n(j,this)})),m)if(M={values:T(E),keys:f?N:T(k),entries:T(S)},A)for(_ in M)(x||O||!(_ in I))&&p(I,_,M[_]);else i({target:e,proto:!0,forced:x||O},M);return r&&!A||I[w]===N||p(I,w,N,{name:m}),g[e]=N,M}},41:function(t,e,s){var i=s(8790);t.exports=!i((function(){return 7!=Object.defineProperty({},1,{get:function(){return 7}})[1]}))},2167:function(t,e,s){var i=s(4569),n=s(9574),r=i.document,o=n(r)&&n(r.createElement);t.exports=function(t){return o?r.createElement(t):{}}},4317:function(t){t.exports={CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0}},3265:function(t,e,s){var i=s(5972);t.exports=i("navigator","userAgent")||""},6952:function(t,e,s){var i,n,r=s(4569),o=s(3265),a=r.process,l=r.Deno,c=a&&a.versions||l&&l.version,h=c&&c.v8;h&&(n=(i=h.split("."))[0]>0&&i[0]<4?1:+(i[0]+i[1])),!n&&o&&(!(i=o.match(/Edge\/(\d+)/))||i[1]>=74)&&(i=o.match(/Chrome\/(\d+)/))&&(n=+i[1]),t.exports=n},667:function(t){t.exports=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]},1301:function(t,e,s){"use strict";var i=s(4569),n=s(8505),r=s(5169),o=s(6889),a=s(2435).f,l=s(3730),c=s(6035),h=s(490),u=s(8444),d=s(4037),p=function(t){var e=function(s,i,r){if(this instanceof e){switch(arguments.length){case 0:return new t;case 1:return new t(s);case 2:return new t(s,i)}return new t(s,i,r)}return n(t,this,arguments)};return e.prototype=t.prototype,e};t.exports=function(t,e){var s,n,m,g,f,v,y,b,x=t.target,w=t.global,k=t.stat,E=t.proto,S=w?i:k?i[x]:(i[x]||{}).prototype,L=w?c:c[x]||u(c,x,{})[x],A=L.prototype;for(m in e)s=!l(w?m:x+(k?".":"#")+m,t.forced)&&S&&d(S,m),f=L[m],s&&(v=t.noTargetGet?(b=a(S,m))&&b.value:S[m]),g=s&&v?v:e[m],s&&typeof f==typeof g||(y=t.bind&&s?h(g,i):t.wrap&&s?p(g):E&&o(g)?r(g):g,(t.sham||g&&g.sham||f&&f.sham)&&u(y,"sham",!0),u(L,m,y),E&&(d(c,n=x+"Prototype")||u(c,n,{}),u(c[n],m,g),t.real&&A&&!A[m]&&u(A,m,g)))}},8790:function(t){t.exports=function(t){try{return!!t()}catch(t){return!0}}},8505:function(t,e,s){var i=s(519),n=Function.prototype,r=n.apply,o=n.call;t.exports="object"==typeof Reflect&&Reflect.apply||(i?o.bind(r):function(){return o.apply(r,arguments)})},490:function(t,e,s){var i=s(5169),n=s(1759),r=s(519),o=i(i.bind);t.exports=function(t,e){return n(t),void 0===e?t:r?o(t,e):function(){return t.apply(e,arguments)}}},519:function(t,e,s){var i=s(8790);t.exports=!i((function(){var t=function(){}.bind();return"function"!=typeof t||t.hasOwnProperty("prototype")}))},5784:function(t,e,s){var i=s(519),n=Function.prototype.call;t.exports=i?n.bind(n):function(){return n.apply(n,arguments)}},9717:function(t,e,s){var i=s(41),n=s(4037),r=Function.prototype,o=i&&Object.getOwnPropertyDescriptor,a=n(r,"name"),l=a&&"something"===function(){}.name,c=a&&(!i||i&&o(r,"name").configurable);t.exports={EXISTS:a,PROPER:l,CONFIGURABLE:c}},5169:function(t,e,s){var i=s(519),n=Function.prototype,r=n.bind,o=n.call,a=i&&r.bind(o,o);t.exports=i?function(t){return t&&a(t)}:function(t){return t&&function(){return o.apply(t,arguments)}}},5972:function(t,e,s){var i=s(6035),n=s(4569),r=s(6889),o=function(t){return r(t)?t:void 0};t.exports=function(t,e){return arguments.length<2?o(i[t])||o(n[t]):i[t]&&i[t][e]||n[t]&&n[t][e]}},1520:function(t,e,s){var i=s(5885),n=s(9732),r=s(8830),o=s(2735)("iterator");t.exports=function(t){if(null!=t)return n(t,o)||n(t,"@@iterator")||r[i(t)]}},7829:function(t,e,s){var i=s(4569),n=s(5784),r=s(1759),o=s(6879),a=s(4877),l=s(1520),c=i.TypeError;t.exports=function(t,e){var s=arguments.length<2?l(t):e;if(r(s))return o(n(s,t));throw c(a(t)+" is not iterable")}},9732:function(t,e,s){var i=s(1759);t.exports=function(t,e){var s=t[e];return null==s?void 0:i(s)}},4569:function(t,e,s){var i=function(t){return t&&t.Math==Math&&t};t.exports=i("object"==typeof globalThis&&globalThis)||i("object"==typeof window&&window)||i("object"==typeof self&&self)||i("object"==typeof s.g&&s.g)||function(){return this}()||Function("return this")()},4037:function(t,e,s){var i=s(5169),n=s(4267),r=i({}.hasOwnProperty);t.exports=Object.hasOwn||function(t,e){return r(n(t),e)}},5583:function(t){t.exports={}},1140:function(t,e,s){var i=s(5972);t.exports=i("document","documentElement")},3899:function(t,e,s){var i=s(41),n=s(8790),r=s(2167);t.exports=!i&&!n((function(){return 7!=Object.defineProperty(r("div"),"a",{get:function(){return 7}}).a}))},5769:function(t,e,s){var i=s(4569),n=s(5169),r=s(8790),o=s(8154),a=i.Object,l=n("".split);t.exports=r((function(){return!a("z").propertyIsEnumerable(0)}))?function(t){return"String"==o(t)?l(t,""):a(t)}:a},8304:function(t,e,s){var i=s(5169),n=s(6889),r=s(9047),o=i(Function.toString);n(r.inspectSource)||(r.inspectSource=function(t){return o(t)}),t.exports=r.inspectSource},975:function(t,e,s){var i,n,r,o=s(3693),a=s(4569),l=s(5169),c=s(9574),h=s(8444),u=s(4037),d=s(9047),p=s(3674),m=s(5583),g="Object already initialized",f=a.TypeError,v=a.WeakMap;if(o||d.state){var y=d.state||(d.state=new v),b=l(y.get),x=l(y.has),w=l(y.set);i=function(t,e){if(x(y,t))throw new f(g);return e.facade=t,w(y,t,e),e},n=function(t){return b(y,t)||{}},r=function(t){return x(y,t)}}else{var k=p("state");m[k]=!0,i=function(t,e){if(u(t,k))throw new f(g);return e.facade=t,h(t,k,e),e},n=function(t){return u(t,k)?t[k]:{}},r=function(t){return u(t,k)}}t.exports={set:i,get:n,has:r,enforce:function(t){return r(t)?n(t):i(t,{})},getterFor:function(t){return function(e){var s;if(!c(e)||(s=n(e)).type!==t)throw f("Incompatible receiver, "+t+" required");return s}}}},6889:function(t){t.exports=function(t){return"function"==typeof t}},3730:function(t,e,s){var i=s(8790),n=s(6889),r=/#|\.prototype\./,o=function(t,e){var s=l[a(t)];return s==h||s!=c&&(n(e)?i(e):!!e)},a=o.normalize=function(t){return String(t).replace(r,".").toLowerCase()},l=o.data={},c=o.NATIVE="N",h=o.POLYFILL="P";t.exports=o},9574:function(t,e,s){var i=s(6889);t.exports=function(t){return"object"==typeof t?null!==t:i(t)}},1567:function(t){t.exports=!0},3608:function(t,e,s){var i=s(4569),n=s(5972),r=s(6889),o=s(397),a=s(5699),l=i.Object;t.exports=a?function(t){return"symbol"==typeof t}:function(t){var e=n("Symbol");return r(e)&&o(e.prototype,l(t))}},3327:function(t,e,s){"use strict";var i,n,r,o=s(8790),a=s(6889),l=s(4045),c=s(6066),h=s(1120),u=s(2735),d=s(1567),p=u("iterator"),m=!1;[].keys&&("next"in(r=[].keys())?(n=c(c(r)))!==Object.prototype&&(i=n):m=!0),null==i||o((function(){var t={};return i[p].call(t)!==t}))?i={}:d&&(i=l(i)),a(i[p])||h(i,p,(function(){return this})),t.exports={IteratorPrototype:i,BUGGY_SAFARI_ITERATORS:m}},8830:function(t){t.exports={}},2077:function(t,e,s){var i=s(1547);t.exports=function(t){return i(t.length)}},7873:function(t,e,s){var i=s(6952),n=s(8790);t.exports=!!Object.getOwnPropertySymbols&&!n((function(){var t=Symbol();return!String(t)||!(Object(t)instanceof Symbol)||!Symbol.sham&&i&&i<41}))},8437:function(t,e,s){var i=s(8790),n=s(2735),r=s(1567),o=n("iterator");t.exports=!i((function(){var t=new URL("b?a=1&b=2&c=3","http://a"),e=t.searchParams,s="";return t.pathname="c%20d",e.forEach((function(t,i){e.delete("b"),s+=i+t})),r&&!t.toJSON||!e.sort||"http://a/c%20d?a=1&c=3"!==t.href||"3"!==e.get("c")||"a=1"!==String(new URLSearchParams("?a=1"))||!e[o]||"a"!==new URL("https://a@b").username||"b"!==new URLSearchParams(new URLSearchParams("a=b")).get("a")||"xn--e1aybc"!==new URL("http://тест").host||"#%D0%B1"!==new URL("http://a#б").hash||"a1c3"!==s||"x"!==new URL("http://x",void 0).host}))},3693:function(t,e,s){var i=s(4569),n=s(6889),r=s(8304),o=i.WeakMap;t.exports=n(o)&&/native code/.test(r(o))},4045:function(t,e,s){var i,n=s(6879),r=s(931),o=s(667),a=s(5583),l=s(1140),c=s(2167),h=s(3674),u=h("IE_PROTO"),d=function(){},p=function(t){return"<script>"+t+"</"+"script>"},m=function(t){t.write(p("")),t.close();var e=t.parentWindow.Object;return t=null,e},g=function(){try{i=new ActiveXObject("htmlfile")}catch(t){}var t,e;g="undefined"!=typeof document?document.domain&&i?m(i):((e=c("iframe")).style.display="none",l.appendChild(e),e.src=String("javascript:"),(t=e.contentWindow.document).open(),t.write(p("document.F=Object")),t.close(),t.F):m(i);for(var s=o.length;s--;)delete g.prototype[o[s]];return g()};a[u]=!0,t.exports=Object.create||function(t,e){var s;return null!==t?(d.prototype=n(t),s=new d,d.prototype=null,s[u]=t):s=g(),void 0===e?s:r.f(s,e)}},931:function(t,e,s){var i=s(41),n=s(7927),r=s(6445),o=s(6879),a=s(7816),l=s(2518);e.f=i&&!n?Object.defineProperties:function(t,e){o(t);for(var s,i=a(e),n=l(e),c=n.length,h=0;c>h;)r.f(t,s=n[h++],i[s]);return t}},6445:function(t,e,s){var i=s(4569),n=s(41),r=s(3899),o=s(7927),a=s(6879),l=s(4773),c=i.TypeError,h=Object.defineProperty,u=Object.getOwnPropertyDescriptor,d="enumerable",p="configurable",m="writable";e.f=n?o?function(t,e,s){if(a(t),e=l(e),a(s),"function"==typeof t&&"prototype"===e&&"value"in s&&m in s&&!s.writable){var i=u(t,e);i&&i.writable&&(t[e]=s.value,s={configurable:p in s?s.configurable:i.configurable,enumerable:d in s?s.enumerable:i.enumerable,writable:!1})}return h(t,e,s)}:h:function(t,e,s){if(a(t),e=l(e),a(s),r)try{return h(t,e,s)}catch(t){}if("get"in s||"set"in s)throw c("Accessors not supported");return"value"in s&&(t[e]=s.value),t}},2435:function(t,e,s){var i=s(41),n=s(5784),r=s(665),o=s(3196),a=s(7816),l=s(4773),c=s(4037),h=s(3899),u=Object.getOwnPropertyDescriptor;e.f=i?u:function(t,e){if(t=a(t),e=l(e),h)try{return u(t,e)}catch(t){}if(c(t,e))return o(!n(r.f,t,e),t[e])}},6066:function(t,e,s){var i=s(4569),n=s(4037),r=s(6889),o=s(4267),a=s(3674),l=s(5949),c=a("IE_PROTO"),h=i.Object,u=h.prototype;t.exports=l?h.getPrototypeOf:function(t){var e=o(t);if(n(e,c))return e[c];var s=e.constructor;return r(s)&&e instanceof s?s.prototype:e instanceof h?u:null}},397:function(t,e,s){var i=s(5169);t.exports=i({}.isPrototypeOf)},4839:function(t,e,s){var i=s(5169),n=s(4037),r=s(7816),o=s(9760).indexOf,a=s(5583),l=i([].push);t.exports=function(t,e){var s,i=r(t),c=0,h=[];for(s in i)!n(a,s)&&n(i,s)&&l(h,s);for(;e.length>c;)n(i,s=e[c++])&&(~o(h,s)||l(h,s));return h}},2518:function(t,e,s){var i=s(4839),n=s(667);t.exports=Object.keys||function(t){return i(t,n)}},665:function(t,e){"use strict";var s={}.propertyIsEnumerable,i=Object.getOwnPropertyDescriptor,n=i&&!s.call({1:2},1);e.f=n?function(t){var e=i(this,t);return!!e&&e.enumerable}:s},2370:function(t,e,s){var i=s(5169),n=s(6879),r=s(2605);t.exports=Object.setPrototypeOf||("__proto__"in{}?function(){var t,e=!1,s={};try{(t=i(Object.getOwnPropertyDescriptor(Object.prototype,"__proto__").set))(s,[]),e=s instanceof Array}catch(t){}return function(s,i){return n(s),r(i),e?t(s,i):s.__proto__=i,s}}():void 0)},1127:function(t,e,s){"use strict";var i=s(2401),n=s(5885);t.exports=i?{}.toString:function(){return"[object "+n(this)+"]"}},8968:function(t,e,s){var i=s(4569),n=s(5784),r=s(6889),o=s(9574),a=i.TypeError;t.exports=function(t,e){var s,i;if("string"===e&&r(s=t.toString)&&!o(i=n(s,t)))return i;if(r(s=t.valueOf)&&!o(i=n(s,t)))return i;if("string"!==e&&r(s=t.toString)&&!o(i=n(s,t)))return i;throw a("Can't convert object to primitive value")}},6035:function(t){t.exports={}},4675:function(t,e,s){var i=s(1120);t.exports=function(t,e,s){for(var n in e)s&&s.unsafe&&t[n]?t[n]=e[n]:i(t,n,e[n],s);return t}},1120:function(t,e,s){var i=s(8444);t.exports=function(t,e,s,n){n&&n.enumerable?t[e]=s:i(t,e,s)}},7339:function(t,e,s){var i=s(4569).TypeError;t.exports=function(t){if(null==t)throw i("Can't call method on "+t);return t}},4430:function(t,e,s){var i=s(4569),n=Object.defineProperty;t.exports=function(t,e){try{n(i,t,{value:e,configurable:!0,writable:!0})}catch(s){i[t]=e}return e}},6482:function(t,e,s){var i=s(2401),n=s(6445).f,r=s(8444),o=s(4037),a=s(1127),l=s(2735)("toStringTag");t.exports=function(t,e,s,c){if(t){var h=s?t:t.prototype;o(h,l)||n(h,l,{configurable:!0,value:e}),c&&!i&&r(h,"toString",a)}}},3674:function(t,e,s){var i=s(7450),n=s(158),r=i("keys");t.exports=function(t){return r[t]||(r[t]=n(t))}},9047:function(t,e,s){var i=s(4569),n=s(4430),r="__core-js_shared__",o=i[r]||n(r,{});t.exports=o},7450:function(t,e,s){var i=s(1567),n=s(9047);(t.exports=function(t,e){return n[t]||(n[t]=void 0!==e?e:{})})("versions",[]).push({version:"3.21.1",mode:i?"pure":"global",copyright:"© 2014-2022 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.21.1/LICENSE",source:"https://github.com/zloirock/core-js"})},2005:function(t,e,s){var i=s(463),n=Math.max,r=Math.min;t.exports=function(t,e){var s=i(t);return s<0?n(s+e,0):r(s,e)}},7816:function(t,e,s){var i=s(5769),n=s(7339);t.exports=function(t){return i(n(t))}},463:function(t){var e=Math.ceil,s=Math.floor;t.exports=function(t){var i=+t;return i!=i||0===i?0:(i>0?s:e)(i)}},1547:function(t,e,s){var i=s(463),n=Math.min;t.exports=function(t){return t>0?n(i(t),9007199254740991):0}},4267:function(t,e,s){var i=s(4569),n=s(7339),r=i.Object;t.exports=function(t){return r(n(t))}},809:function(t,e,s){var i=s(4569),n=s(5784),r=s(9574),o=s(3608),a=s(9732),l=s(8968),c=s(2735),h=i.TypeError,u=c("toPrimitive");t.exports=function(t,e){if(!r(t)||o(t))return t;var s,i=a(t,u);if(i){if(void 0===e&&(e="default"),s=n(i,t,e),!r(s)||o(s))return s;throw h("Can't convert object to primitive value")}return void 0===e&&(e="number"),l(t,e)}},4773:function(t,e,s){var i=s(809),n=s(3608);t.exports=function(t){var e=i(t,"string");return n(e)?e:e+""}},2401:function(t,e,s){var i={};i[s(2735)("toStringTag")]="z",t.exports="[object z]"===String(i)},3593:function(t,e,s){var i=s(4569),n=s(5885),r=i.String;t.exports=function(t){if("Symbol"===n(t))throw TypeError("Cannot convert a Symbol value to a string");return r(t)}},4877:function(t,e,s){var i=s(4569).String;t.exports=function(t){try{return i(t)}catch(t){return"Object"}}},158:function(t,e,s){var i=s(5169),n=0,r=Math.random(),o=i(1..toString);t.exports=function(t){return"Symbol("+(void 0===t?"":t)+")_"+o(++n+r,36)}},5699:function(t,e,s){var i=s(7873);t.exports=i&&!Symbol.sham&&"symbol"==typeof Symbol.iterator},7927:function(t,e,s){var i=s(41),n=s(8790);t.exports=i&&n((function(){return 42!=Object.defineProperty((function(){}),"prototype",{value:42,writable:!1}).prototype}))},1359:function(t,e,s){var i=s(4569).TypeError;t.exports=function(t,e){if(t<e)throw i("Not enough arguments");return t}},2735:function(t,e,s){var i=s(4569),n=s(7450),r=s(4037),o=s(158),a=s(7873),l=s(5699),c=n("wks"),h=i.Symbol,u=h&&h.for,d=l?h:h&&h.withoutSetter||o;t.exports=function(t){if(!r(c,t)||!a&&"string"!=typeof c[t]){var e="Symbol."+t;a&&r(h,t)?c[t]=h[t]:c[t]=l&&u?u(e):d(e)}return c[t]}},598:function(t,e,s){"use strict";var i=s(7816),n=s(8695),r=s(8830),o=s(975),a=s(6445).f,l=s(5329),c=s(1567),h=s(41),u="Array Iterator",d=o.set,p=o.getterFor(u);t.exports=l(Array,"Array",(function(t,e){d(this,{type:u,target:i(t),index:0,kind:e})}),(function(){var t=p(this),e=t.target,s=t.kind,i=t.index++;return!e||i>=e.length?(t.target=void 0,{value:void 0,done:!0}):"keys"==s?{value:i,done:!1}:"values"==s?{value:e[i],done:!1}:{value:[i,e[i]],done:!1}}),"values");var m=r.Arguments=r.Array;if(n("keys"),n("values"),n("entries"),!c&&h&&"values"!==m.name)try{a(m,"name",{value:"values"})}catch(t){}},1782:function(t,e,s){s(598);var i=s(4317),n=s(4569),r=s(5885),o=s(8444),a=s(8830),l=s(2735)("toStringTag");for(var c in i){var h=n[c],u=h&&h.prototype;u&&r(u)!==l&&o(u,l,c),a[c]=a.Array}},964:function(t,e,s){"use strict";s(598);var i=s(1301),n=s(4569),r=s(5972),o=s(5784),a=s(5169),l=s(8437),c=s(1120),h=s(4675),u=s(6482),d=s(6745),p=s(975),m=s(9730),g=s(6889),f=s(4037),v=s(490),y=s(5885),b=s(6879),x=s(9574),w=s(3593),k=s(4045),E=s(3196),S=s(7829),L=s(1520),A=s(1359),C=s(2735),M=s(4936),_=C("iterator"),T="URLSearchParams",P="URLSearchParamsIterator",O=p.set,I=p.getterFor(T),j=p.getterFor(P),N=r("fetch"),U=r("Request"),V=r("Headers"),D=U&&U.prototype,B=V&&V.prototype,R=n.RegExp,z=n.TypeError,F=n.decodeURIComponent,H=n.encodeURIComponent,q=a("".charAt),X=a([].join),G=a([].push),Y=a("".replace),Z=a([].shift),W=a([].splice),Q=a("".split),J=a("".slice),K=/\+/g,$=Array(4),tt=function(t){return $[t-1]||($[t-1]=R("((?:%[\\da-f]{2}){"+t+"})","gi"))},et=function(t){try{return F(t)}catch(e){return t}},st=function(t){var e=Y(t,K," "),s=4;try{return F(e)}catch(t){for(;s;)e=Y(e,tt(s--),et);return e}},it=/[!'()~]|%20/g,nt={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+"},rt=function(t){return nt[t]},ot=function(t){return Y(H(t),it,rt)},at=d((function(t,e){O(this,{type:P,iterator:S(I(t).entries),kind:e})}),"Iterator",(function(){var t=j(this),e=t.kind,s=t.iterator.next(),i=s.value;return s.done||(s.value="keys"===e?i.key:"values"===e?i.value:[i.key,i.value]),s}),!0),lt=function(t){this.entries=[],this.url=null,void 0!==t&&(x(t)?this.parseObject(t):this.parseQuery("string"==typeof t?"?"===q(t,0)?J(t,1):t:w(t)))};lt.prototype={type:T,bindURL:function(t){this.url=t,this.update()},parseObject:function(t){var e,s,i,n,r,a,l,c=L(t);if(c)for(s=(e=S(t,c)).next;!(i=o(s,e)).done;){if(r=(n=S(b(i.value))).next,(a=o(r,n)).done||(l=o(r,n)).done||!o(r,n).done)throw z("Expected sequence with length 2");G(this.entries,{key:w(a.value),value:w(l.value)})}else for(var h in t)f(t,h)&&G(this.entries,{key:h,value:w(t[h])})},parseQuery:function(t){if(t)for(var e,s,i=Q(t,"&"),n=0;n<i.length;)(e=i[n++]).length&&(s=Q(e,"="),G(this.entries,{key:st(Z(s)),value:st(X(s,"="))}))},serialize:function(){for(var t,e=this.entries,s=[],i=0;i<e.length;)t=e[i++],G(s,ot(t.key)+"="+ot(t.value));return X(s,"&")},update:function(){this.entries.length=0,this.parseQuery(this.url.query)},updateURL:function(){this.url&&this.url.update()}};var ct=function(){m(this,ht);var t=arguments.length>0?arguments[0]:void 0;O(this,new lt(t))},ht=ct.prototype;if(h(ht,{append:function(t,e){A(arguments.length,2);var s=I(this);G(s.entries,{key:w(t),value:w(e)}),s.updateURL()},delete:function(t){A(arguments.length,1);for(var e=I(this),s=e.entries,i=w(t),n=0;n<s.length;)s[n].key===i?W(s,n,1):n++;e.updateURL()},get:function(t){A(arguments.length,1);for(var e=I(this).entries,s=w(t),i=0;i<e.length;i++)if(e[i].key===s)return e[i].value;return null},getAll:function(t){A(arguments.length,1);for(var e=I(this).entries,s=w(t),i=[],n=0;n<e.length;n++)e[n].key===s&&G(i,e[n].value);return i},has:function(t){A(arguments.length,1);for(var e=I(this).entries,s=w(t),i=0;i<e.length;)if(e[i++].key===s)return!0;return!1},set:function(t,e){A(arguments.length,1);for(var s,i=I(this),n=i.entries,r=!1,o=w(t),a=w(e),l=0;l<n.length;l++)(s=n[l]).key===o&&(r?W(n,l--,1):(r=!0,s.value=a));r||G(n,{key:o,value:a}),i.updateURL()},sort:function(){var t=I(this);M(t.entries,(function(t,e){return t.key>e.key?1:-1})),t.updateURL()},forEach:function(t){for(var e,s=I(this).entries,i=v(t,arguments.length>1?arguments[1]:void 0),n=0;n<s.length;)i((e=s[n++]).value,e.key,this)},keys:function(){return new at(this,"keys")},values:function(){return new at(this,"values")},entries:function(){return new at(this,"entries")}},{enumerable:!0}),c(ht,_,ht.entries,{name:"entries"}),c(ht,"toString",(function(){return I(this).serialize()}),{enumerable:!0}),u(ct,T),i({global:!0,forced:!l},{URLSearchParams:ct}),!l&&g(V)){var ut=a(B.has),dt=a(B.set),pt=function(t){if(x(t)){var e,s=t.body;if(y(s)===T)return e=t.headers?new V(t.headers):new V,ut(e,"content-type")||dt(e,"content-type","application/x-www-form-urlencoded;charset=UTF-8"),k(t,{body:E(0,w(s)),headers:E(0,e)})}return t};if(g(N)&&i({global:!0,enumerable:!0,forced:!0},{fetch:function(t){return N(t,arguments.length>1?pt(arguments[1]):{})}}),g(U)){var mt=function(t){return m(this,D),new U(t,arguments.length>1?pt(arguments[1]):{})};D.constructor=mt,mt.prototype=D,i({global:!0,forced:!0},{Request:mt})}}t.exports={URLSearchParams:ct,getState:I}},2162:function(t,e,s){var i=s(1228);s(1782),t.exports=i},1228:function(t,e,s){s(964);var i=s(6035);t.exports=i.URLSearchParams},293:function(t,e,s){t.exports=s(2162)},4749:function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const s={svg:"http://www.w3.org/2000/svg",xmlns:"http://www.w3.org/2000/xmlns/",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",ct:"http://gionkunz.github.com/chartist-js/ct"},i={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#039;"};function n(t,e){return"number"==typeof t?t+e:t}function r(t){if("string"==typeof t){const e=/^(\d+)\s*(.*)$/g.exec(t);return{value:e?+e[1]:0,unit:(null==e?void 0:e[2])||void 0}}return{value:Number(t)}}function o(t){return String.fromCharCode(97+t%26)}const a=2221e-19;function l(t){return Math.floor(Math.log(Math.abs(t))/Math.LN10)}function c(t,e,s){return e/s.range*t}function h(t,e){const s=Math.pow(10,e||8);return Math.round(t*s)/s}function u(t){if(1===t)return t;function e(t,s){return t%s==0?s:e(s,t%s)}function s(t){return t*t+1}let i,n=2,r=2;if(t%2==0)return 2;do{n=s(n)%t,r=s(s(r))%t,i=e(Math.abs(n-r),t)}while(1===i);return i}function d(t,e,s,i){const n=(i-90)*Math.PI/180;return{x:t+s*Math.cos(n),y:e+s*Math.sin(n)}}function p(t,e,s){let i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const n={high:e.high,low:e.low,valueRange:0,oom:0,step:0,min:0,max:0,range:0,numberOfSteps:0,values:[]};n.valueRange=n.high-n.low,n.oom=l(n.valueRange),n.step=Math.pow(10,n.oom),n.min=Math.floor(n.low/n.step)*n.step,n.max=Math.ceil(n.high/n.step)*n.step,n.range=n.max-n.min,n.numberOfSteps=Math.round(n.range/n.step);const r=c(t,n.step,n),o=r<s,d=i?u(n.range):0;if(i&&c(t,1,n)>=s)n.step=1;else if(i&&d<n.step&&c(t,d,n)>=s)n.step=d;else{let e=0;for(;;){if(o&&c(t,n.step,n)<=s)n.step*=2;else{if(o||!(c(t,n.step/2,n)>=s))break;if(n.step/=2,i&&n.step%1!=0){n.step*=2;break}}if(e++>1e3)throw new Error("Exceeded maximum number of iterations while optimizing scale step!")}}function p(t,e){return t===(t+=e)&&(t*=1+(e>0?a:-a)),t}n.step=Math.max(n.step,a);let m=n.min,g=n.max;for(;m+n.step<=n.low;)m=p(m,n.step);for(;g-n.step>=n.high;)g=p(g,-n.step);n.min=m,n.max=g,n.range=n.max-n.min;const f=[];for(let t=n.min;t<=n.max;t=p(t,n.step)){const e=h(t);e!==f[f.length-1]&&f.push(e)}return n.values=f,n}function m(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};for(var e=arguments.length,s=new Array(e>1?e-1:0),i=1;i<e;i++)s[i-1]=arguments[i];for(let e=0;e<s.length;e++){const i=s[e];for(const e in i){const s=i[e];t[e]="object"!=typeof s||null===s||s instanceof Array?s:m(t[e],s)}}return t}const g=t=>t,f=t=>Array.from({length:t}),v=(t,e)=>t+(e||0),y=(t,e)=>f(Math.max(...t.map((t=>t.length)))).map(((s,i)=>e(...t.map((t=>t[i])))));function b(t,e){return null!==t&&"object"==typeof t&&Reflect.has(t,e)}function x(t){return null!==t&&isFinite(t)}function w(t){return!t&&0!==t}function k(t){return x(t)?Number(t):void 0}function E(t){return!!Array.isArray(t)&&t.every(Array.isArray)}function S(t,e){const s=Array.isArray(t)?t[e]:b(t,"data")?t.data[e]:null;return b(s,"meta")?s.meta:void 0}function L(t){return null==t||"number"==typeof t&&isNaN(t)}function A(t){return Array.isArray(t)&&t.every((t=>Array.isArray(t)||b(t,"data")))}function C(t){return"object"==typeof t&&null!==t&&(Reflect.has(t,"x")||Reflect.has(t,"y"))}function M(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"y";return C(t)&&b(t,e)?k(t[e]):k(t)}function _(t,e,s){const i={high:void 0===(e={...e,...s?"x"===s?e.axisX:e.axisY:{}}).high?-Number.MAX_VALUE:+e.high,low:void 0===e.low?Number.MAX_VALUE:+e.low},n=void 0===e.high,r=void 0===e.low;return(n||r)&&function t(e){if(!L(e))if(Array.isArray(e))for(let s=0;s<e.length;s++)t(e[s]);else{const t=Number(s&&b(e,s)?e[s]:e);n&&t>i.high&&(i.high=t),r&&t<i.low&&(i.low=t)}}(t),(e.referenceValue||0===e.referenceValue)&&(i.high=Math.max(e.referenceValue,i.high),i.low=Math.min(e.referenceValue,i.low)),i.high<=i.low&&(0===i.low?i.high=1:i.low<0?i.high=0:(i.high>0||(i.high=1),i.low=0)),i}function T(t){let e,s=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=arguments.length>2?arguments[2]:void 0,n=arguments.length>3?arguments[3]:void 0;const r={labels:[],series:j(t.series,i,n)};return e=E(r.series)?Math.max(...r.series.map((t=>t.length))):r.series.length,r.labels=(t.labels||[]).slice(),r.labels.push(...f(Math.max(0,e-r.labels.length)).map((()=>""))),s&&P(r),r}function P(t){var e;null===(e=t.labels)||void 0===e||e.reverse(),t.series.reverse();for(const e of t.series)b(e,"data")?e.data.reverse():Array.isArray(e)&&e.reverse()}function O(t,e){if(!L(t))return e?function(t,e){let s,i;if("object"!=typeof t){const n=k(t);"x"===e?s=n:i=n}else b(t,"x")&&(s=k(t.x)),b(t,"y")&&(i=k(t.y));if(void 0!==s||void 0!==i)return{x:s,y:i}}(t,e):k(t)}function I(t,e){return Array.isArray(t)?t.map((t=>b(t,"value")?O(t.value,e):O(t,e))):I(t.data,e)}function j(t,e,s){if(A(t))return t.map((t=>I(t,e)));const i=I(t,e);return s?i.map((t=>[t])):i}function N(t,e,s){const i={increasingX:!1,fillHoles:!1,...s},n=[];let r=!0;for(let s=0;s<t.length;s+=2)void 0===M(e[s/2].value)?i.fillHoles||(r=!0):(i.increasingX&&s>=2&&t[s]<=t[s-2]&&(r=!0),r&&(n.push({pathCoordinates:[],valueData:[]}),r=!1),n[n.length-1].pathCoordinates.push(t[s],t[s+1]),n[n.length-1].valueData.push(e[s/2]));return n}function U(t){let e="";return null==t?t:(e="number"==typeof t?""+t:"object"==typeof t?JSON.stringify({data:t}):String(t),Object.keys(i).reduce(((t,e)=>t.replaceAll(e,i[e])),e))}class V{call(t,e){return this.svgElements.forEach((s=>Reflect.apply(s[t],s,e))),this}attr(){for(var t=arguments.length,e=new Array(t),s=0;s<t;s++)e[s]=arguments[s];return this.call("attr",e)}elem(){for(var t=arguments.length,e=new Array(t),s=0;s<t;s++)e[s]=arguments[s];return this.call("elem",e)}root(){for(var t=arguments.length,e=new Array(t),s=0;s<t;s++)e[s]=arguments[s];return this.call("root",e)}getNode(){for(var t=arguments.length,e=new Array(t),s=0;s<t;s++)e[s]=arguments[s];return this.call("getNode",e)}foreignObject(){for(var t=arguments.length,e=new Array(t),s=0;s<t;s++)e[s]=arguments[s];return this.call("foreignObject",e)}text(){for(var t=arguments.length,e=new Array(t),s=0;s<t;s++)e[s]=arguments[s];return this.call("text",e)}empty(){for(var t=arguments.length,e=new Array(t),s=0;s<t;s++)e[s]=arguments[s];return this.call("empty",e)}remove(){for(var t=arguments.length,e=new Array(t),s=0;s<t;s++)e[s]=arguments[s];return this.call("remove",e)}addClass(){for(var t=arguments.length,e=new Array(t),s=0;s<t;s++)e[s]=arguments[s];return this.call("addClass",e)}removeClass(){for(var t=arguments.length,e=new Array(t),s=0;s<t;s++)e[s]=arguments[s];return this.call("removeClass",e)}removeAllClasses(){for(var t=arguments.length,e=new Array(t),s=0;s<t;s++)e[s]=arguments[s];return this.call("removeAllClasses",e)}animate(){for(var t=arguments.length,e=new Array(t),s=0;s<t;s++)e[s]=arguments[s];return this.call("animate",e)}constructor(t){this.svgElements=[];for(let e=0;e<t.length;e++)this.svgElements.push(new R(t[e]))}}const D={easeInSine:[.47,0,.745,.715],easeOutSine:[.39,.575,.565,1],easeInOutSine:[.445,.05,.55,.95],easeInQuad:[.55,.085,.68,.53],easeOutQuad:[.25,.46,.45,.94],easeInOutQuad:[.455,.03,.515,.955],easeInCubic:[.55,.055,.675,.19],easeOutCubic:[.215,.61,.355,1],easeInOutCubic:[.645,.045,.355,1],easeInQuart:[.895,.03,.685,.22],easeOutQuart:[.165,.84,.44,1],easeInOutQuart:[.77,0,.175,1],easeInQuint:[.755,.05,.855,.06],easeOutQuint:[.23,1,.32,1],easeInOutQuint:[.86,0,.07,1],easeInExpo:[.95,.05,.795,.035],easeOutExpo:[.19,1,.22,1],easeInOutExpo:[1,0,0,1],easeInCirc:[.6,.04,.98,.335],easeOutCirc:[.075,.82,.165,1],easeInOutCirc:[.785,.135,.15,.86],easeInBack:[.6,-.28,.735,.045],easeOutBack:[.175,.885,.32,1.275],easeInOutBack:[.68,-.55,.265,1.55]};function B(t,e,s){let i=arguments.length>3&&void 0!==arguments[3]&&arguments[3],o=arguments.length>4?arguments[4]:void 0;const{easing:a,...l}=s,c={};let h,u;a&&(h=Array.isArray(a)?a:D[a]),l.begin=n(l.begin,"ms"),l.dur=n(l.dur,"ms"),h&&(l.calcMode="spline",l.keySplines=h.join(" "),l.keyTimes="0;1"),i&&(l.fill="freeze",c[e]=l.from,t.attr(c),u=r(l.begin||0).value,l.begin="indefinite");const d=t.elem("animate",{attributeName:e,...l});i&&setTimeout((()=>{try{d._node.beginElement()}catch(s){c[e]=l.to,t.attr(c),d.remove()}}),u);const p=d.getNode();o&&p.addEventListener("beginEvent",(()=>o.emit("animationBegin",{element:t,animate:p,params:s}))),p.addEventListener("endEvent",(()=>{o&&o.emit("animationEnd",{element:t,animate:p,params:s}),i&&(c[e]=l.to,t.attr(c),d.remove())}))}class R{attr(t,e){return"string"==typeof t?e?this._node.getAttributeNS(e,t):this._node.getAttribute(t):(Object.keys(t).forEach((e=>{if(void 0!==t[e])if(-1!==e.indexOf(":")){const i=e.split(":");this._node.setAttributeNS(s[i[0]],e,String(t[e]))}else this._node.setAttribute(e,String(t[e]))})),this)}elem(t,e,s){return new R(t,e,s,this,arguments.length>3&&void 0!==arguments[3]&&arguments[3])}parent(){return this._node.parentNode instanceof SVGElement?new R(this._node.parentNode):null}root(){let t=this._node;for(;"svg"!==t.nodeName&&t.parentElement;)t=t.parentElement;return new R(t)}querySelector(t){const e=this._node.querySelector(t);return e?new R(e):null}querySelectorAll(t){const e=this._node.querySelectorAll(t);return new V(e)}getNode(){return this._node}foreignObject(t,e,i){let n,r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if("string"==typeof t){const e=document.createElement("div");e.innerHTML=t,n=e.firstChild}else n=t;n instanceof Element&&n.setAttribute("xmlns",s.xmlns);const o=this.elem("foreignObject",e,i,r);return o._node.appendChild(n),o}text(t){return this._node.appendChild(document.createTextNode(t)),this}empty(){for(;this._node.firstChild;)this._node.removeChild(this._node.firstChild);return this}remove(){var t;return null===(t=this._node.parentNode)||void 0===t||t.removeChild(this._node),this.parent()}replace(t){var e;return null===(e=this._node.parentNode)||void 0===e||e.replaceChild(t._node,this._node),t}append(t){return arguments.length>1&&void 0!==arguments[1]&&arguments[1]&&this._node.firstChild?this._node.insertBefore(t._node,this._node.firstChild):this._node.appendChild(t._node),this}classes(){const t=this._node.getAttribute("class");return t?t.trim().split(/\s+/):[]}addClass(t){return this._node.setAttribute("class",this.classes().concat(t.trim().split(/\s+/)).filter((function(t,e,s){return s.indexOf(t)===e})).join(" ")),this}removeClass(t){const e=t.trim().split(/\s+/);return this._node.setAttribute("class",this.classes().filter((t=>-1===e.indexOf(t))).join(" ")),this}removeAllClasses(){return this._node.setAttribute("class",""),this}height(){return this._node.getBoundingClientRect().height}width(){return this._node.getBoundingClientRect().width}animate(t){let e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],s=arguments.length>2?arguments[2]:void 0;return Object.keys(t).forEach((i=>{const n=t[i];Array.isArray(n)?n.forEach((t=>B(this,i,t,!1,s))):B(this,i,n,e,s)})),this}constructor(t,e,i,n,r=!1){t instanceof Element?this._node=t:(this._node=document.createElementNS(s.svg,t),"svg"===t&&this.attr({"xmlns:ct":s.ct})),e&&this.attr(e),i&&this.addClass(i),n&&(r&&n._node.firstChild?n._node.insertBefore(this._node,n._node.firstChild):n._node.appendChild(this._node))}}function z(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"100%",i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"100%",n=arguments.length>3?arguments[3]:void 0;Array.from(t.querySelectorAll("svg")).filter((t=>t.getAttributeNS(s.xmlns,"ct"))).forEach((e=>t.removeChild(e)));const r=new R("svg").attr({width:e,height:i}).attr({style:"width: ".concat(e,"; height: ").concat(i,";")});return n&&r.addClass(n),t.appendChild(r.getNode()),r}function F(t){return"number"==typeof t?{top:t,right:t,bottom:t,left:t}:void 0===t?{top:0,right:0,bottom:0,left:0}:{top:"number"==typeof t.top?t.top:0,right:"number"==typeof t.right?t.right:0,bottom:"number"==typeof t.bottom?t.bottom:0,left:"number"==typeof t.left?t.left:0}}function H(t,e){var s,i,n,o;const a=Boolean(e.axisX||e.axisY),l=(null===(s=e.axisY)||void 0===s?void 0:s.offset)||0,c=(null===(i=e.axisX)||void 0===i?void 0:i.offset)||0,h=null===(n=e.axisY)||void 0===n?void 0:n.position,u=null===(o=e.axisX)||void 0===o?void 0:o.position;let d=t.width()||r(e.width).value||0,p=t.height()||r(e.height).value||0;const m=F(e.chartPadding);d=Math.max(d,l+m.left+m.right),p=Math.max(p,c+m.top+m.bottom);const g={x1:0,x2:0,y1:0,y2:0,padding:m,width(){return this.x2-this.x1},height(){return this.y1-this.y2}};return a?("start"===u?(g.y2=m.top+c,g.y1=Math.max(p-m.bottom,g.y2+1)):(g.y2=m.top,g.y1=Math.max(p-m.bottom-c,g.y2+1)),"start"===h?(g.x1=m.left+l,g.x2=Math.max(d-m.right,g.x1+1)):(g.x1=m.left,g.x2=Math.max(d-m.right-l,g.x1+1))):(g.x1=m.left,g.x2=Math.max(d-m.right,g.x1+1),g.y2=m.top,g.y1=Math.max(p-m.bottom,g.y2+1)),g}function q(t,e,s,i,n,r,o,a){const l={["".concat(s.units.pos,"1")]:t,["".concat(s.units.pos,"2")]:t,["".concat(s.counterUnits.pos,"1")]:i,["".concat(s.counterUnits.pos,"2")]:i+n},c=r.elem("line",l,o.join(" "));a.emit("draw",{type:"grid",axis:s,index:e,group:r,element:c,...l})}function X(t,e,s,i){const n=t.elem("rect",{x:e.x1,y:e.y2,width:e.width(),height:e.height()},s,!0);i.emit("draw",{type:"gridBackground",group:t,element:n})}function G(t,e,s,i,n,r,o,a,l,c){const h={[n.units.pos]:t+o[n.units.pos],[n.counterUnits.pos]:o[n.counterUnits.pos],[n.units.len]:e,[n.counterUnits.len]:Math.max(0,r-10)},u=Math.round(h[n.units.len]),d=Math.round(h[n.counterUnits.len]),p=document.createElement("span");p.className=l.join(" "),p.style[n.units.len]=u+"px",p.style[n.counterUnits.len]=d+"px",p.textContent=String(i);const m=a.foreignObject(p,{style:"overflow: visible;",...h});c.emit("draw",{type:"label",axis:n,index:s,group:a,element:m,text:i,...h})}function Y(t,e,s){let i;const n=[];function r(n){const r=i;i=m({},t),e&&e.forEach((t=>{window.matchMedia(t[0]).matches&&(i=m(i,t[1]))})),s&&n&&s.emit("optionsChanged",{previousOptions:r,currentOptions:i})}if(!window.matchMedia)throw new Error("window.matchMedia not found! Make sure you're using a polyfill.");return e&&e.forEach((t=>{const e=window.matchMedia(t[0]);e.addEventListener("change",r),n.push(e)})),r(),{removeMediaQueryListeners:function(){n.forEach((t=>t.removeEventListener("change",r)))},getCurrentOptions(){return i}}}R.Easing=D;const Z={m:["x","y"],l:["x","y"],c:["x1","y1","x2","y2","x","y"],a:["rx","ry","xAr","lAf","sf","x","y"]},W={accuracy:3};function Q(t,e,s,i,n,r){const o={command:n?t.toLowerCase():t.toUpperCase(),...e,...r?{data:r}:{}};s.splice(i,0,o)}function J(t,e){t.forEach(((s,i)=>{Z[s.command.toLowerCase()].forEach(((n,r)=>{e(s,n,i,r,t)}))}))}class K{static join(t){const e=new K(arguments.length>1&&void 0!==arguments[1]&&arguments[1],arguments.length>2?arguments[2]:void 0);for(let s=0;s<t.length;s++){const i=t[s];for(let t=0;t<i.pathElements.length;t++)e.pathElements.push(i.pathElements[t])}return e}position(t){return void 0!==t?(this.pos=Math.max(0,Math.min(this.pathElements.length,t)),this):this.pos}remove(t){return this.pathElements.splice(this.pos,t),this}move(t,e){let s=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=arguments.length>3?arguments[3]:void 0;return Q("M",{x:+t,y:+e},this.pathElements,this.pos++,s,i),this}line(t,e){let s=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=arguments.length>3?arguments[3]:void 0;return Q("L",{x:+t,y:+e},this.pathElements,this.pos++,s,i),this}curve(t,e,s,i,n,r){let o=arguments.length>6&&void 0!==arguments[6]&&arguments[6],a=arguments.length>7?arguments[7]:void 0;return Q("C",{x1:+t,y1:+e,x2:+s,y2:+i,x:+n,y:+r},this.pathElements,this.pos++,o,a),this}arc(t,e,s,i,n,r,o){let a=arguments.length>7&&void 0!==arguments[7]&&arguments[7],l=arguments.length>8?arguments[8]:void 0;return Q("A",{rx:t,ry:e,xAr:s,lAf:i,sf:n,x:r,y:o},this.pathElements,this.pos++,a,l),this}parse(t){const e=t.replace(/([A-Za-z])([0-9])/g,"$1 $2").replace(/([0-9])([A-Za-z])/g,"$1 $2").split(/[\s,]+/).reduce(((t,e)=>(e.match(/[A-Za-z]/)&&t.push([]),t[t.length-1].push(e),t)),[]);"Z"===e[e.length-1][0].toUpperCase()&&e.pop();const s=e.map((t=>{const e=t.shift(),s=Z[e.toLowerCase()];return{command:e,...s.reduce(((e,s,i)=>(e[s]=+t[i],e)),{})}}));return this.pathElements.splice(this.pos,0,...s),this.pos+=s.length,this}stringify(){const t=Math.pow(10,this.options.accuracy);return this.pathElements.reduce(((e,s)=>{const i=Z[s.command.toLowerCase()].map((e=>{const i=s[e];return this.options.accuracy?Math.round(i*t)/t:i}));return e+s.command+i.join(",")}),"")+(this.close?"Z":"")}scale(t,e){return J(this.pathElements,((s,i)=>{s[i]*="x"===i[0]?t:e})),this}translate(t,e){return J(this.pathElements,((s,i)=>{s[i]+="x"===i[0]?t:e})),this}transform(t){return J(this.pathElements,((e,s,i,n,r)=>{const o=t(e,s,i,n,r);(o||0===o)&&(e[s]=o)})),this}clone(){const t=new K(arguments.length>0&&void 0!==arguments[0]&&arguments[0]||this.close);return t.pos=this.pos,t.pathElements=this.pathElements.slice().map((t=>({...t}))),t.options={...this.options},t}splitByCommand(t){const e=[new K];return this.pathElements.forEach((s=>{s.command===t.toUpperCase()&&0!==e[e.length-1].pathElements.length&&e.push(new K),e[e.length-1].pathElements.push(s)})),e}constructor(t=!1,e){this.close=t,this.pathElements=[],this.pos=0,this.options={...W,...e}}}function $(t){const e={fillHoles:!1,...t};return function(t,s){const i=new K;let n=!0;for(let r=0;r<t.length;r+=2){const o=t[r],a=t[r+1],l=s[r/2];void 0!==M(l.value)?(n?i.move(o,a,!1,l):i.line(o,a,!1,l),n=!1):e.fillHoles||(n=!0)}return i}}function tt(t){const e={fillHoles:!1,...t};return function t(s,i){const n=N(s,i,{fillHoles:e.fillHoles,increasingX:!0});if(n.length){if(n.length>1)return K.join(n.map((e=>t(e.pathCoordinates,e.valueData))));{if(s=n[0].pathCoordinates,i=n[0].valueData,s.length<=4)return $()(s,i);const t=[],e=[],r=s.length/2,o=[],a=[],l=[],c=[];for(let i=0;i<r;i++)t[i]=s[2*i],e[i]=s[2*i+1];for(let s=0;s<r-1;s++)l[s]=e[s+1]-e[s],c[s]=t[s+1]-t[s],a[s]=l[s]/c[s];o[0]=a[0],o[r-1]=a[r-2];for(let t=1;t<r-1;t++)0===a[t]||0===a[t-1]||a[t-1]>0!=a[t]>0?o[t]=0:(o[t]=3*(c[t-1]+c[t])/((2*c[t]+c[t-1])/a[t-1]+(c[t]+2*c[t-1])/a[t]),isFinite(o[t])||(o[t]=0));const h=(new K).move(t[0],e[0],!1,i[0]);for(let s=0;s<r-1;s++)h.curve(t[s]+c[s]/3,e[s]+o[s]*c[s]/3,t[s+1]-c[s]/3,e[s+1]-o[s+1]*c[s]/3,t[s+1],e[s+1],!1,i[s+1]);return h}}return $()([],[])}}var et=Object.freeze({__proto__:null,none:$,simple:function(t){const e={divisor:2,fillHoles:!1,...t},s=1/Math.max(1,e.divisor);return function(t,i){const n=new K;let r,o=0,a=0;for(let l=0;l<t.length;l+=2){const c=t[l],h=t[l+1],u=(c-o)*s,d=i[l/2];void 0!==d.value?(void 0===r?n.move(c,h,!1,d):n.curve(o+u,a,c-u,h,c,h,!1,d),o=c,a=h,r=d):e.fillHoles||(o=a=0,r=void 0)}return n}},step:function(t){const e={postpone:!0,fillHoles:!1,...t};return function(t,s){const i=new K;let n,r=0,o=0;for(let a=0;a<t.length;a+=2){const l=t[a],c=t[a+1],h=s[a/2];void 0!==h.value?(void 0===n?i.move(l,c,!1,h):(e.postpone?i.line(l,o,!1,n):i.line(r,c,!1,h),i.line(l,c,!1,h)),r=l,o=c,n=h):e.fillHoles||(r=o=0,n=void 0)}return i}},cardinal:function(t){const e={tension:1,fillHoles:!1,...t},s=Math.min(1,Math.max(0,e.tension)),i=1-s;return function t(n,r){const o=N(n,r,{fillHoles:e.fillHoles});if(o.length){if(o.length>1)return K.join(o.map((e=>t(e.pathCoordinates,e.valueData))));{if(n=o[0].pathCoordinates,r=o[0].valueData,n.length<=4)return $()(n,r);const t=(new K).move(n[0],n[1],!1,r[0]),e=!1;for(let o=0,a=n.length;a-2*Number(!e)>o;o+=2){const e=[{x:+n[o-2],y:+n[o-1]},{x:+n[o],y:+n[o+1]},{x:+n[o+2],y:+n[o+3]},{x:+n[o+4],y:+n[o+5]}];a-4===o?e[3]=e[2]:o||(e[0]={x:+n[o],y:+n[o+1]}),t.curve(s*(-e[0].x+6*e[1].x+e[2].x)/6+i*e[2].x,s*(-e[0].y+6*e[1].y+e[2].y)/6+i*e[2].y,s*(e[1].x+6*e[2].x-e[3].x)/6+i*e[2].x,s*(e[1].y+6*e[2].y-e[3].y)/6+i*e[2].y,e[2].x,e[2].y,!1,r[(o+2)/2])}return t}}return $()([],[])}},monotoneCubic:tt});class st{on(t,e){const{allListeners:s,listeners:i}=this;"*"===t?s.add(e):(i.has(t)||i.set(t,new Set),i.get(t).add(e))}off(t,e){const{allListeners:s,listeners:i}=this;if("*"===t)e?s.delete(e):s.clear();else if(i.has(t)){const s=i.get(t);e?s.delete(e):s.clear(),s.size||i.delete(t)}}emit(t,e){const{allListeners:s,listeners:i}=this;i.has(t)&&i.get(t).forEach((t=>t(e))),s.forEach((s=>s(t,e)))}constructor(){this.listeners=new Map,this.allListeners=new Set}}const it=new WeakMap;class nt{update(t,e){let s=arguments.length>2&&void 0!==arguments[2]&&arguments[2];var i;(t&&(this.data=t||{},this.data.labels=this.data.labels||[],this.data.series=this.data.series||[],this.eventEmitter.emit("data",{type:"update",data:this.data})),e)&&(this.options=m({},s?this.options:this.defaultOptions,e),this.initializeTimeoutId||(null===(i=this.optionsProvider)||void 0===i||i.removeMediaQueryListeners(),this.optionsProvider=Y(this.options,this.responsiveOptions,this.eventEmitter)));return!this.initializeTimeoutId&&this.optionsProvider&&this.createChart(this.optionsProvider.getCurrentOptions()),this}detach(){var t;this.initializeTimeoutId?window.clearTimeout(this.initializeTimeoutId):(window.removeEventListener("resize",this.resizeListener),null===(t=this.optionsProvider)||void 0===t||t.removeMediaQueryListeners());return it.delete(this.container),this}on(t,e){return this.eventEmitter.on(t,e),this}off(t,e){return this.eventEmitter.off(t,e),this}initialize(){window.addEventListener("resize",this.resizeListener),this.optionsProvider=Y(this.options,this.responsiveOptions,this.eventEmitter),this.eventEmitter.on("optionsChanged",(()=>this.update())),this.options.plugins&&this.options.plugins.forEach((t=>{Array.isArray(t)?t[0](this,t[1]):t(this)})),this.eventEmitter.emit("data",{type:"initial",data:this.data}),this.createChart(this.optionsProvider.getCurrentOptions()),this.initializeTimeoutId=null}constructor(t,e,s,i,n){this.data=e,this.defaultOptions=s,this.options=i,this.responsiveOptions=n,this.eventEmitter=new st,this.resizeListener=()=>this.update(),this.initializeTimeoutId=setTimeout((()=>this.initialize()),0);const r="string"==typeof t?document.querySelector(t):t;if(!r)throw new Error("Target element is not found");this.container=r;const o=it.get(r);o&&o.detach(),it.set(r,this)}}const rt={x:{pos:"x",len:"width",dir:"horizontal",rectStart:"x1",rectEnd:"x2",rectOffset:"y2"},y:{pos:"y",len:"height",dir:"vertical",rectStart:"y2",rectEnd:"y1",rectOffset:"x1"}};class ot{createGridAndLabels(t,e,s,i){const n="x"===this.units.pos?s.axisX:s.axisY,r=this.ticks.map(((t,e)=>this.projectValue(t,e))),o=this.ticks.map(n.labelInterpolationFnc);r.forEach(((a,l)=>{const c=o[l],h={x:0,y:0};let u;u=r[l+1]?r[l+1]-a:Math.max(this.axisLength-a,30),""!==c&&w(c)||("x"===this.units.pos?(a=this.chartRect.x1+a,h.x=s.axisX.labelOffset.x,"start"===s.axisX.position?h.y=this.chartRect.padding.top+s.axisX.labelOffset.y+5:h.y=this.chartRect.y1+s.axisX.labelOffset.y+5):(a=this.chartRect.y1-a,h.y=s.axisY.labelOffset.y-u,"start"===s.axisY.position?h.x=this.chartRect.padding.left+s.axisY.labelOffset.x:h.x=this.chartRect.x2+s.axisY.labelOffset.x+10),n.showGrid&&q(a,l,this,this.gridOffset,this.chartRect[this.counterUnits.len](),t,[s.classNames.grid,s.classNames[this.units.dir]],i),n.showLabel&&G(a,u,l,c,this,n.offset,h,e,[s.classNames.label,s.classNames[this.units.dir],"start"===n.position?s.classNames[n.position]:s.classNames.end],i))}))}constructor(t,e,s){this.units=t,this.chartRect=e,this.ticks=s,this.counterUnits=t===rt.x?rt.y:rt.x,this.axisLength=e[this.units.rectEnd]-e[this.units.rectStart],this.gridOffset=e[this.units.rectOffset]}}class at extends ot{projectValue(t){const e=Number(M(t,this.units.pos));return this.axisLength*(e-this.bounds.min)/this.bounds.range}constructor(t,e,s,i){const n=i.highLow||_(e,i,t.pos),r=p(s[t.rectEnd]-s[t.rectStart],n,i.scaleMinSpace||20,i.onlyInteger),o={min:r.min,max:r.max};super(t,s,r.values),this.bounds=r,this.range=o}}class lt extends ot{projectValue(t,e){return this.stepLength*e}constructor(t,e,s,i){const n=i.ticks||[];super(t,s,n);const r=Math.max(1,n.length-(i.stretch?1:0));this.stepLength=this.axisLength/r,this.stretch=Boolean(i.stretch)}}function ct(t,e,s){var i;if(b(t,"name")&&t.name&&(null===(i=e.series)||void 0===i?void 0:i[t.name])){const i=(null==e?void 0:e.series[t.name])[s];return void 0===i?e[s]:i}return e[s]}const ht={axisX:{offset:30,position:"end",labelOffset:{x:0,y:0},showLabel:!0,showGrid:!0,labelInterpolationFnc:g,type:void 0},axisY:{offset:40,position:"start",labelOffset:{x:0,y:0},showLabel:!0,showGrid:!0,labelInterpolationFnc:g,type:void 0,scaleMinSpace:20,onlyInteger:!1},width:void 0,height:void 0,showLine:!0,showPoint:!0,showArea:!1,areaBase:0,lineSmooth:!0,showGridBackground:!1,low:void 0,high:void 0,chartPadding:{top:15,right:15,bottom:5,left:10},fullWidth:!1,reverseData:!1,classNames:{chart:"ct-chart-line",label:"ct-label",labelGroup:"ct-labels",series:"ct-series",line:"ct-line",point:"ct-point",area:"ct-area",grid:"ct-grid",gridGroup:"ct-grids",gridBackground:"ct-grid-background",vertical:"ct-vertical",horizontal:"ct-horizontal",start:"ct-start",end:"ct-end"}};const ut={axisX:{offset:30,position:"end",labelOffset:{x:0,y:0},showLabel:!0,showGrid:!0,labelInterpolationFnc:g,scaleMinSpace:30,onlyInteger:!1},axisY:{offset:40,position:"start",labelOffset:{x:0,y:0},showLabel:!0,showGrid:!0,labelInterpolationFnc:g,scaleMinSpace:20,onlyInteger:!1},width:void 0,height:void 0,high:void 0,low:void 0,referenceValue:0,chartPadding:{top:15,right:15,bottom:5,left:10},seriesBarDistance:15,stackBars:!1,stackMode:"accumulate",horizontalBars:!1,distributeSeries:!1,reverseData:!1,showGridBackground:!1,classNames:{chart:"ct-chart-bar",horizontalBars:"ct-horizontal-bars",label:"ct-label",labelGroup:"ct-labels",series:"ct-series",bar:"ct-bar",grid:"ct-grid",gridGroup:"ct-grids",gridBackground:"ct-grid-background",vertical:"ct-vertical",horizontal:"ct-horizontal",start:"ct-start",end:"ct-end"}};const dt={width:void 0,height:void 0,chartPadding:5,classNames:{chartPie:"ct-chart-pie",chartDonut:"ct-chart-donut",series:"ct-series",slicePie:"ct-slice-pie",sliceDonut:"ct-slice-donut",label:"ct-label"},startAngle:0,total:void 0,donut:!1,donutWidth:60,showLabel:!0,labelOffset:0,labelPosition:"inside",labelInterpolationFnc:g,labelDirection:"neutral",reverseData:!1,ignoreEmptyValues:!1};function pt(t,e,s){const i=e.x>t.x;return i&&"explode"===s||!i&&"implode"===s?"start":i&&"implode"===s||!i&&"explode"===s?"end":"middle"}e.AutoScaleAxis=at,e.Axis=ot,e.BarChart=class extends nt{createChart(t){const{data:e}=this,s=T(e,t.reverseData,t.horizontalBars?"x":"y",!0),i=z(this.container,t.width,t.height,t.classNames.chart+(t.horizontalBars?" "+t.classNames.horizontalBars:"")),n=t.stackBars&&!0!==t.stackMode&&s.series.length?_([(r=s.series,y(r,(function(){for(var t=arguments.length,e=new Array(t),s=0;s<t;s++)e[s]=arguments[s];return Array.from(e).reduce(((t,e)=>({x:t.x+(b(e,"x")?e.x:0),y:t.y+(b(e,"y")?e.y:0)})),{x:0,y:0})})))],t,t.horizontalBars?"x":"y"):_(s.series,t,t.horizontalBars?"x":"y");var r;this.svg=i;const a=i.elem("g").addClass(t.classNames.gridGroup),l=i.elem("g"),c=i.elem("g").addClass(t.classNames.labelGroup);"number"==typeof t.high&&(n.high=t.high),"number"==typeof t.low&&(n.low=t.low);const h=H(i,t);let u;const d=t.distributeSeries&&t.stackBars?s.labels.slice(0,1):s.labels;let p,m,g;t.horizontalBars?(u=m=void 0===t.axisX.type?new at(rt.x,s.series,h,{...t.axisX,highLow:n,referenceValue:0}):new t.axisX.type(rt.x,s.series,h,{...t.axisX,highLow:n,referenceValue:0}),p=g=void 0===t.axisY.type?new lt(rt.y,s.series,h,{ticks:d}):new t.axisY.type(rt.y,s.series,h,t.axisY)):(p=m=void 0===t.axisX.type?new lt(rt.x,s.series,h,{ticks:d}):new t.axisX.type(rt.x,s.series,h,t.axisX),u=g=void 0===t.axisY.type?new at(rt.y,s.series,h,{...t.axisY,highLow:n,referenceValue:0}):new t.axisY.type(rt.y,s.series,h,{...t.axisY,highLow:n,referenceValue:0}));const f=t.horizontalBars?h.x1+u.projectValue(0):h.y1-u.projectValue(0),v=[];p.createGridAndLabels(a,c,t,this.eventEmitter),u.createGridAndLabels(a,c,t,this.eventEmitter),t.showGridBackground&&X(a,h,t.classNames.gridBackground,this.eventEmitter),e.series.forEach(((i,n)=>{const r=n-(e.series.length-1)/2;let a;a=t.distributeSeries&&!t.stackBars?p.axisLength/s.series.length/2:t.distributeSeries&&t.stackBars?p.axisLength/2:p.axisLength/s.series[n].length/2;const c=l.elem("g"),d=b(i,"name")&&i.name,y=b(i,"className")&&i.className,w=b(i,"meta")?i.meta:void 0;d&&c.attr({"ct:series-name":d}),w&&c.attr({"ct:meta":U(w)}),c.addClass([t.classNames.series,y||"".concat(t.classNames.series,"-").concat(o(n))].join(" ")),s.series[n].forEach(((e,o)=>{let l,d;l=t.distributeSeries&&!t.stackBars?n:t.distributeSeries&&t.stackBars?0:o,d=t.horizontalBars?{x:h.x1+u.projectValue(b(e,"x")?e.x:0,o,s.series[n]),y:h.y1-p.projectValue(b(e,"y")?e.y:0,l,s.series[n])}:{x:h.x1+p.projectValue(b(e,"x")?e.x:0,l,s.series[n]),y:h.y1-u.projectValue(b(e,"y")?e.y:0,o,s.series[n])},p instanceof lt&&(p.stretch||(d[p.units.pos]+=a*(t.horizontalBars?-1:1)),d[p.units.pos]+=t.stackBars||t.distributeSeries?0:r*t.seriesBarDistance*(t.horizontalBars?-1:1));const y=v[o]||f;if(v[o]=y-(f-d[p.counterUnits.pos]),void 0===e)return;const w={["".concat(p.units.pos,"1")]:d[p.units.pos],["".concat(p.units.pos,"2")]:d[p.units.pos]};!t.stackBars||"accumulate"!==t.stackMode&&t.stackMode?(w["".concat(p.counterUnits.pos,"1")]=f,w["".concat(p.counterUnits.pos,"2")]=d[p.counterUnits.pos]):(w["".concat(p.counterUnits.pos,"1")]=y,w["".concat(p.counterUnits.pos,"2")]=v[o]),w.x1=Math.min(Math.max(w.x1,h.x1),h.x2),w.x2=Math.min(Math.max(w.x2,h.x1),h.x2),w.y1=Math.min(Math.max(w.y1,h.y2),h.y1),w.y2=Math.min(Math.max(w.y2,h.y2),h.y1);const k=S(i,o),E=c.elem("line",w,t.classNames.bar).attr({"ct:value":[b(e,"x")&&e.x,b(e,"y")&&e.y].filter(x).join(","),"ct:meta":U(k)});this.eventEmitter.emit("draw",{type:"bar",value:e,index:o,meta:k,series:i,seriesIndex:n,axisX:m,axisY:g,chartRect:h,group:c,element:E,...w})}))})),this.eventEmitter.emit("created",{chartRect:h,axisX:m,axisY:g,svg:i,options:t})}constructor(t,e,s,i){super(t,e,ut,m({},ut,s),i),this.data=e}},e.BaseChart=nt,e.EPSILON=a,e.EventEmitter=st,e.FixedScaleAxis=class extends ot{projectValue(t){const e=Number(M(t,this.units.pos));return this.axisLength*(e-this.range.min)/(this.range.max-this.range.min)}constructor(t,e,s,i){const n=i.highLow||_(e,i,t.pos),r=i.divisor||1,o=(i.ticks||f(r).map(((t,e)=>n.low+(n.high-n.low)/r*e))).sort(((t,e)=>Number(t)-Number(e))),a={min:n.low,max:n.high};super(t,s,o),this.range=a}},e.Interpolation=et,e.LineChart=class extends nt{createChart(t){const{data:e}=this,s=T(e,t.reverseData,!0),i=z(this.container,t.width,t.height,t.classNames.chart);this.svg=i;const n=i.elem("g").addClass(t.classNames.gridGroup),r=i.elem("g"),a=i.elem("g").addClass(t.classNames.labelGroup),l=H(i,t);let c,h;c=void 0===t.axisX.type?new lt(rt.x,s.series,l,{...t.axisX,ticks:s.labels,stretch:t.fullWidth}):new t.axisX.type(rt.x,s.series,l,t.axisX),h=void 0===t.axisY.type?new at(rt.y,s.series,l,{...t.axisY,high:x(t.high)?t.high:t.axisY.high,low:x(t.low)?t.low:t.axisY.low}):new t.axisY.type(rt.y,s.series,l,t.axisY),c.createGridAndLabels(n,a,t,this.eventEmitter),h.createGridAndLabels(n,a,t,this.eventEmitter),t.showGridBackground&&X(n,l,t.classNames.gridBackground,this.eventEmitter),e.series.forEach(((e,i)=>{const n=r.elem("g"),a=b(e,"name")&&e.name,u=b(e,"className")&&e.className,d=b(e,"meta")?e.meta:void 0;a&&n.attr({"ct:series-name":a}),d&&n.attr({"ct:meta":U(d)}),n.addClass([t.classNames.series,u||"".concat(t.classNames.series,"-").concat(o(i))].join(" "));const p=[],m=[];s.series[i].forEach(((t,n)=>{const r={x:l.x1+c.projectValue(t,n,s.series[i]),y:l.y1-h.projectValue(t,n,s.series[i])};p.push(r.x,r.y),m.push({value:t,valueIndex:n,meta:S(e,n)})}));const g={lineSmooth:ct(e,t,"lineSmooth"),showPoint:ct(e,t,"showPoint"),showLine:ct(e,t,"showLine"),showArea:ct(e,t,"showArea"),areaBase:ct(e,t,"areaBase")};let f;f="function"==typeof g.lineSmooth?g.lineSmooth:g.lineSmooth?tt():$();const v=f(p,m);if(g.showPoint&&v.pathElements.forEach((s=>{const{data:r}=s,o=n.elem("line",{x1:s.x,y1:s.y,x2:s.x+.01,y2:s.y},t.classNames.point);if(r){let t,e;b(r.value,"x")&&(t=r.value.x),b(r.value,"y")&&(e=r.value.y),o.attr({"ct:value":[t,e].filter(x).join(","),"ct:meta":U(r.meta)})}this.eventEmitter.emit("draw",{type:"point",value:null==r?void 0:r.value,index:(null==r?void 0:r.valueIndex)||0,meta:null==r?void 0:r.meta,series:e,seriesIndex:i,axisX:c,axisY:h,group:n,element:o,x:s.x,y:s.y,chartRect:l})})),g.showLine){const r=n.elem("path",{d:v.stringify()},t.classNames.line,!0);this.eventEmitter.emit("draw",{type:"line",values:s.series[i],path:v.clone(),chartRect:l,index:i,series:e,seriesIndex:i,meta:d,axisX:c,axisY:h,group:n,element:r})}if(g.showArea&&h.range){const r=Math.max(Math.min(g.areaBase,h.range.max),h.range.min),o=l.y1-h.projectValue(r);v.splitByCommand("M").filter((t=>t.pathElements.length>1)).map((t=>{const e=t.pathElements[0],s=t.pathElements[t.pathElements.length-1];return t.clone(!0).position(0).remove(1).move(e.x,o).line(e.x,e.y).position(t.pathElements.length+1).line(s.x,o)})).forEach((r=>{const o=n.elem("path",{d:r.stringify()},t.classNames.area,!0);this.eventEmitter.emit("draw",{type:"area",values:s.series[i],path:r.clone(),series:e,seriesIndex:i,axisX:c,axisY:h,chartRect:l,index:i,group:n,element:o,meta:d})}))}})),this.eventEmitter.emit("created",{chartRect:l,axisX:c,axisY:h,svg:i,options:t})}constructor(t,e,s,i){super(t,e,ht,m({},ht,s),i),this.data=e}},e.PieChart=class extends nt{createChart(t){const{data:e}=this,s=T(e),i=[];let n,a,l=t.startAngle;const c=z(this.container,t.width,t.height,t.donut?t.classNames.chartDonut:t.classNames.chartPie);this.svg=c;const h=H(c,t);let u=Math.min(h.width()/2,h.height()/2);const p=t.total||s.series.reduce(v,0),m=r(t.donutWidth);"%"===m.unit&&(m.value*=u/100),u-=t.donut?m.value/2:0,a="outside"===t.labelPosition||t.donut?u:"center"===t.labelPosition?0:u/2,t.labelOffset&&(a+=t.labelOffset);const g={x:h.x1+h.width()/2,y:h.y2+h.height()/2},f=1===e.series.filter((t=>b(t,"value")?0!==t.value:0!==t)).length;e.series.forEach(((t,e)=>i[e]=c.elem("g"))),t.showLabel&&(n=c.elem("g")),e.series.forEach(((r,c)=>{var v,y;if(0===s.series[c]&&t.ignoreEmptyValues)return;const x=b(r,"name")&&r.name,k=b(r,"className")&&r.className,E=b(r,"meta")?r.meta:void 0;x&&i[c].attr({"ct:series-name":x}),i[c].addClass([null===(v=t.classNames)||void 0===v?void 0:v.series,k||"".concat(null===(y=t.classNames)||void 0===y?void 0:y.series,"-").concat(o(c))].join(" "));let S=p>0?l+s.series[c]/p*360:0;const L=Math.max(0,l-(0===c||f?0:.2));S-L>=359.99&&(S=L+359.99);const A=d(g.x,g.y,u,L),C=d(g.x,g.y,u,S),M=new K(!t.donut).move(C.x,C.y).arc(u,u,0,Number(S-l>180),0,A.x,A.y);t.donut||M.line(g.x,g.y);const _=i[c].elem("path",{d:M.stringify()},t.donut?t.classNames.sliceDonut:t.classNames.slicePie);if(_.attr({"ct:value":s.series[c],"ct:meta":U(E)}),t.donut&&_.attr({style:"stroke-width: "+m.value+"px"}),this.eventEmitter.emit("draw",{type:"slice",value:s.series[c],totalDataSum:p,index:c,meta:E,series:r,group:i[c],element:_,path:M.clone(),center:g,radius:u,startAngle:l,endAngle:S,chartRect:h}),t.showLabel){let i,o;i=1===e.series.length?{x:g.x,y:g.y}:d(g.x,g.y,a,l+(S-l)/2),o=s.labels&&!w(s.labels[c])?s.labels[c]:s.series[c];const u=t.labelInterpolationFnc(o,c);if(u||0===u){const e=n.elem("text",{dx:i.x,dy:i.y,"text-anchor":pt(g,i,t.labelDirection)},t.classNames.label).text(String(u));this.eventEmitter.emit("draw",{type:"label",index:c,group:n,element:e,text:""+u,chartRect:h,series:r,meta:E,...i})}}l=S})),this.eventEmitter.emit("created",{chartRect:h,svg:c,options:t})}constructor(t,e,s,i){super(t,e,dt,m({},dt,s),i),this.data=e}},e.StepAxis=lt,e.Svg=R,e.SvgList=V,e.SvgPath=K,e.alphaNumerate=o,e.axisUnits=rt,e.createChartRect=H,e.createGrid=q,e.createGridBackground=X,e.createLabel=G,e.createSvg=z,e.deserialize=function(t){if("string"!=typeof t)return t;if("NaN"===t)return NaN;let e=t=Object.keys(i).reduce(((t,e)=>t.replaceAll(i[e],e)),t);if("string"==typeof t)try{e=JSON.parse(t),e=void 0!==e.data?e.data:e}catch(t){}return e},e.determineAnchorPosition=pt,e.easings=D,e.ensureUnit=n,e.escapingMap=i,e.extend=m,e.getBounds=p,e.getHighLow=_,e.getMetaData=S,e.getMultiValue=M,e.getNumberOrUndefined=k,e.getSeriesOption=ct,e.isArrayOfArrays=E,e.isArrayOfSeries=A,e.isDataHoleValue=L,e.isFalseyButZero=w,e.isMultiValue=C,e.isNumeric=x,e.namespaces=s,e.noop=g,e.normalizeData=T,e.normalizePadding=F,e.optionsProvider=Y,e.orderOfMagnitude=l,e.polarToCartesian=d,e.precision=8,e.projectLength=c,e.quantity=r,e.rho=u,e.roundWithPrecision=h,e.safeHasProperty=b,e.serialMap=y,e.serialize=U,e.splitIntoSegments=N,e.sum=v,e.times=f}},i={};function n(t){var e=i[t];if(void 0!==e)return e.exports;var r=i[t]={exports:{}};return s[t].call(r.exports,r,r.exports,n),r.exports}n.m=s,n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,{a:e}),e},n.d=function(t,e){for(var s in e)n.o(e,s)&&!n.o(t,s)&&Object.defineProperty(t,s,{enumerable:!0,get:e[s]})},n.f={},n.e=function(t){return Promise.all(Object.keys(n.f).reduce((function(e,s){return n.f[s](t,e),e}),[]))},n.u=function(t){return t+".bundle.js"},n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},t={},e="ulogger-server:",n.l=function(s,i,r,o){if(t[s])t[s].push(i);else{var a,l;if(void 0!==r)for(var c=document.getElementsByTagName("script"),h=0;h<c.length;h++){var u=c[h];if(u.getAttribute("src")==s||u.getAttribute("data-webpack")==e+r){a=u;break}}a||(l=!0,(a=document.createElement("script")).charset="utf-8",a.timeout=120,n.nc&&a.setAttribute("nonce",n.nc),a.setAttribute("data-webpack",e+r),a.src=s),t[s]=[i];var d=function(e,i){a.onerror=a.onload=null,clearTimeout(p);var n=t[s];if(delete t[s],a.parentNode&&a.parentNode.removeChild(a),n&&n.forEach((function(t){return t(i)})),e)return e(i)},p=setTimeout(d.bind(null,void 0,{type:"timeout",target:a}),12e4);a.onerror=d.bind(null,a.onerror),a.onload=d.bind(null,a.onload),l&&document.head.appendChild(a)}},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.p="js/dist/",function(){var t={179:0};n.f.j=function(e,s){var i=n.o(t,e)?t[e]:void 0;if(0!==i)if(i)s.push(i[2]);else{var r=new Promise((function(s,n){i=t[e]=[s,n]}));s.push(i[2]=r);var o=n.p+n.u(e),a=new Error;n.l(o,(function(s){if(n.o(t,e)&&(0!==(i=t[e])&&(t[e]=void 0),i)){var r=s&&("load"===s.type?"missing":s.type),o=s&&s.target&&s.target.src;a.message="Loading chunk "+e+" failed.\n("+r+": "+o+")",a.name="ChunkLoadError",a.type=r,a.request=o,i[1](a)}}),"chunk-"+e,e)}};var e=function(e,s){var i,r,o=s[0],a=s[1],l=s[2],c=0;if(o.some((function(e){return 0!==t[e]}))){for(i in a)n.o(a,i)&&(n.m[i]=a[i]);if(l)l(n)}for(e&&e(s);c<o.length;c++)r=o[c],n.o(t,r)&&t[r]&&t[r][0](),t[r]=0},s=self.webpackChunkulogger_server=self.webpackChunkulogger_server||[];s.forEach(e.bind(null,0)),s.push=e.bind(null,s.push.bind(s))}(),function(){"use strict";var t=n(293),e=n.n(t);class s{static post(t,e,s){const i=s||{};return i.method="POST",this.ajax(t,e,i)}static get(t,e,s){const i=s||{};return i.method="GET",this.ajax(t,e,i)}static ajax(t,s,i){const n=[];s=s||{};const r=(i=i||{}).method||"GET",o=new XMLHttpRequest;return new Promise(((i,a)=>{let l;if(o.onreadystatechange=function(){if(o.readyState!==XMLHttpRequest.DONE)return;let t="",e=!0;if(200===o.status)try{const s=JSON.parse(o.responseText);s&&(s.error?s.message&&(t=s.message):(i&&"function"==typeof i&&i(s),e=!1))}catch(e){t=e.message}else t="HTTP error ".concat(o.status);e&&a&&"function"==typeof a&&a(new Error(t))},s instanceof HTMLFormElement&&(s=new FormData(s)),s instanceof FormData)l="POST"===r?s:new(e())(s).toString();else{for(const t in s)if(s.hasOwnProperty(t))if(Array.isArray(s[t]))for(const e of s[t])n.push("".concat(t,"[]=").concat(this.encodeValue(e)));else n.push("".concat(t,"=").concat(this.encodeValue(s[t])));l=n.join("&"),l=l.replace(/%20/g,"+")}"GET"===r&&l.length&&(t+="?".concat(l),l=null),o.open(r,t,!0),"POST"!==r||s instanceof FormData||o.setRequestHeader("Content-type","application/x-www-form-urlencoded"),o.send(l)}))}static encodeValue(t){return"object"==typeof t&&(t=JSON.stringify(t)),encodeURIComponent(t)}}class i{static observe(t,e,s){if("object"!=typeof t||null===t)throw new Error("Invalid argument: invalid object");if("function"==typeof s)this.observeProperty(t,e,s);else{if("function"!=typeof e)throw new Error("Invalid argument for observe");this.observeRecursive(t,e)}}static notify(t,e){for(const s of t)(async()=>{await s(e)})()}static forceUpdate(t,e){const s=t._values[e],i=t._observers[e];this.notify(i,s)}static isObserved(t,e,s){if("object"!=typeof t||null===t||!t.hasOwnProperty(e))return!1;const i=!!(t._observers&&t._observers[e]&&t._observers[e].size>0);return i&&s?t._observers[e].has(s):i}static setSilently(t,e,s){if(!t.hasOwnProperty(e))throw new Error('Invalid argument: object does not have property "'.concat(e,'"'));if(this.isObserved(t,e)){if(t._values[e]=s,Array.isArray(t[e]))for(const s of t._observers[e])this.observeArray(t[e],s)}else t[e]=s}static observeProperty(t,e,s){if(!t.hasOwnProperty(e))throw new Error('Invalid argument: object does not have property "'.concat(e,'"'));if(this.isObserved(t,e,s))throw new Error("Observer already registered for property ".concat(e));this.addObserver(t,s,e),t.hasOwnProperty("_values")||Object.defineProperty(t,"_values",{enumerable:!1,configurable:!1,value:{}}),t._values[e]=t[e],Object.defineProperty(t,e,{get:()=>t._values[e],set:s=>{t._values[e]!==s&&(t._values[e]=s,"".concat(e," = "),Array.isArray(s)&&s.length&&"[".concat(s[0],", …](").concat(s.length,")"),i.notify(t._observers[e],s)),Array.isArray(t[e])&&this.observeArray(t[e],t._observers[e])}}),Array.isArray(t[e])&&this.observeArray(t[e],s)}static observeRecursive(t,e){if(Array.isArray(t))this.observeArray(t,e);else for(const s in t)t.hasOwnProperty(s)&&i.observeProperty(t,s,e)}static observeArray(t,e){if(e instanceof Set)for(const s of e)this.addObserver(t,s);else this.addObserver(t,e);this.overrideArrayPrototypes(t,arguments)}static addObserver(t,e,s){t.hasOwnProperty("_observers")||Object.defineProperty(t,"_observers",{enumerable:!1,configurable:!1,value:3===arguments.length?[]:new Set}),3===arguments.length?(t._observers[s]||(t._observers[s]=new Set),t._observers[s].add(e)):t._observers.add(e)}static unobserve(t,e,s){if("function"==typeof s)this.unobserveProperty(t,e,s);else{if("function"!=typeof e)throw new Error("Invalid argument for unobserve");Array.isArray(t)?this.unobserveArray(t,e):this.unobserveRecursive(t,e)}}static unobserveAll(t,e){if(1===arguments.length)for(const e in t)t.hasOwnProperty(e)&&this.unobserveAll(t,e);else if(this.isObserved(t,e)){if("Removing all observers for ".concat(e,"…"),Array.isArray(t[e]))this.restoreArrayPrototypes(t[e]);else if("object"==typeof t[e]&&null!==t[e])for(const s in t[e])t[e].hasOwnProperty(s)&&this.unobserveAll(t[e],s);delete t._observers[e],delete t[e],t[e]=t._values[e],delete t._values[e]}}static unobserveProperty(t,e,s){Array.isArray(t[e])&&this.unobserveArray(t[e],s),this.removeObserver(t,s,e),t._observers[e].size||(delete t[e],t[e]=t._values[e],delete t._values[e])}static unobserveRecursive(t,e){for(const s in t)t.hasOwnProperty(s)&&i.unobserveProperty(t,s,e)}static unobserveArray(t,e){this.removeObserver(t,e),t._observers.size||this.restoreArrayPrototypes(t)}static overrideArrayPrototypes(t){["pop","push","reverse","shift","sort","splice","unshift"].forEach((e=>{const s=Object.getOwnPropertyDescriptor(Array.prototype,e);t.hasOwnProperty(e)||(s.value=function(){const s=Array.prototype[e].apply(t,arguments);return"[".concat(e,"] "),t.length&&"[".concat(t[0],", …](").concat(t.length,")"),i.notify(t._observers,t),s},Object.defineProperty(t,e,s))}))}static restoreArrayPrototypes(t){["pop","push","reverse","shift","sort","splice","unshift"].forEach((e=>{delete t[e]}))}static removeObserver(t,e,s){if(!t.hasOwnProperty("_observers"))return;let i;if(3===arguments.length){if(!t._observers[s])return;i=t._observers[s],"Removing observer for ".concat(s,"…")}else i=t._observers;i.forEach((t=>{t===e&&i.delete(t)}))}}class r{constructor(t,e,s){if(!(t instanceof HTMLSelectElement))throw new Error("Invalid argument for select");this.element=t,this.hasAllOption=!1,this.allText="",s&&s.length&&(this.allText=s),e&&e.length?this.head=e:(this.hasHead=!1,this.headText="")}set selected(t){this.hasValue(t)&&(this.element.value=t)}get selected(){return this.element.value}set head(t){t.length&&(this.hasHead=!0,this.headText=t,this.addHead())}get head(){return this.headText}showAllOption(t){t&&(this.allText=t),this.hasAllOption=!0;const e=this.hasHead?1:0;this.element.add(new Option(this.allText,r.allValue),e)}hideAllOption(){const t=this.selected===r.allValue;this.hasAllOption=!1,this.remove(r.allValue),t&&(this.selected=this.hasHead?r.headValue:"",this.element.dispatchEvent(new Event("change")))}addHead(){const t=new Option(this.headText,r.headValue,!0,!0);t.disabled=!0,this.element.options.add(t,0)}hasValue(t){return void 0!==this.getOption(t)}getOption(t){return[...this.element.options].find((e=>e.value===t))}remove(t){const e=this.getOption(t);e&&this.element.remove(e.index)}setOptions(t,e){e=e||this.element.value,this.element.options.length=0,this.hasHead&&this.addHead(),this.hasAllOption&&this.element.add(new Option(this.allText,r.allValue,!1,e===r.allValue));for(const s of t){const t=new Option(s.listText,s.listValue,!1,e===s.listValue);this.element.add(t),i.observe(s,"listText",(e=>{t.text=e}))}}static get allValue(){return"all"}static get headValue(){return"0"}}class o{constructor(){this.listValue=r.allValue,this.listText="-"}listItem(t,e){this.listValue=String(t),this.listText=String(e)}toString(){return"[".concat(this.listValue,", ").concat(this.listText,"]")}}class a{static setCookie(t,e){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:30,i="";if(s){const t=new Date;t.setTime(t.getTime()+24*s*60*60*1e3),i="; expires=".concat(t.toUTCString())}document.cookie="ulogger_".concat(t,"=").concat(e).concat(i,"; path=/; samesite=lax")}static sprintf(t){for(var e=arguments.length,s=new Array(e>1?e-1:0),i=1;i<e;i++)s[i-1]=arguments[i];let n=0;const r=t.replace(/%%|%s|%d/g,(t=>{if("%%"===t)return"%";if("%d"===t&&isNaN(s[n])&&void 0!==s[n])throw new Error("Wrong format specifier ".concat(t," for ").concat(s[n]," argument"));if(void 0===s[n])throw new Error("Missing argument for format specifier ".concat(t));return s[n++]}));if(n<s.length)throw new Error("Unused argument for format specifier ".concat(t));return r}static addScript(t,e,s,i){if(e&&document.getElementById(e))return void(s instanceof Function&&s());const n=document.createElement("script");n.type="text/javascript",n.src=t,e&&(n.id=e),n.async=!0,s instanceof Function&&(n.onload=s),i instanceof Function&&(n.onerror=()=>i(new Error("error loading ".concat(e," script")))),document.getElementsByTagName("head")[0].appendChild(n)}static loadScript(t,e){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1e4;const i=new Promise(((s,i)=>a.addScript(t,e,s,i))),n=this.timeoutPromise(s);return Promise.race([i,n])}static timeoutPromise(t){return new Promise(((e,s)=>{const i=setTimeout((()=>{clearTimeout(i),s(new Error("timeout (".concat(t," ms).")))}),t)}))}static htmlEncode(t){return t.replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&#39;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}static hexToRGBA(t,e){return e=void 0!==e?e:1,"rgba(".concat((t=t.replace("#","")).match(new RegExp("(.{".concat(t.length/3,"})"),"g")).map((e=>parseInt(t.length%2?e+e:e,16))).concat(e).join(","),")")}static getScaleColor(t,e,s){if(s<0||s>1)throw new Error("Invalid value");const i=[];for(let n=0;n<3;n++){if(t[n]<0||t[n]>255||e[n]<0||e[n]>255)throw new Error("Invalid value");i[n]=Math.round((e[n]-t[n])*s+t[n])}return"rgb(".concat(i[0],", ").concat(i[1],", ").concat(i[2],")")}static addCss(t,e){if(e&&document.getElementById(e))return;const s=document.createElement("link");s.type="text/css",s.rel="stylesheet",s.href=t,e&&(s.id=e),document.getElementsByTagName("head")[0].appendChild(s)}static removeElementById(t){const e=document.getElementById(t);e&&e.remove()}static nodeFromHtml(t){const e=document.createElement("template");return e.innerHTML=t.trim(),e.content.childNodes.length>1?e.content.childNodes:e.content.firstChild}static getFloat(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return a.getParsed(t,e,"float")}static getInteger(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return a.getParsed(t,e,"int")}static getString(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return a.getParsed(t,e,"string")}static getParsed(t,e,s){if(e&&null===t)return null;let i;switch(s){case"float":i=parseFloat(t);break;case"int":i=Math.round(parseFloat(t));break;case"string":i=String(t);break;default:throw new Error("Unknown type")}if(null==t||"string"!==s&&isNaN(i))throw new Error("Invalid value");return i}static getTimeString(t){let e="";return{date:"".concat(t.getFullYear(),"-").concat("0".concat(t.getMonth()+1).slice(-2),"-").concat("0".concat(t.getDate()).slice(-2)),time:t.toTimeString().replace(/^\s*([^ ]+)([^(]*)(\([^)]*\))*/,((t,s,i,n)=>(i&&(e=i.replace(/(0(?=[1-9]00))|(00\b)/g,""),n&&/[A-Z]/.test(n)&&(e+=n.match(/\b[A-Z]+/g).join(""))),s))),zone:e}}static openUrl(t){window.location.assign(t)}static deg2rad(t){return t*Math.PI/180}static isDeepEqual(t,e){return Object.keys(t).every((s=>"object"==typeof t[s]&&null!==t[s]&&"object"==typeof e[s]&&null!==e[s]?this.isDeepEqual(t[s],e[s]):t[s]===e[s]))}}class l{static fromJson(t){const e=new l;return e.id=a.getInteger(t.id),e.latitude=a.getFloat(t.latitude),e.longitude=a.getFloat(t.longitude),e.altitude=a.getInteger(t.altitude,!0),e.speed=a.getFloat(t.speed,!0),e.bearing=a.getInteger(t.bearing,!0),e.accuracy=a.getInteger(t.accuracy,!0),e.provider=a.getString(t.provider,!0),e.comment=a.getString(t.comment,!0),e.image=a.getString(t.image,!0),e.username=a.getString(t.username),e.trackname=a.getString(t.trackname),e.trackid=a.getInteger(t.trackid),e.timestamp=a.getInteger(t.timestamp),e.meters=a.getInteger(t.meters),e.seconds=a.getInteger(t.seconds),e.totalMeters=0,e.totalSeconds=0,e}hasComment(){return null!=this.comment&&this.comment.length>0}hasImage(){return null!=this.image&&this.image.length>0}hasSpeed(){return null!=this.speed}hasAltitude(){return null!=this.altitude}getImagePath(){return this.hasImage()?"uploads/".concat(this.image):null}get totalSpeed(){return this.totalSeconds?this.totalMeters/this.totalSeconds:0}delete(){return l.update({action:"delete",posid:this.id})}save(){return l.update({action:"update",posid:this.id,comment:this.comment})}imageDelete(){return l.update({action:"imagedel",posid:this.id}).then((()=>{this.image=null}))}imageAdd(t){const e=new FormData;return e.append("image",t),e.append("action","imageadd"),e.append("posid",this.id),l.update(e).then((t=>{this.image=t.image}))}static update(t){return s.post("utils/handleposition.php",t)}distanceTo(t){const e=a.deg2rad(this.latitude),s=a.deg2rad(this.longitude),i=a.deg2rad(t.latitude),n=i-e,r=a.deg2rad(t.longitude)-s;return 6371e3*(2*Math.asin(Math.sqrt(Math.sin(n/2)**2+Math.cos(e)*Math.cos(i)*Math.sin(r/2)**2)))}secondsTo(t){return this.timestamp-t.timestamp}}class c extends o{constructor(){super(),this.positions=[]}clear(){this.positions.length=0}get length(){return this.positions.length}get hasPositions(){return this.positions.length>0}isLastPosition(t){return!0}isFirstPosition(t){return!0}fromJson(t){let e=[];arguments.length>1&&void 0!==arguments[1]&&arguments[1]?e=this.positions:this.clear();for(const s of t)e.push(l.fromJson(s));this.positions=e}fetchLatest(){return this.clear(),c.fetch({last:!0}).then((t=>{this.fromJson(t)}))}static fetchLatest(){const t=new c;return t.fetchLatest().then((()=>t.length?t:null))}static fetch(t){return s.get("utils/getpositions.php",t)}}class h extends c{constructor(t,e,s){if(super(),!Number.isSafeInteger(t)||t<=0||!e||!(s instanceof u))throw new Error("Invalid argument for track constructor");this.id=t,this.name=e,this.user=s,this.plotData=[],this.maxId=0,this.maxSpeed=0,this.maxAltitude=null,this.minAltitude=null,this.totalMeters=0,this.totalSeconds=0,this.listItem(t,e)}setName(t){this.name=t,this.listText=t}clear(){super.clear(),this.clearTrackCounters()}clearTrackCounters(){this.maxId=0,this.maxSpeed=0,this.maxAltitude=null,this.minAltitude=null,this.plotData.length=0,this.totalMeters=0,this.totalSeconds=0}isEqualTo(t){return!!t&&t.id===this.id}get hasPlotData(){return this.plotData.length>0}get hasAltitudes(){return null!==this.maxAltitude}get hasSpeeds(){return this.maxSpeed>0}fromJson(t){let e=[];arguments.length>1&&void 0!==arguments[1]&&arguments[1]&&this.hasPositions?e=this.positions:this.clear();for(const s of t){const t=l.fromJson(s);this.calculatePosition(t),e.push(t)}this.positions=e}isLastPosition(t){return this.length>0&&t===this.length-1}isFirstPosition(t){return this.length>0&&0===t}fetchPositions(){const t={userid:this.user.id,trackid:this.id};return this.maxId&&(t.afterid=this.maxId),c.fetch(t).then((e=>{this.fromJson(e,t.afterid>0)}))}static fetchLatest(t){return this.fetch({last:!0,userid:t.id}).then((e=>{if(e.length){const s=new h(e[0].trackid,e[0].trackname,t);return s.fromJson(e),s}return null}))}static fetchList(t){return s.get("utils/gettracks.php",{userid:t.id}).then((e=>{const s=[];for(const i of e)s.push(new h(i.id,i.name,t));return s}))}export(t){if(this.hasPositions){const e="utils/export.php?type=".concat(t,"&userid=").concat(this.user.id,"&trackid=").concat(this.id);a.openUrl(e)}}static import(t,e){return s.post("utils/import.php",t).then((t=>{const s=[];for(const i of t)s.push(new h(i.id,i.name,e));return s}))}delete(){return h.update({action:"delete",trackid:this.id})}saveMeta(){return h.update({action:"update",trackid:this.id,trackname:this.name})}static getMeta(t){return h.update({action:"getmeta",trackid:t})}static update(t){return s.post("utils/handletrack.php",t)}recalculatePositions(){this.clearTrackCounters();let t=null;for(const e of this.positions)e.meters=t?e.distanceTo(t):0,e.seconds=t?e.secondsTo(t):0,this.calculatePosition(e),t=e}calculatePosition(t){this.totalMeters+=t.meters,this.totalSeconds+=t.seconds,t.totalMeters=this.totalMeters,t.totalSeconds=this.totalSeconds,t.hasAltitude()&&(this.plotData.push({x:t.totalMeters,y:t.altitude}),(null===this.maxAltitude||t.altitude>this.maxAltitude)&&(this.maxAltitude=t.altitude),(null===this.minAltitude||t.altitude<this.minAltitude)&&(this.minAltitude=t.altitude)),t.id>this.maxId&&(this.maxId=t.id),t.hasSpeed()&&t.speed>this.maxSpeed&&(this.maxSpeed=t.speed)}}class u extends o{constructor(t,e){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(super(),!Number.isSafeInteger(t)||t<=0)throw new Error("Invalid argument for user constructor");this.id=t,this.login=e,this.isAdmin=s,this.listItem(t,e)}isEqualTo(t){return!!t&&t.id===this.id}fetchLastPosition(){return h.fetchLatest(this)}static fetchList(){return s.get("utils/getusers.php").then((t=>{const e=[];for(const s of t)e.push(new u(s.id,s.login,s.isAdmin));return e}))}delete(){return u.update({action:"delete",login:this.login})}static add(t,e){return u.update({action:"add",login:t,pass:e}).then((e=>new u(e.id,t)))}static update(t){return s.post("utils/handleuser.php",t)}setPassword(t,e){return s.post("utils/changepass.php",{login:this.login,pass:t,oldpass:e})}modify(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;const s={action:"update",login:this.login,admin:t};return e&&(s.pass=e),u.update(s).then((()=>{this.isAdmin=t}))}}class d{constructor(){this._isAdmin=!1,this._isAuthenticated=!1,this._user=null}set user(t){t?(this._user=t,this._isAuthenticated=!0):(this._user=null,this._isAuthenticated=!1,this._isAdmin=!1)}set isAdmin(t){if(!this._user)throw new Error("No authenticated user");this._isAdmin=t}get isAdmin(){return this._isAdmin}get isAuthenticated(){return this._isAuthenticated}get user(){return this._user}load(t){t&&t.isAuthenticated&&(this.user=new u(t.userId,t.userLogin),this.isAdmin=t.isAdmin)}}class p extends o{constructor(t,e,s,i){super(),this.id=t,this.name=e,this.url=s,this.priority=i,this.listItem(t,e)}setName(t){this.name=t,this.listItem(this.id,this.name)}setUrl(t){this.url=t}}class m extends Array{addNewLayer(t,e){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;this.addLayer(this.getMaxId()+1,t,e,s)}addLayer(t,e,s){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;this.push(new p(t,e,s,i))}delete(t){const e=this.map((t=>t.id)).indexOf(t);this.splice(e,1)}get(t){return this.find((e=>e.id===t))}getMaxId(){return Math.max(...this.map((t=>t.id)),0)}setPriorityLayer(t){for(const e of this)e.id>0&&e.id===t?e.priority=1:e.priority=0}getPriorityLayer(){for(const t of this)if(t.priority>0)return t.id;return 0}load(t){this.length=0;for(const e of t)e.id>0&&this.addLayer(e.id,e.name,e.url,e.priority)}}class g{constructor(){this.initialize()}initialize(){this.interval=10,this.units="metric",this.lang="en",this.mapApi="openlayers",this.googleKey="",this.olLayers=new m,this.initLatitude=52.23,this.initLongitude=21.01,this.requireAuth=!0,this.publicTracks=!1,this.passStrength=2,this.passLenMin=10,this.strokeWeight=2,this.strokeColor="#ff0000",this.strokeOpacity=1,this.colorNormal="#ffffff",this.colorStart="#55b500",this.colorStop="#ff6a00",this.colorExtra="#cccccc",this.colorHilite="#feff6a",this.uploadMaxSize=0,this.initUnits()}initUnits(){"imperial"===this.units?(this.factorSpeed=2.237,this.unitSpeed="unitmph",this.factorDistance=3.28,this.unitDistance="unitft",this.factorDistanceMajor=.621,this.unitDistanceMajor="unitmi"):"nautical"===this.units?(this.factorSpeed=1.944,this.unitSpeed="unitkt",this.factorDistance=1,this.unitDistance="unitm",this.factorDistanceMajor=.54,this.unitDistanceMajor="unitnm"):(this.factorSpeed=3.6,this.unitSpeed="unitkmh",this.factorDistance=1,this.unitDistance="unitm",this.factorDistanceMajor=1,this.unitDistanceMajor="unitkm"),this.unitDay="unitday",this.unitAltitude="unitamsl"}load(t){if(t){for(const e in t)"layers"===e?this.olLayers.load(t[e]):t.hasOwnProperty(e)&&this.hasOwnProperty(e)&&(this[e]=t[e]);this.initUnits()}}save(t){return this.load(t),t=Object.keys(this).filter((t=>"function"!=typeof this[t])).reduce(((t,e)=>(t[e]=this[e],t)),{}),s.post("utils/saveconfig.php",t)}reinitialize(){i.unobserveAll(this),this.initialize()}onChanged(t,e){i.observe(this,t,e)}validPassStrength(t){return this.getPassRegExp().test(t)}getPassRegExp(){let t="";return this.passStrength>0&&(t+="(?=.*[a-z])(?=.*[A-Z])"),this.passStrength>1&&(t+="(?=.*[0-9])"),this.passStrength>2&&(t+="(?=.*[^a-zA-Z0-9])"),this.passLenMin>0&&(t+="(?=.{".concat(this.passLenMin,",})")),0===t.length&&(t=".*"),new RegExp(t)}}class f{constructor(){this.strings={},this.config=null}init(t,e){this.config=t,e&&(this.strings=e)}_(t){if(void 0===this.strings[t])throw new Error("Unknown localized string");for(var e=arguments.length,s=new Array(e>1?e-1:0),i=1;i<e;i++)s[i-1]=arguments[i];return s.length?a.sprintf(this.strings[t],...s):this.strings[t]}unit(t){const e=this.config[t];if(void 0===this.config[t])throw new Error("Unknown localized unit");return this._(e)}getLocaleSpeed(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];let s=(Math.round(t*this.config.factorSpeed*100)/100).toLocaleString(this.config.lang);return e&&(s+=" ".concat(this.unit("unitSpeed"))),s}getLocaleDistanceMajor(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];let s=(Math.round(t*this.config.factorDistanceMajor/10)/100).toLocaleString(this.config.lang);return e&&(s+=" ".concat(this.unit("unitDistanceMajor"))),s}getLocaleDistance(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];let s=(Math.round(t*this.config.factorDistance*100)/100).toLocaleString(this.config.lang);return e&&(s+=" ".concat(this.unit("unitDistance"))),s}getLocaleAltitude(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],s=this.getLocaleDistance(t,e);return e&&(s+=" ".concat(this.unit("unitAltitude"))),s.replace("-","−")}getLocaleAccuracy(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this.getLocaleDistance(t,e)}getLocaleDuration(t){const e=Math.floor(t/86400),s=Math.floor(t%86400/3600),i=Math.floor(t%86400%3600/60);return t=t%86400%3600%60,(e>0?"".concat(e," ").concat(this.unit("unitDay")," "):"")+"00".concat(s).slice(-2)+":"+"00".concat(i).slice(-2)+":"+"00".concat(t).slice(-2)}getLocaleCoordinates(t){return"".concat(this.coordStr(t.longitude,!0)," ").concat(this.coordStr(t.latitude,!1))}coordStr(t,e){const s=Math.trunc(t),i=Math.round(100*(Math.abs(60*(t-s))+Number.EPSILON))/100;let n;return n=e?t<0?"W":"E":t<0?"S":"N","".concat(Math.abs(s).toLocaleString(this.config.lang),"°").concat(i.toLocaleString(this.config.lang,{maximumFractionDigits:2}),"'").concat(n)}getLocalePassRules(){let t="";return this.config.passLenMin>0&&(t=a.sprintf(this._("passlenmin")+"\n",this.config.passLenMin)),this.config.passStrength>0&&this.config.passStrength<4&&(t+=this._("passrules_".concat(this.config.passStrength))),t}getLangList(){return this.strings.langArr||{}}}class v{constructor(){this.auth=new d,this.config=new g,this.lang=new f}initialize(){return s.get("utils/getinit.php").then((t=>{if(!(t&&t.auth&&t.config&&t.lang))throw new Error("Corrupted initialization data");this.auth.load(t.auth),this.config.load(t.config),this.lang.init(this.config,t.lang)}))}static waitForDom(){return new Promise((t=>{"complete"===document.readyState||"interactive"===document.readyState?setTimeout(t,1):document.addEventListener("DOMContentLoaded",t)}))}}const y=new v,b=y.config,x=y.lang,w=y.auth,k={svg:"http://www.w3.org/2000/svg",xmlns:"http://www.w3.org/2000/xmlns/",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",ct:"http://gionkunz.github.com/chartist-js/ct"},E={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#039;"};function S(t,e){return"number"==typeof t?t+e:t}function L(t){if("string"==typeof t){const e=/^(\d+)\s*(.*)$/g.exec(t);return{value:e?+e[1]:0,unit:(null==e?void 0:e[2])||void 0}}return{value:Number(t)}}function A(t){return String.fromCharCode(97+t%26)}const C=2221e-19;function M(t){return Math.floor(Math.log(Math.abs(t))/Math.LN10)}function _(t,e,s){return e/s.range*t}function T(t,e){const s=Math.pow(10,e||8);return Math.round(t*s)/s}function P(t){if(1===t)return t;function e(t,s){return t%s==0?s:e(s,t%s)}function s(t){return t*t+1}let i,n=2,r=2;if(t%2==0)return 2;do{n=s(n)%t,r=s(s(r))%t,i=e(Math.abs(n-r),t)}while(1===i);return i}function O(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};for(var e=arguments.length,s=new Array(e>1?e-1:0),i=1;i<e;i++)s[i-1]=arguments[i];for(let e=0;e<s.length;e++){const i=s[e];for(const e in i){const s=i[e];t[e]="object"!=typeof s||null===s||s instanceof Array?s:O(t[e],s)}}return t}const I=t=>t,j=t=>Array.from({length:t});function N(t,e){return null!==t&&"object"==typeof t&&Reflect.has(t,e)}function U(t){return null!==t&&isFinite(t)}function V(t){return!t&&0!==t}function D(t){return U(t)?Number(t):void 0}function B(t){return!!Array.isArray(t)&&t.every(Array.isArray)}function R(t,e){const s=Array.isArray(t)?t[e]:N(t,"data")?t.data[e]:null;return N(s,"meta")?s.meta:void 0}function z(t){return null==t||"number"==typeof t&&isNaN(t)}function F(t){return"object"==typeof t&&null!==t&&(Reflect.has(t,"x")||Reflect.has(t,"y"))}function H(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"y";return F(t)&&N(t,e)?D(t[e]):D(t)}function q(t,e,s){const i={high:void 0===(e={...e,...s?"x"===s?e.axisX:e.axisY:{}}).high?-Number.MAX_VALUE:+e.high,low:void 0===e.low?Number.MAX_VALUE:+e.low},n=void 0===e.high,r=void 0===e.low;return(n||r)&&function t(e){if(!z(e))if(Array.isArray(e))for(let s=0;s<e.length;s++)t(e[s]);else{const t=Number(s&&N(e,s)?e[s]:e);n&&t>i.high&&(i.high=t),r&&t<i.low&&(i.low=t)}}(t),(e.referenceValue||0===e.referenceValue)&&(i.high=Math.max(e.referenceValue,i.high),i.low=Math.min(e.referenceValue,i.low)),i.high<=i.low&&(0===i.low?i.high=1:i.low<0?i.high=0:(i.high>0||(i.high=1),i.low=0)),i}function X(t){let e,s=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=arguments.length>2?arguments[2]:void 0,n=arguments.length>3?arguments[3]:void 0;const r={labels:[],series:W(t.series,i,n)};return e=B(r.series)?Math.max(...r.series.map((t=>t.length))):r.series.length,r.labels=(t.labels||[]).slice(),r.labels.push(...j(Math.max(0,e-r.labels.length)).map((()=>""))),s&&G(r),r}function G(t){var e;null===(e=t.labels)||void 0===e||e.reverse(),t.series.reverse();for(const e of t.series)N(e,"data")?e.data.reverse():Array.isArray(e)&&e.reverse()}function Y(t,e){if(!z(t))return e?function(t,e){let s,i;if("object"!=typeof t){const n=D(t);"x"===e?s=n:i=n}else N(t,"x")&&(s=D(t.x)),N(t,"y")&&(i=D(t.y));if(void 0!==s||void 0!==i)return{x:s,y:i}}(t,e):D(t)}function Z(t,e){return Array.isArray(t)?t.map((t=>N(t,"value")?Y(t.value,e):Y(t,e))):Z(t.data,e)}function W(t,e,s){if(i=t,Array.isArray(i)&&i.every((t=>Array.isArray(t)||N(t,"data"))))return t.map((t=>Z(t,e)));var i;const n=Z(t,e);return s?n.map((t=>[t])):n}function Q(t,e,s){const i={increasingX:!1,fillHoles:!1,...s},n=[];let r=!0;for(let s=0;s<t.length;s+=2)void 0===H(e[s/2].value)?i.fillHoles||(r=!0):(i.increasingX&&s>=2&&t[s]<=t[s-2]&&(r=!0),r&&(n.push({pathCoordinates:[],valueData:[]}),r=!1),n[n.length-1].pathCoordinates.push(t[s],t[s+1]),n[n.length-1].valueData.push(e[s/2]));return n}function J(t){let e="";return null==t?t:(e="number"==typeof t?""+t:"object"==typeof t?JSON.stringify({data:t}):String(t),Object.keys(E).reduce(((t,e)=>t.replaceAll(e,E[e])),e))}class K{call(t,e){return this.svgElements.forEach((s=>Reflect.apply(s[t],s,e))),this}attr(){for(var t=arguments.length,e=new Array(t),s=0;s<t;s++)e[s]=arguments[s];return this.call("attr",e)}elem(){for(var t=arguments.length,e=new Array(t),s=0;s<t;s++)e[s]=arguments[s];return this.call("elem",e)}root(){for(var t=arguments.length,e=new Array(t),s=0;s<t;s++)e[s]=arguments[s];return this.call("root",e)}getNode(){for(var t=arguments.length,e=new Array(t),s=0;s<t;s++)e[s]=arguments[s];return this.call("getNode",e)}foreignObject(){for(var t=arguments.length,e=new Array(t),s=0;s<t;s++)e[s]=arguments[s];return this.call("foreignObject",e)}text(){for(var t=arguments.length,e=new Array(t),s=0;s<t;s++)e[s]=arguments[s];return this.call("text",e)}empty(){for(var t=arguments.length,e=new Array(t),s=0;s<t;s++)e[s]=arguments[s];return this.call("empty",e)}remove(){for(var t=arguments.length,e=new Array(t),s=0;s<t;s++)e[s]=arguments[s];return this.call("remove",e)}addClass(){for(var t=arguments.length,e=new Array(t),s=0;s<t;s++)e[s]=arguments[s];return this.call("addClass",e)}removeClass(){for(var t=arguments.length,e=new Array(t),s=0;s<t;s++)e[s]=arguments[s];return this.call("removeClass",e)}removeAllClasses(){for(var t=arguments.length,e=new Array(t),s=0;s<t;s++)e[s]=arguments[s];return this.call("removeAllClasses",e)}animate(){for(var t=arguments.length,e=new Array(t),s=0;s<t;s++)e[s]=arguments[s];return this.call("animate",e)}constructor(t){this.svgElements=[];for(let e=0;e<t.length;e++)this.svgElements.push(new et(t[e]))}}const $={easeInSine:[.47,0,.745,.715],easeOutSine:[.39,.575,.565,1],easeInOutSine:[.445,.05,.55,.95],easeInQuad:[.55,.085,.68,.53],easeOutQuad:[.25,.46,.45,.94],easeInOutQuad:[.455,.03,.515,.955],easeInCubic:[.55,.055,.675,.19],easeOutCubic:[.215,.61,.355,1],easeInOutCubic:[.645,.045,.355,1],easeInQuart:[.895,.03,.685,.22],easeOutQuart:[.165,.84,.44,1],easeInOutQuart:[.77,0,.175,1],easeInQuint:[.755,.05,.855,.06],easeOutQuint:[.23,1,.32,1],easeInOutQuint:[.86,0,.07,1],easeInExpo:[.95,.05,.795,.035],easeOutExpo:[.19,1,.22,1],easeInOutExpo:[1,0,0,1],easeInCirc:[.6,.04,.98,.335],easeOutCirc:[.075,.82,.165,1],easeInOutCirc:[.785,.135,.15,.86],easeInBack:[.6,-.28,.735,.045],easeOutBack:[.175,.885,.32,1.275],easeInOutBack:[.68,-.55,.265,1.55]};function tt(t,e,s){let i=arguments.length>3&&void 0!==arguments[3]&&arguments[3],n=arguments.length>4?arguments[4]:void 0;const{easing:r,...o}=s,a={};let l,c;r&&(l=Array.isArray(r)?r:$[r]),o.begin=S(o.begin,"ms"),o.dur=S(o.dur,"ms"),l&&(o.calcMode="spline",o.keySplines=l.join(" "),o.keyTimes="0;1"),i&&(o.fill="freeze",a[e]=o.from,t.attr(a),c=L(o.begin||0).value,o.begin="indefinite");const h=t.elem("animate",{attributeName:e,...o});i&&setTimeout((()=>{try{h._node.beginElement()}catch(s){a[e]=o.to,t.attr(a),h.remove()}}),c);const u=h.getNode();n&&u.addEventListener("beginEvent",(()=>n.emit("animationBegin",{element:t,animate:u,params:s}))),u.addEventListener("endEvent",(()=>{n&&n.emit("animationEnd",{element:t,animate:u,params:s}),i&&(a[e]=o.to,t.attr(a),h.remove())}))}class et{attr(t,e){return"string"==typeof t?e?this._node.getAttributeNS(e,t):this._node.getAttribute(t):(Object.keys(t).forEach((e=>{if(void 0!==t[e])if(-1!==e.indexOf(":")){const s=e.split(":");this._node.setAttributeNS(k[s[0]],e,String(t[e]))}else this._node.setAttribute(e,String(t[e]))})),this)}elem(t,e,s){return new et(t,e,s,this,arguments.length>3&&void 0!==arguments[3]&&arguments[3])}parent(){return this._node.parentNode instanceof SVGElement?new et(this._node.parentNode):null}root(){let t=this._node;for(;"svg"!==t.nodeName&&t.parentElement;)t=t.parentElement;return new et(t)}querySelector(t){const e=this._node.querySelector(t);return e?new et(e):null}querySelectorAll(t){const e=this._node.querySelectorAll(t);return new K(e)}getNode(){return this._node}foreignObject(t,e,s){let i,n=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if("string"==typeof t){const e=document.createElement("div");e.innerHTML=t,i=e.firstChild}else i=t;i instanceof Element&&i.setAttribute("xmlns",k.xmlns);const r=this.elem("foreignObject",e,s,n);return r._node.appendChild(i),r}text(t){return this._node.appendChild(document.createTextNode(t)),this}empty(){for(;this._node.firstChild;)this._node.removeChild(this._node.firstChild);return this}remove(){var t;return null===(t=this._node.parentNode)||void 0===t||t.removeChild(this._node),this.parent()}replace(t){var e;return null===(e=this._node.parentNode)||void 0===e||e.replaceChild(t._node,this._node),t}append(t){return arguments.length>1&&void 0!==arguments[1]&&arguments[1]&&this._node.firstChild?this._node.insertBefore(t._node,this._node.firstChild):this._node.appendChild(t._node),this}classes(){const t=this._node.getAttribute("class");return t?t.trim().split(/\s+/):[]}addClass(t){return this._node.setAttribute("class",this.classes().concat(t.trim().split(/\s+/)).filter((function(t,e,s){return s.indexOf(t)===e})).join(" ")),this}removeClass(t){const e=t.trim().split(/\s+/);return this._node.setAttribute("class",this.classes().filter((t=>-1===e.indexOf(t))).join(" ")),this}removeAllClasses(){return this._node.setAttribute("class",""),this}height(){return this._node.getBoundingClientRect().height}width(){return this._node.getBoundingClientRect().width}animate(t){let e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],s=arguments.length>2?arguments[2]:void 0;return Object.keys(t).forEach((i=>{const n=t[i];Array.isArray(n)?n.forEach((t=>tt(this,i,t,!1,s))):tt(this,i,n,e,s)})),this}constructor(t,e,s,i){let n=arguments.length>4&&void 0!==arguments[4]&&arguments[4];t instanceof Element?this._node=t:(this._node=document.createElementNS(k.svg,t),"svg"===t&&this.attr({"xmlns:ct":k.ct})),e&&this.attr(e),s&&this.addClass(s),i&&(n&&i._node.firstChild?i._node.insertBefore(this._node,i._node.firstChild):i._node.appendChild(this._node))}}function st(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"100%",s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"100%",i=arguments.length>3?arguments[3]:void 0;Array.from(t.querySelectorAll("svg")).filter((t=>t.getAttributeNS(k.xmlns,"ct"))).forEach((e=>t.removeChild(e)));const n=new et("svg").attr({width:e,height:s}).attr({style:"width: ".concat(e,"; height: ").concat(s,";")});return i&&n.addClass(i),t.appendChild(n.getNode()),n}function it(t,e){var s,i,n,r;const o=Boolean(e.axisX||e.axisY),a=(null===(s=e.axisY)||void 0===s?void 0:s.offset)||0,l=(null===(i=e.axisX)||void 0===i?void 0:i.offset)||0,c=null===(n=e.axisY)||void 0===n?void 0:n.position,h=null===(r=e.axisX)||void 0===r?void 0:r.position;let u=t.width()||L(e.width).value||0,d=t.height()||L(e.height).value||0;const p="number"==typeof(m=e.chartPadding)?{top:m,right:m,bottom:m,left:m}:void 0===m?{top:0,right:0,bottom:0,left:0}:{top:"number"==typeof m.top?m.top:0,right:"number"==typeof m.right?m.right:0,bottom:"number"==typeof m.bottom?m.bottom:0,left:"number"==typeof m.left?m.left:0};var m;u=Math.max(u,a+p.left+p.right),d=Math.max(d,l+p.top+p.bottom);const g={x1:0,x2:0,y1:0,y2:0,padding:p,width(){return this.x2-this.x1},height(){return this.y1-this.y2}};return o?("start"===h?(g.y2=p.top+l,g.y1=Math.max(d-p.bottom,g.y2+1)):(g.y2=p.top,g.y1=Math.max(d-p.bottom-l,g.y2+1)),"start"===c?(g.x1=p.left+a,g.x2=Math.max(u-p.right,g.x1+1)):(g.x1=p.left,g.x2=Math.max(u-p.right-a,g.x1+1))):(g.x1=p.left,g.x2=Math.max(u-p.right,g.x1+1),g.y2=p.top,g.y1=Math.max(d-p.bottom,g.y2+1)),g}function nt(t,e,s,i){const n=t.elem("rect",{x:e.x1,y:e.y2,width:e.width(),height:e.height()},s,!0);i.emit("draw",{type:"gridBackground",group:t,element:n})}function rt(t,e,s){let i;const n=[];function r(n){const r=i;i=O({},t),e&&e.forEach((t=>{window.matchMedia(t[0]).matches&&(i=O(i,t[1]))})),s&&n&&s.emit("optionsChanged",{previousOptions:r,currentOptions:i})}if(!window.matchMedia)throw new Error("window.matchMedia not found! Make sure you're using a polyfill.");return e&&e.forEach((t=>{const e=window.matchMedia(t[0]);e.addEventListener("change",r),n.push(e)})),r(),{removeMediaQueryListeners:function(){n.forEach((t=>t.removeEventListener("change",r)))},getCurrentOptions(){return i}}}et.Easing=$;const ot={m:["x","y"],l:["x","y"],c:["x1","y1","x2","y2","x","y"],a:["rx","ry","xAr","lAf","sf","x","y"]},at={accuracy:3};function lt(t,e,s,i,n,r){const o={command:n?t.toLowerCase():t.toUpperCase(),...e,...r?{data:r}:{}};s.splice(i,0,o)}function ct(t,e){t.forEach(((s,i)=>{ot[s.command.toLowerCase()].forEach(((n,r)=>{e(s,n,i,r,t)}))}))}class ht{static join(t){const e=new ht(arguments.length>1&&void 0!==arguments[1]&&arguments[1],arguments.length>2?arguments[2]:void 0);for(let s=0;s<t.length;s++){const i=t[s];for(let t=0;t<i.pathElements.length;t++)e.pathElements.push(i.pathElements[t])}return e}position(t){return void 0!==t?(this.pos=Math.max(0,Math.min(this.pathElements.length,t)),this):this.pos}remove(t){return this.pathElements.splice(this.pos,t),this}move(t,e){let s=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=arguments.length>3?arguments[3]:void 0;return lt("M",{x:+t,y:+e},this.pathElements,this.pos++,s,i),this}line(t,e){let s=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=arguments.length>3?arguments[3]:void 0;return lt("L",{x:+t,y:+e},this.pathElements,this.pos++,s,i),this}curve(t,e,s,i,n,r){let o=arguments.length>6&&void 0!==arguments[6]&&arguments[6],a=arguments.length>7?arguments[7]:void 0;return lt("C",{x1:+t,y1:+e,x2:+s,y2:+i,x:+n,y:+r},this.pathElements,this.pos++,o,a),this}arc(t,e,s,i,n,r,o){let a=arguments.length>7&&void 0!==arguments[7]&&arguments[7],l=arguments.length>8?arguments[8]:void 0;return lt("A",{rx:t,ry:e,xAr:s,lAf:i,sf:n,x:r,y:o},this.pathElements,this.pos++,a,l),this}parse(t){const e=t.replace(/([A-Za-z])([0-9])/g,"$1 $2").replace(/([0-9])([A-Za-z])/g,"$1 $2").split(/[\s,]+/).reduce(((t,e)=>(e.match(/[A-Za-z]/)&&t.push([]),t[t.length-1].push(e),t)),[]);"Z"===e[e.length-1][0].toUpperCase()&&e.pop();const s=e.map((t=>{const e=t.shift(),s=ot[e.toLowerCase()];return{command:e,...s.reduce(((e,s,i)=>(e[s]=+t[i],e)),{})}}));return this.pathElements.splice(this.pos,0,...s),this.pos+=s.length,this}stringify(){const t=Math.pow(10,this.options.accuracy);return this.pathElements.reduce(((e,s)=>{const i=ot[s.command.toLowerCase()].map((e=>{const i=s[e];return this.options.accuracy?Math.round(i*t)/t:i}));return e+s.command+i.join(",")}),"")+(this.close?"Z":"")}scale(t,e){return ct(this.pathElements,((s,i)=>{s[i]*="x"===i[0]?t:e})),this}translate(t,e){return ct(this.pathElements,((s,i)=>{s[i]+="x"===i[0]?t:e})),this}transform(t){return ct(this.pathElements,((e,s,i,n,r)=>{const o=t(e,s,i,n,r);(o||0===o)&&(e[s]=o)})),this}clone(){const t=new ht(arguments.length>0&&void 0!==arguments[0]&&arguments[0]||this.close);return t.pos=this.pos,t.pathElements=this.pathElements.slice().map((t=>({...t}))),t.options={...this.options},t}splitByCommand(t){const e=[new ht];return this.pathElements.forEach((s=>{s.command===t.toUpperCase()&&0!==e[e.length-1].pathElements.length&&e.push(new ht),e[e.length-1].pathElements.push(s)})),e}constructor(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=arguments.length>1?arguments[1]:void 0;this.close=t,this.pathElements=[],this.pos=0,this.options={...at,...e}}}function ut(t){const e={fillHoles:!1,...t};return function(t,s){const i=new ht;let n=!0;for(let r=0;r<t.length;r+=2){const o=t[r],a=t[r+1],l=s[r/2];void 0!==H(l.value)?(n?i.move(o,a,!1,l):i.line(o,a,!1,l),n=!1):e.fillHoles||(n=!0)}return i}}function dt(t){const e={fillHoles:!1,...t};return function t(s,i){const n=Q(s,i,{fillHoles:e.fillHoles,increasingX:!0});if(n.length){if(n.length>1)return ht.join(n.map((e=>t(e.pathCoordinates,e.valueData))));{if(s=n[0].pathCoordinates,i=n[0].valueData,s.length<=4)return ut()(s,i);const t=[],e=[],r=s.length/2,o=[],a=[],l=[],c=[];for(let i=0;i<r;i++)t[i]=s[2*i],e[i]=s[2*i+1];for(let s=0;s<r-1;s++)l[s]=e[s+1]-e[s],c[s]=t[s+1]-t[s],a[s]=l[s]/c[s];o[0]=a[0],o[r-1]=a[r-2];for(let t=1;t<r-1;t++)0===a[t]||0===a[t-1]||a[t-1]>0!=a[t]>0?o[t]=0:(o[t]=3*(c[t-1]+c[t])/((2*c[t]+c[t-1])/a[t-1]+(c[t]+2*c[t-1])/a[t]),isFinite(o[t])||(o[t]=0));const h=(new ht).move(t[0],e[0],!1,i[0]);for(let s=0;s<r-1;s++)h.curve(t[s]+c[s]/3,e[s]+o[s]*c[s]/3,t[s+1]-c[s]/3,e[s+1]-o[s+1]*c[s]/3,t[s+1],e[s+1],!1,i[s+1]);return h}}return ut()([],[])}}class pt{on(t,e){const{allListeners:s,listeners:i}=this;"*"===t?s.add(e):(i.has(t)||i.set(t,new Set),i.get(t).add(e))}off(t,e){const{allListeners:s,listeners:i}=this;if("*"===t)e?s.delete(e):s.clear();else if(i.has(t)){const s=i.get(t);e?s.delete(e):s.clear(),s.size||i.delete(t)}}emit(t,e){const{allListeners:s,listeners:i}=this;i.has(t)&&i.get(t).forEach((t=>t(e))),s.forEach((s=>s(t,e)))}constructor(){this.listeners=new Map,this.allListeners=new Set}}const mt=new WeakMap;class gt{update(t,e){let s=arguments.length>2&&void 0!==arguments[2]&&arguments[2];var i;(t&&(this.data=t||{},this.data.labels=this.data.labels||[],this.data.series=this.data.series||[],this.eventEmitter.emit("data",{type:"update",data:this.data})),e)&&(this.options=O({},s?this.options:this.defaultOptions,e),this.initializeTimeoutId||(null===(i=this.optionsProvider)||void 0===i||i.removeMediaQueryListeners(),this.optionsProvider=rt(this.options,this.responsiveOptions,this.eventEmitter)));return!this.initializeTimeoutId&&this.optionsProvider&&this.createChart(this.optionsProvider.getCurrentOptions()),this}detach(){var t;this.initializeTimeoutId?window.clearTimeout(this.initializeTimeoutId):(window.removeEventListener("resize",this.resizeListener),null===(t=this.optionsProvider)||void 0===t||t.removeMediaQueryListeners());return mt.delete(this.container),this}on(t,e){return this.eventEmitter.on(t,e),this}off(t,e){return this.eventEmitter.off(t,e),this}initialize(){window.addEventListener("resize",this.resizeListener),this.optionsProvider=rt(this.options,this.responsiveOptions,this.eventEmitter),this.eventEmitter.on("optionsChanged",(()=>this.update())),this.options.plugins&&this.options.plugins.forEach((t=>{Array.isArray(t)?t[0](this,t[1]):t(this)})),this.eventEmitter.emit("data",{type:"initial",data:this.data}),this.createChart(this.optionsProvider.getCurrentOptions()),this.initializeTimeoutId=null}constructor(t,e,s,i,n){this.data=e,this.defaultOptions=s,this.options=i,this.responsiveOptions=n,this.eventEmitter=new pt,this.resizeListener=()=>this.update(),this.initializeTimeoutId=setTimeout((()=>this.initialize()),0);const r="string"==typeof t?document.querySelector(t):t;if(!r)throw new Error("Target element is not found");this.container=r;const o=mt.get(r);o&&o.detach(),mt.set(r,this)}}const ft={x:{pos:"x",len:"width",dir:"horizontal",rectStart:"x1",rectEnd:"x2",rectOffset:"y2"},y:{pos:"y",len:"height",dir:"vertical",rectStart:"y2",rectEnd:"y1",rectOffset:"x1"}};class vt{createGridAndLabels(t,e,s,i){const n="x"===this.units.pos?s.axisX:s.axisY,r=this.ticks.map(((t,e)=>this.projectValue(t,e))),o=this.ticks.map(n.labelInterpolationFnc);r.forEach(((a,l)=>{const c=o[l],h={x:0,y:0};let u;u=r[l+1]?r[l+1]-a:Math.max(this.axisLength-a,30),""!==c&&V(c)||("x"===this.units.pos?(a=this.chartRect.x1+a,h.x=s.axisX.labelOffset.x,"start"===s.axisX.position?h.y=this.chartRect.padding.top+s.axisX.labelOffset.y+5:h.y=this.chartRect.y1+s.axisX.labelOffset.y+5):(a=this.chartRect.y1-a,h.y=s.axisY.labelOffset.y-u,"start"===s.axisY.position?h.x=this.chartRect.padding.left+s.axisY.labelOffset.x:h.x=this.chartRect.x2+s.axisY.labelOffset.x+10),n.showGrid&&function(t,e,s,i,n,r,o,a){const l={["".concat(s.units.pos,"1")]:t,["".concat(s.units.pos,"2")]:t,["".concat(s.counterUnits.pos,"1")]:i,["".concat(s.counterUnits.pos,"2")]:i+n},c=r.elem("line",l,o.join(" "));a.emit("draw",{type:"grid",axis:s,index:e,group:r,element:c,...l})}(a,l,this,this.gridOffset,this.chartRect[this.counterUnits.len](),t,[s.classNames.grid,s.classNames[this.units.dir]],i),n.showLabel&&function(t,e,s,i,n,r,o,a,l,c){const h={[n.units.pos]:t+o[n.units.pos],[n.counterUnits.pos]:o[n.counterUnits.pos],[n.units.len]:e,[n.counterUnits.len]:Math.max(0,r-10)},u=Math.round(h[n.units.len]),d=Math.round(h[n.counterUnits.len]),p=document.createElement("span");p.className=l.join(" "),p.style[n.units.len]=u+"px",p.style[n.counterUnits.len]=d+"px",p.textContent=String(i);const m=a.foreignObject(p,{style:"overflow: visible;",...h});c.emit("draw",{type:"label",axis:n,index:s,group:a,element:m,text:i,...h})}(a,u,l,c,this,n.offset,h,e,[s.classNames.label,s.classNames[this.units.dir],"start"===n.position?s.classNames[n.position]:s.classNames.end],i))}))}constructor(t,e,s){this.units=t,this.chartRect=e,this.ticks=s,this.counterUnits=t===ft.x?ft.y:ft.x,this.axisLength=e[this.units.rectEnd]-e[this.units.rectStart],this.gridOffset=e[this.units.rectOffset]}}class yt extends vt{projectValue(t){const e=Number(H(t,this.units.pos));return this.axisLength*(e-this.bounds.min)/this.bounds.range}constructor(t,e,s,i){const n=i.highLow||q(e,i,t.pos),r=function(t,e,s){let i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const n={high:e.high,low:e.low,valueRange:0,oom:0,step:0,min:0,max:0,range:0,numberOfSteps:0,values:[]};n.valueRange=n.high-n.low,n.oom=M(n.valueRange),n.step=Math.pow(10,n.oom),n.min=Math.floor(n.low/n.step)*n.step,n.max=Math.ceil(n.high/n.step)*n.step,n.range=n.max-n.min,n.numberOfSteps=Math.round(n.range/n.step);const r=_(t,n.step,n)<s,o=i?P(n.range):0;if(i&&_(t,1,n)>=s)n.step=1;else if(i&&o<n.step&&_(t,o,n)>=s)n.step=o;else{let e=0;for(;;){if(r&&_(t,n.step,n)<=s)n.step*=2;else{if(r||!(_(t,n.step/2,n)>=s))break;if(n.step/=2,i&&n.step%1!=0){n.step*=2;break}}if(e++>1e3)throw new Error("Exceeded maximum number of iterations while optimizing scale step!")}}function a(t,e){return t===(t+=e)&&(t*=1+(e>0?C:-C)),t}n.step=Math.max(n.step,C);let l=n.min,c=n.max;for(;l+n.step<=n.low;)l=a(l,n.step);for(;c-n.step>=n.high;)c=a(c,-n.step);n.min=l,n.max=c,n.range=n.max-n.min;const h=[];for(let t=n.min;t<=n.max;t=a(t,n.step)){const e=T(t);e!==h[h.length-1]&&h.push(e)}return n.values=h,n}(s[t.rectEnd]-s[t.rectStart],n,i.scaleMinSpace||20,i.onlyInteger),o={min:r.min,max:r.max};super(t,s,r.values),this.bounds=r,this.range=o}}class bt extends vt{projectValue(t,e){return this.stepLength*e}constructor(t,e,s,i){const n=i.ticks||[];super(t,s,n);const r=Math.max(1,n.length-(i.stretch?1:0));this.stepLength=this.axisLength/r,this.stretch=Boolean(i.stretch)}}function xt(t,e,s){var i;if(N(t,"name")&&t.name&&(null===(i=e.series)||void 0===i?void 0:i[t.name])){const i=(null==e?void 0:e.series[t.name])[s];return void 0===i?e[s]:i}return e[s]}const wt={axisX:{offset:30,position:"end",labelOffset:{x:0,y:0},showLabel:!0,showGrid:!0,labelInterpolationFnc:I,type:void 0},axisY:{offset:40,position:"start",labelOffset:{x:0,y:0},showLabel:!0,showGrid:!0,labelInterpolationFnc:I,type:void 0,scaleMinSpace:20,onlyInteger:!1},width:void 0,height:void 0,showLine:!0,showPoint:!0,showArea:!1,areaBase:0,lineSmooth:!0,showGridBackground:!1,low:void 0,high:void 0,chartPadding:{top:15,right:15,bottom:5,left:10},fullWidth:!1,reverseData:!1,classNames:{chart:"ct-chart-line",label:"ct-label",labelGroup:"ct-labels",series:"ct-series",line:"ct-line",point:"ct-point",area:"ct-area",grid:"ct-grid",gridGroup:"ct-grids",gridBackground:"ct-grid-background",vertical:"ct-vertical",horizontal:"ct-horizontal",start:"ct-start",end:"ct-end"}};class kt extends gt{createChart(t){const{data:e}=this,s=X(e,t.reverseData,!0),i=st(this.container,t.width,t.height,t.classNames.chart);this.svg=i;const n=i.elem("g").addClass(t.classNames.gridGroup),r=i.elem("g"),o=i.elem("g").addClass(t.classNames.labelGroup),a=it(i,t);let l,c;l=void 0===t.axisX.type?new bt(ft.x,s.series,a,{...t.axisX,ticks:s.labels,stretch:t.fullWidth}):new t.axisX.type(ft.x,s.series,a,t.axisX),c=void 0===t.axisY.type?new yt(ft.y,s.series,a,{...t.axisY,high:U(t.high)?t.high:t.axisY.high,low:U(t.low)?t.low:t.axisY.low}):new t.axisY.type(ft.y,s.series,a,t.axisY),l.createGridAndLabels(n,o,t,this.eventEmitter),c.createGridAndLabels(n,o,t,this.eventEmitter),t.showGridBackground&&nt(n,a,t.classNames.gridBackground,this.eventEmitter),e.series.forEach(((e,i)=>{const n=r.elem("g"),o=N(e,"name")&&e.name,h=N(e,"className")&&e.className,u=N(e,"meta")?e.meta:void 0;o&&n.attr({"ct:series-name":o}),u&&n.attr({"ct:meta":J(u)}),n.addClass([t.classNames.series,h||"".concat(t.classNames.series,"-").concat(A(i))].join(" "));const d=[],p=[];s.series[i].forEach(((t,n)=>{const r={x:a.x1+l.projectValue(t,n,s.series[i]),y:a.y1-c.projectValue(t,n,s.series[i])};d.push(r.x,r.y),p.push({value:t,valueIndex:n,meta:R(e,n)})}));const m={lineSmooth:xt(e,t,"lineSmooth"),showPoint:xt(e,t,"showPoint"),showLine:xt(e,t,"showLine"),showArea:xt(e,t,"showArea"),areaBase:xt(e,t,"areaBase")};let g;g="function"==typeof m.lineSmooth?m.lineSmooth:m.lineSmooth?dt():ut();const f=g(d,p);if(m.showPoint&&f.pathElements.forEach((s=>{const{data:r}=s,o=n.elem("line",{x1:s.x,y1:s.y,x2:s.x+.01,y2:s.y},t.classNames.point);if(r){let t,e;N(r.value,"x")&&(t=r.value.x),N(r.value,"y")&&(e=r.value.y),o.attr({"ct:value":[t,e].filter(U).join(","),"ct:meta":J(r.meta)})}this.eventEmitter.emit("draw",{type:"point",value:null==r?void 0:r.value,index:(null==r?void 0:r.valueIndex)||0,meta:null==r?void 0:r.meta,series:e,seriesIndex:i,axisX:l,axisY:c,group:n,element:o,x:s.x,y:s.y,chartRect:a})})),m.showLine){const r=n.elem("path",{d:f.stringify()},t.classNames.line,!0);this.eventEmitter.emit("draw",{type:"line",values:s.series[i],path:f.clone(),chartRect:a,index:i,series:e,seriesIndex:i,meta:u,axisX:l,axisY:c,group:n,element:r})}if(m.showArea&&c.range){const r=Math.max(Math.min(m.areaBase,c.range.max),c.range.min),o=a.y1-c.projectValue(r);f.splitByCommand("M").filter((t=>t.pathElements.length>1)).map((t=>{const e=t.pathElements[0],s=t.pathElements[t.pathElements.length-1];return t.clone(!0).position(0).remove(1).move(e.x,o).line(e.x,e.y).position(t.pathElements.length+1).line(s.x,o)})).forEach((r=>{const o=n.elem("path",{d:r.stringify()},t.classNames.area,!0);this.eventEmitter.emit("draw",{type:"area",values:s.series[i],path:r.clone(),series:e,seriesIndex:i,axisX:l,axisY:c,chartRect:a,index:i,group:n,element:o,meta:u})}))}})),this.eventEmitter.emit("created",{chartRect:a,axisX:l,axisY:c,svg:i,options:t})}constructor(t,e,s,i){super(t,e,wt,O({},wt,s),i),this.data=e}}class Et{constructor(t){this._model=t,this.root=document}get model(){return this._model}bindAll(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:document;this.root=t;for(const t in this._model)this._model.hasOwnProperty(t)&&this.bind(t)}bind(t){const e="bind";this.root.querySelectorAll("[data-".concat(e,"]")).forEach((e=>{e.dataset.bind===t&&(e instanceof HTMLInputElement||e instanceof HTMLSelectElement||e instanceof HTMLTextAreaElement?this.onChangeBind(e,t):e instanceof HTMLAnchorElement||e instanceof HTMLButtonElement?this.onClickBind(e,t):this.viewUpdateBind(e,t))}))}onClickBind(t,e){t.addEventListener("click",(t=>{if("function"!=typeof this._model[e])throw new Error("Property ".concat(e," is not a callback"));this._model[e](t),t.preventDefault()}))}onChangeBind(t,e){let s="value",n=t=>t;"checkbox"===t.type&&(s="checked",n=t=>!!t),t.addEventListener("change",(()=>{this._model[e]=t[s]})),i.observe(this.model,e,(e=>{e=n(e),t[s]!==e&&(t[s]=e)}))}viewUpdateBind(t,e){i.observe(this.model,e,(e=>{t.innerHTML!==e&&(t.innerHTML=e)}))}onChanged(t,e){i.observe(this.model,t,e)}unsubscribe(t,e){i.unobserve(this.model,t,e)}getBoundElement(t){return this.root.querySelector("[data-bind='".concat(t,"']"))}}var St=n(5826),Lt=n.n(St);class At extends Et{constructor(t){super({pointSelected:null,chartVisible:!1,buttonVisible:!1,onChartToggle:null,onMenuToggle:null}),this.state=t,this.data=[],this.chart=null,this.chartPoints=null,this.chartElement=document.querySelector("#chart"),this.chartContainer=this.chartElement.parentElement,this.buttonElement=document.querySelector("#altitudes")}init(){return this.chartSetup(),this.setObservers(),this.bindAll(),this}chartSetup(){a.addCss("css/dist/chartist.css","chartist_css"),this.chart=new kt(this.chartElement,{series:[this.data]},{lineSmooth:!0,showArea:!0,axisX:{type:yt,onlyInteger:!0,showLabel:!1},plugins:[Lt()({axisY:{axisTitle:"".concat(x._("altitude")," (").concat(x.unit("unitDistance")," ").concat(x.unit("unitAltitude"),")"),axisClass:"ct-axis-title",offset:{x:0,y:11},textAnchor:"middle",flipTitle:!0}})]}),this.chart.on("created",(()=>this.onCreated()))}onCreated(){if(this.data.length&&this.data.length<=1e3){this.chartPoints=document.querySelectorAll(".ct-series .ct-point");const t=this.chartPoints.length;for(let e=0;e<t;e++)this.chartPoints[e].addEventListener("click",(()=>{this.model.pointSelected=e}))}}setObservers(){this.state.onChanged("currentTrack",(t=>{t&&i.observe(t,"positions",(()=>{this.onTrackUpdate(t,!0)})),this.onTrackUpdate(t)})),this.onChanged("buttonVisible",(t=>this.renderButton(t))),this.onChanged("chartVisible",(t=>this.renderContainer(t))),this.model.onChartToggle=()=>{this.model.chartVisible=!this.model.chartVisible},this.model.onMenuToggle=()=>{this.model.chartVisible&&this.chart.update()}}onTrackUpdate(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.render(t,e),this.model.buttonVisible=!!t&&t.hasPlotData}renderContainer(t){t?(this.chartContainer.style.display="block",this.render(this.state.currentTrack)):this.chartContainer.style.display="none"}renderButton(t){t?this.buttonElement.classList.remove("menu-hidden"):this.buttonElement.classList.add("menu-hidden")}render(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],s=[];if(t&&t.hasPlotData&&this.model.chartVisible?s=t.plotData:this.model.chartVisible=!1,e||this.data!==s){"Chart".concat(e?" forced":""," update (").concat(s.length,")"),this.data=s;const t={lineSmooth:s.length<=1e3};this.chart.update({series:[s]},t,!0)}}pointAddClass(t,e){if(this.model.chartVisible&&this.chartPoints.length>t){this.chartPoints[t].classList.add(e)}}pointsRemoveClass(t){this.model.chartVisible&&this.chartPoints&&this.chartPoints.forEach((e=>e.classList.remove(t)))}onPointOver(t){this.pointAddClass(t,"ct-point-hilight")}onPointOut(){this.pointsRemoveClass("ct-point-hilight")}onPointSelect(t){this.pointAddClass(t,"ct-point-selected")}onPointUnselect(){this.pointsRemoveClass("ct-point-selected")}}class Ct{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.autoClose=e.autoClose||0,this.hasButton=void 0!==e.hasButton?e.hasButton:0===this.autoClose,this.fixedPosition=e.fixed||!1;const s='<div class="alert"><span>'.concat(t,"</span></div>");if(this.box=a.nodeFromHtml(s),e.id&&(this.box.id=e.id),e.class&&this.box.classList.add(e.class),this.hasButton){const t=document.createElement("button");t.setAttribute("type","button"),t.textContent="×",t.onclick=()=>this.destroy(),this.box.appendChild(t)}this.closeHandle=null}static getPosition(){const t=document.querySelectorAll(".alert"),e=t[t.length-1];let s=0;if(e){const t=document.body.clientHeight-100;s=e.getBoundingClientRect().bottom,s>t&&(s=t)}return s}render(){if(!this.fixedPosition){const t=Ct.getPosition();t&&(this.box.style.top="".concat(t,"px"))}document.body.appendChild(this.box),setTimeout((()=>{this.box&&this.box.classList.add("in")}),50)}destroy(){if(this.closeHandle&&(clearTimeout(this.closeHandle),this.closeHandle=null),this.box&&document.body.contains(this.box)){const t=this.box;requestAnimationFrame((()=>{t.classList.add("out"),setTimeout((()=>{t.remove()}),1e3)})),this.box=null}}static show(t,e){const s=new Ct(t,e);return s.render(),s.autoClose&&(s.closeHandle=setTimeout((()=>s.destroy()),s.autoClose)),s}static error(t,e){return e instanceof Error&&console.error("".concat(e.name,": ").concat(e.message," (").concat(e.stack,")")),this.show(t,{class:"error"})}static toast(t){return this.show(t,{class:"toast",autoClose:1e4})}static spinner(){return this.show("",{class:"spinner",hasButton:!1,fixed:!0})}}class Mt{constructor(t){const e=document.createElement("div");e.setAttribute("id","modal");const s=document.createElement("div");s.setAttribute("id","modal-header");const i=document.createElement("button");i.setAttribute("id","modal-close"),i.setAttribute("type","button"),i.setAttribute("class","button-reject"),i.setAttribute("data-bind","onCancel");const n=document.createElement("img");n.setAttribute("src","images/close.svg"),n.setAttribute("alt",x._("close")),i.append(n),s.append(i);const r=document.createElement("div");if(r.setAttribute("id","modal-body"),"string"==typeof t)r.innerHTML=t;else if(t instanceof NodeList||t instanceof Array)for(const e of t)r.append(e);else r.append(t);r.prepend(s),e.append(r),this.element=e,this.visible=!1}show(){this.visible||(document.body.append(this.element),this.visible=!0,this.autofocus())}autofocus(){const t=this.element.querySelector("[autofocus]");t&&t.focus()}destroy(){document.body.removeChild(this.element),this.visible=!1}static isConfirmed(t){return confirm(t)}}class _t extends Et{constructor(){super({colorExtra:b.colorExtra,colorHilite:b.colorHilite,colorNormal:b.colorNormal,colorStart:b.colorStart,colorStop:b.colorStop,googleKey:b.googleKey,initLatitude:b.initLatitude,initLongitude:b.initLongitude,interval:b.interval,lang:b.lang,layerId:0,layerName:null,layers:new m(new p(0,"OpenStreetMap","",0),...b.olLayers),layerUrl:null,mapApi:b.mapApi,passLenMin:b.passLenMin,passStrength:b.passStrength,publicTracks:b.publicTracks,requireAuth:b.requireAuth,strokeColor:b.strokeColor,strokeOpacity:b.strokeOpacity,strokeWeight:b.strokeWeight,units:b.units,uploadMaxSize:b.uploadMaxSize,uploadMaxSizeMB:b.uploadMaxSize/1024/1024}),this.model.onCancel=()=>this.onCancel(),this.model.onSave=()=>this.onSave(),this.model.onLayerUpdate=()=>this.onLayerUpdate(),this.model.onLayerCancel=()=>this.onLayerCancel(),this.model.onLayerEdit=()=>this.onLayerEdit(),this.model.onLayerDelete=()=>this.onLayerDelete(),this.model.onLayerAdd=()=>this.onLayerAdd()}init(){const t=this.getHtml();this.dialog=new Mt(t),this.dialog.show(),this.bindAll(this.dialog.element),this.toggleEditEl=this.getBoundElement("onLayerEdit").parentNode,this.layerEditEl=this.getBoundElement("layerName").parentNode,this.layerSelect=new r(this.getBoundElement("layerId")),this.setPublicTracksActivity(this.model.requireAuth),this.toggleEditVisible(),this.onChanged("layerId",(t=>{const e=this.model.layers.get(parseInt(t));this.model.layerName=e?e.name:"",this.model.layerUrl=e?e.url:"",this.toggleEditVisible()})),this.model.layerId=b.olLayers.getPriorityLayer().toString(),this.onChanged("uploadMaxSizeMB",(t=>{this.model.uploadMaxSize=1024*t*1024})),this.onChanged("layers",(t=>this.layerSelect.setOptions(t))),this.onChanged("requireAuth",(t=>{this.setPublicTracksActivity(t)}))}setPublicTracksActivity(t){t?this.getBoundElement("publicTracks").disabled=!1:(this.model.publicTracks=!0,this.getBoundElement("publicTracks").disabled=!0)}onCancel(){this.dialog.destroy()}onSave(){this.validate()&&(this.model.layers.setPriorityLayer(parseInt(this.model.layerId)),b.save(this.model).then((()=>this.dialog.destroy())).catch((t=>{Ct.error("".concat(x._("actionfailure"),"\n").concat(t.message),t)})))}validate(){return this.dialog.element.querySelector("form").checkValidity()}toggleEditVisible(){parseInt(this.model.layerId)>0?this.toggleEditEl.style.visibility="visible":(this.toggleEditEl.style.visibility="hidden",this.hideEditElement())}onLayerDelete(){this.model.layers.delete(parseInt(this.model.layerId)),this.model.layerId="0"}onLayerEdit(){"none"===this.layerEditEl.style.display?this.showEditElement():this.hideEditElement()}onLayerUpdate(){if(this.model.layerName&&this.model.layerUrl){if("-1"===this.model.layerId)this.model.layers.addNewLayer(this.model.layerName,this.model.layerUrl);else{const t=this.currentLayer();t.setName(this.model.layerName),t.setUrl(this.model.layerUrl)}this.hideEditElement(),this.layerSelect.setOptions(this.model.layers)}}onLayerCancel(){this.hideEditElement(),this.layerSelect.setOptions(this.model.layers)}onLayerAdd(){this.model.layerId="-1",this.onLayerEdit()}hideEditElement(){this.layerEditEl.style.display="none"}showEditElement(){this.layerEditEl.style.display="block"}currentLayer(){return this.model.layers.get(parseInt(this.model.layerId))}getHtml(){let t="";for(const[e,s]of Object.entries(x.getLangList()))t+='<option value="'.concat(e,'"').concat(this.model.lang===e?" selected":"",">").concat(s,"</option>");let e="";for(const t of["metric","imperial","nautical"])e+='<option value="'.concat(t,'"').concat(this.model.units===t?" selected":"",">").concat(x._(t),"</option>");let s="";for(const t of this.model.layers)s+='<option value="'.concat(t.id,'"').concat(t.priority>0?" selected":"",">").concat(t.name,"</option>");return'<div><img style="vertical-align: bottom; margin-right: 10px;" src="images/settings.svg" alt="'.concat(x._("settings"),'"> <b>').concat(x._("editingconfig"),'</b></div>\n      <div style="clear: both; padding-bottom: 1em;"></div>\n      <form id="config-form">\n        <label><b>').concat(x._("language"),'</b>\n        <select data-bind="lang">\n          ').concat(t,"\n        </select></label>\n        <label><b>").concat(x._("units"),'</b>\n        <select data-bind="units">\n          ').concat(e,"\n        </select></label>\n        <label><b>").concat(x._("api"),'</b>\n        <select data-bind="mapApi">\n          <option value="openlayers"').concat("openlayers"===this.model.mapApi?" selected":"",'>OpenLayers</option>\n          <option value="gmaps"').concat("gmaps"===this.model.mapApi?" selected":"",">Google Maps</option>\n        </select></label>\n        <label><b>").concat(x._("ollayers"),'</b>\n        <select data-bind="layerId">\n          ').concat(s,'\n        </select>\n        <a data-bind="onLayerAdd"><img src="images/add.svg" alt="').concat(x._("add"),'"></a> \n        <span style="visibility: hidden;">\n        <a data-bind="onLayerEdit"><img src="images/edit.svg" alt="').concat(x._("edit"),'"></a> \n        <a data-bind="onLayerDelete"><img src="images/delete.svg" alt="').concat(x._("delete"),'"></a>\n        </span></label>\n        <div style="display: none; text-align: center;">\n          <input type="text" maxlength="50" placeholder="').concat(x._("layername"),'" data-bind="layerName">\n          <input type="text" maxlength="255" placeholder="').concat(x._("layerurl"),'" data-bind="layerUrl">\n          <button class="button-resolve" data-bind="onLayerUpdate" type="submit">').concat(x._("submit"),'</button>\n          <button class="button-reject" data-bind="onLayerCancel" type="button">').concat(x._("cancel"),"</button>\n        </div>\n        <label><b>").concat(x._("interval"),'</b>\n        <input type="number" data-bind="interval" min="1" value="').concat(this.model.interval,'" required></label>\n        <label><b>').concat(x._("longitude"),'</b>\n        <input type="number" data-bind="initLongitude" min="-180" max="180" step="0.01" value="').concat(this.model.initLongitude,'" required></label>\n        <label><b>').concat(x._("latitude"),'</b>\n        <input type="number" data-bind="initLatitude" min="-90" max="90" step="0.01" value="').concat(this.model.initLatitude,'" required></label>\n        <label><b>').concat(x._("googlekey"),'</b>\n        <input type="text" data-bind="googleKey" value="').concat(this.model.googleKey,'"></label>\n        <label><b>').concat(x._("passlength"),'</b>\n        <input type="number" data-bind="passLenMin" min="1" value="').concat(this.model.passLenMin,'" required></label>\n        <label><b>').concat(x._("passstrength"),'</b>\n        <select data-bind="passStrength">\n          <option value="0"').concat(0===this.model.passStrength?" selected":"",'>password</option>\n          <option value="1"').concat(1===this.model.passStrength?" selected":"",'>paSsword</option>\n          <option value="2"').concat(2===this.model.passStrength?" selected":"",'>paSsword1</option>\n          <option value="3"').concat(3===this.model.passStrength?" selected":"",">paSsword1#</option>\n        </select></label>\n        <label><b>").concat(x._("uploadmaxsize"),'</b>\n        <input type="number" data-bind="uploadMaxSizeMB" min="1" value="').concat(this.model.uploadMaxSizeMB,'" required></label>\n        <label><b>').concat(x._("requireauth"),'</b>\n        <input type="checkbox" data-bind="requireAuth"').concat(this.model.requireAuth?" checked":"","></label>\n        <label><b>").concat(x._("publictracks"),'</b>\n        <input type="checkbox" data-bind="publicTracks"').concat(this.model.publicTracks?" checked":"","></label>\n        <label><b>").concat(x._("strokeweight"),'</b>\n        <input type="number" data-bind="strokeWeight" min="1" value="').concat(this.model.strokeWeight,'" required></label>\n        <label><b>').concat(x._("strokeopacity"),'</b>\n        <input type="number" data-bind="strokeOpacity" min="0" max="1" step="0.01" value="').concat(this.model.strokeOpacity,'" required></label>\n        <label><b>').concat(x._("strokecolor"),'</b>\n        <input type="color" data-bind="strokeColor" pattern="#[0-9a-f]{6}" maxlength="7" value="').concat(this.model.strokeColor,'" required></label>\n        <label><b>').concat(x._("colornormal"),'</b>\n        <input type="color" data-bind="colorNormal" pattern="#[0-9a-f]{6}" maxlength="7" value="').concat(this.model.colorNormal,'" required></label>\n        <label><b>').concat(x._("colorstart"),'</b>\n        <input type="color" data-bind="colorStart" pattern="#[0-9a-f]{6}" maxlength="7" value="').concat(this.model.colorStart,'" required></label>\n        <label><b>').concat(x._("colorstop"),'</b>\n        <input type="color" data-bind="colorStop" pattern="#[0-9a-f]{6}" maxlength="7" value="').concat(this.model.colorStop,'" required></label>\n        <label><b>').concat(x._("colorextra"),'</b>\n        <input type="color" data-bind="colorExtra" pattern="#[0-9a-f]{6}" maxlength="7" value="').concat(this.model.colorExtra,'" required></label>\n        <label><b>').concat(x._("colorhilite"),'</b>\n        <input type="color" data-bind="colorHilite" pattern="#[0-9a-f]{6}" maxlength="7" value="').concat(this.model.colorHilite,'" required></label>\n        <div class="buttons">\n          <button class="button-reject" data-bind="onCancel" type="button">').concat(x._("cancel"),'</button>\n          <button class="button-resolve" data-bind="onSave" type="submit">').concat(x._("submit"),"</button>\n        </div>\n      </form>")}}class Tt extends Et{constructor(t){super(b),this.state=t,this.model.onSetInterval=()=>this.setAutoReloadInterval(),this.model.onConfigEdit=()=>this.showConfigDialog()}init(){return this.setObservers(),this.bindAll(),this}setObservers(){this.onChanged("mapApi",(t=>{a.setCookie("api",t)})),this.onChanged("lang",(t=>{a.setCookie("lang",t),Tt.reload()})),this.onChanged("units",(t=>{a.setCookie("units",t),Tt.reload()})),this.onChanged("interval",(t=>{a.setCookie("interval",t)}))}static reload(){window.location.reload()}setAutoReloadInterval(){const t=parseInt(prompt(x._("newinterval")));isNaN(t)||t===this.model.interval||(this.model.interval=t)}showConfigDialog(){new _t(this).init()}}const Pt="menu-hidden";class Ot extends Et{constructor(t){super({onMenuToggle:null,onShowUserMenu:null,onLogin:null,onLogout:null}),this.state=t,this.model.onMenuToggle=()=>this.toggleSideMenu(),this.model.onShowUserMenu=()=>this.toggleUserMenu(),this.model.onLogin=()=>Ot.login(),this.model.onLogout=()=>Ot.logout(),this.hideUserMenuCallback=t=>this.hideUserMenu(t),this.menuEl=document.querySelector("#menu"),this.userMenuEl=document.querySelector("#user-menu")}init(){return this.bindAll(),this}toggleSideMenu(){this.menuEl.classList.contains(Pt)?this.menuEl.classList.remove(Pt):this.menuEl.classList.add(Pt)}toggleUserMenu(){this.userMenuEl.classList.contains(Pt)?(this.userMenuEl.classList.remove(Pt),window.addEventListener("click",this.hideUserMenuCallback,!0)):this.userMenuEl.classList.add(Pt)}hideUserMenu(t){const e=t.target;this.userMenuEl.classList.add(Pt),window.removeEventListener("click",this.hideUserMenuCallback,!0),"user-menu"!==e.parentElement.id&&t.stopPropagation()}static login(){a.openUrl("login.php".concat(window.location.hash))}static logout(){let t="utils/logout.php";b.requireAuth||(t+="?hash=".concat(window.location.hash.replace("#",""))),a.openUrl(t)}}class It{constructor(t){this.map=null,this.viewModel=t,this.polies=[],this.markers=[],this.popup=null,this.timeoutHandle=0}init(){const t="?".concat(b.googleKey?"key=".concat(b.googleKey,"&"):"","callback=gm_loaded");return Promise.all([It.onScriptLoaded(),a.loadScript("https://maps.googleapis.com/maps/api/js".concat(t),"mapapi_gmaps",It.loadTimeoutMs)]).then((()=>this.initMap()))}static onScriptLoaded(){const t=a.timeoutPromise(It.loadTimeoutMs),e=new Promise(((t,e)=>{window.gm_loaded=()=>{It.gmInitialized=!0,t()},window.gm_authFailure=()=>{It.authError=!0;let t=x._("apifailure","Google Maps");t+="<br><br>"+x._("gmauthfailure"),t+="<br><br>"+x._("gmapilink"),It.gmInitialized&&Ct.error(t),e(new Error(t))},It.authError&&window.gm_authFailure(),It.gmInitialized&&window.gm_loaded()}));return Promise.race([e,t])}initMap(){const t={center:new google.maps.LatLng(b.initLatitude,b.initLongitude),zoom:8,mapTypeId:google.maps.MapTypeId.TERRAIN,scaleControl:!0,controlSize:30};this.map=new google.maps.Map(this.viewModel.mapElement,t),this.popup=new google.maps.InfoWindow,this.popup.addListener("closeclick",(()=>{this.popupClose()})),this.saveState=()=>{this.viewModel.state.mapParams=this.getState()}}cleanup(){this.polies.length=0,this.markers.length=0,this.popup=null,this.map&&this.map.getDiv()&&(this.map.getDiv().innerHTML=""),this.map=null}displayTrack(t,e){if(!t||!t.hasPositions)return Promise.resolve();google.maps.event.clearListeners(this.map,"idle");const s=new Promise((t=>{google.maps.event.addListenerOnce(this.map,"tilesloaded",(()=>{this.map&&(this.saveState(),this.map.addListener("idle",this.saveState)),t()}))})),i={strokeColor:b.strokeColor,strokeOpacity:b.strokeOpacity,strokeWeight:b.strokeWeight};let n;const r=new google.maps.LatLngBounds;if(this.polies.length){n=this.polies[0];for(let t=0;t<this.markers.length;t++)r.extend(this.markers[t].getPosition())}else n=new google.maps.Polyline(i),n.setMap(this.map),this.polies.push(n);const o=n.getPath();let a=this.markers.length;a>0&&this.removePoint(--a);for(let e=a;e<t.length;e++){this.setMarker(e,t);const s=t.positions[e],i=new google.maps.LatLng(s.latitude,s.longitude);t instanceof h&&o.push(i),r.extend(i)}if(e&&(this.map.fitBounds(r),1===t.length)){const t=google.maps.event.addListenerOnce(this.map,"bounds_changed",(function(){this.getZoom()&&this.setZoom(15)}));setTimeout((()=>{google.maps.event.removeListener(t)}),2e3)}return s}clearMap(){if(this.polies)for(let t=0;t<this.polies.length;t++)this.polies[t].setMap(null);if(this.markers)for(let t=0;t<this.markers.length;t++)this.markers[t].setMap(null);this.popup.getMap()&&this.popupClose(),this.popup.setContent(""),this.markers.length=0,this.polies.length=0}static getMarkerIcon(t,e,s){return{anchor:new google.maps.Point(15,35),url:Dt.getSvgSrc(t,e,s)}}setMarker(t,e){const s=e.positions[t],i=new google.maps.Marker({position:new google.maps.LatLng(s.latitude,s.longitude),title:new Date(1e3*s.timestamp).toLocaleString(),map:this.map}),n=s.hasComment()||s.hasImage();let r;r=e.isLastPosition(t)?It.getMarkerIcon(b.colorStop,!0,n):e.isFirstPosition(t)?It.getMarkerIcon(b.colorStart,!0,n):It.getMarkerIcon(n?b.colorExtra:b.colorNormal,!1,n),i.setIcon(r),i.addListener("click",(()=>{this.popupOpen(t,i)})),i.addListener("mouseover",(()=>{this.viewModel.model.markerOver=t})),i.addListener("mouseout",(()=>{this.viewModel.model.markerOver=null})),this.markers.push(i)}removePoint(t){this.markers.length>t&&(this.markers[t].setMap(null),this.markers.splice(t,1),this.polies.length&&this.polies[0].getPath().removeAt(t),this.viewModel.model.markerSelect===t&&this.popupClose())}popupOpen(t,e){this.popup.setContent(this.viewModel.getPopupElement(t)),this.popup.open(this.map,e),this.viewModel.model.markerSelect=t}popupClose(){this.viewModel.model.markerSelect=null,this.popup.close()}animateMarker(t){this.popup.getMap()&&(this.popupClose(),clearTimeout(this.timeoutHandle));const e=this.markers[t].getIcon();this.markers[t].setIcon(It.getMarkerIcon(b.colorHilite,!1,!1)),this.markers[t].setAnimation(google.maps.Animation.BOUNCE),this.timeoutHandle=setTimeout((()=>{this.markers[t].setIcon(e),this.markers[t].setAnimation(null)}),2e3)}getBounds(){const t=this.map.getBounds(),e=t.getSouthWest().lat(),s=t.getSouthWest().lng(),i=t.getNorthEast().lat();return[s,e,t.getNorthEast().lng(),i]}zoomToExtent(){const t=new google.maps.LatLngBounds;for(let e=0;e<this.markers.length;e++)t.extend(this.markers[e].getPosition());this.map.fitBounds(t)}zoomToBounds(t){const e=new google.maps.LatLng(t[1],t[0]),s=new google.maps.LatLng(t[3],t[2]),i=new google.maps.LatLngBounds(e,s);this.map.fitBounds(i)}isPositionVisible(t){return!(t>=this.markers.length)&&this.map.getBounds().contains(this.markers[t].getPosition())}centerToPosition(t){t<this.markers.length&&this.map.setCenter(this.markers[t].getPosition())}updateSize(){}setTrackDefaultStyle(){}setTrackGradientStyle(t,e,s){}static get loadTimeoutMs(){return 1e4}updateState(t){this.map.setCenter({lat:t.center[0],lng:t.center[1]}),this.map.setZoom(t.zoom)}getState(){if(this.map){const t=this.map.getCenter();return{center:[t.lat(),t.lng()],zoom:this.map.getZoom(),rotation:0}}return null}saveState(){}}let jt;It.authError=!1,It.gmInitialized=!1;class Nt{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;this.map=null,this.viewModel=t,this.layerTrack=null,this.layerMarkers=null,this.selectedLayer=null,this.markerStyles=null,this.popup=null,e&&(jt=e)}init(){a.addCss("css/dist/ol.css","ol_css");return(jt?Promise.resolve():n.e(521).then(n.bind(n,412)).then((t=>{jt=t}))).then((()=>{this.initMap(),this.initLayers(),this.initStyles(),this.initPopups()}))}initMap(){const t=[new jt.control.Zoom,new jt.control.Rotate,new jt.control.ScaleLine],e=new jt.View({center:jt.proj.fromLonLat([b.initLongitude,b.initLatitude]),zoom:8});this.map=new jt.Map({target:this.viewModel.mapElement,controls:t,view:e}),this.map.on("pointermove",(t=>{const e=this.map.forEachFeatureAtPixel(t.pixel,((t,e)=>"Markers"===e.get("name")?t:null));if(e){this.map.getTargetElement().style.cursor="pointer";const t=e.getId();t!==this.viewModel.model.markerOver&&(this.viewModel.model.markerOver=t)}else this.map.getTargetElement().style.cursor="",this.viewModel.model.markerOver=null})),this.saveState=()=>{this.viewModel.state.mapParams=this.getState()}}initLayers(){const t=new jt.layer.TileLayer({name:"OpenStreetMap",visible:!0,source:new jt.source.OSM});this.map.addLayer(t),this.selectedLayer=t;for(const t of b.olLayers){const e=new jt.layer.TileLayer({name:t.name,visible:!1,source:new jt.source.XYZ({url:t.url})});this.map.addLayer(e),t.priority&&(this.selectedLayer.setVisible(!1),this.selectedLayer=e,this.selectedLayer.setVisible(!0))}this.layerTrack=new jt.layer.VectorLayer({name:"Track",type:"data",source:new jt.source.Vector}),this.layerMarkers=new jt.layer.VectorLayer({name:"Markers",type:"data",source:new jt.source.Vector}),this.map.addLayer(this.layerTrack),this.map.addLayer(this.layerMarkers),this.initLayerSwitcher()}initStyles(){const t=[.5,1];this.markerStyles={start:new jt.style.Style({image:new jt.style.Icon({anchor:t,src:Dt.getSvgSrc(b.colorStart,!0)})}),stop:new jt.style.Style({image:new jt.style.Icon({anchor:t,src:Dt.getSvgSrc(b.colorStop,!0)})}),normal:new jt.style.Style({image:new jt.style.Icon({anchor:t,opacity:.7,src:Dt.getSvgSrc(b.colorNormal,!1)})}),extra:new jt.style.Style({image:new jt.style.Icon({anchor:t,src:Dt.getSvgSrc(b.colorExtra,!1,!0)})}),startExtra:new jt.style.Style({image:new jt.style.Icon({anchor:t,src:Dt.getSvgSrc(b.colorStart,!0,!0)})}),stopExtra:new jt.style.Style({image:new jt.style.Icon({anchor:t,src:Dt.getSvgSrc(b.colorStop,!0,!0)})}),hilite:new jt.style.Style({image:new jt.style.Icon({anchor:t,src:Dt.getSvgSrc(b.colorHilite,!1)})})}}setTrackDefaultStyle(){const t=new jt.style.Style({stroke:new jt.style.Stroke({color:a.hexToRGBA(b.strokeColor,b.strokeOpacity),width:b.strokeWeight})});this.layerTrack.setStyle(t)}getGradientStyle(t,e,s){const i=this.map.getPixelFromCoordinate(e[0]),n=this.map.getPixelFromCoordinate(e[1]),r=window.devicePixelRatio,o=i[0]*r,a=i[1]*r,l=n[0]*r,c=n[1]*r,h=t.createLinearGradient(o,a,l,c);return h.addColorStop(0,s[0]),h.addColorStop(1,s[1]),new jt.style.Style({geometry:new jt.geom.LineString(e),stroke:new jt.style.Stroke({color:h,width:2*b.strokeWeight})})}setTrackGradientStyle(t,e,s){const i=s.minValue,n=s.maxValue,r=s.minColor,o=s.maxColor;if(t.length<2||n<i)return void this.setTrackDefaultStyle();const l=document.createElement("canvas",{alpha:!1,desynchronized:!0}).getContext("2d");this.layerTrack.setStyle((s=>{const c=[new jt.style.Style({stroke:new jt.style.Stroke({color:"grey",width:2*b.strokeWeight+2})})],h=s.getGeometry();if(i===n)return c.push(new jt.style.Style({geometry:h,stroke:new jt.style.Stroke({color:a.getScaleColor(r,o,.5),width:2*b.strokeWeight})})),c;let u=t.positions[0];const d=null!==u[e]?u[e]:0;let p=a.getScaleColor(r,o,(d-i)/(n-i)),m=1;return h.forEachSegment(((s,h)=>{let d;u=t.positions[m],d=null!==u[e]?a.getScaleColor(r,o,(u[e]-i)/(n-i)):p,c.push(this.getGradientStyle(l,[s,h],[p,d])),p=d,m++})),c}))}initPopups(){const t=document.createElement("div");t.id="popup-container",t.className="ol-popup";const e=document.createElement("div");e.id="popup-content",t.appendChild(e);const s=document.createElement("a");s.className="ol-popup-closer",t.appendChild(s),this.popup=new jt.Overlay({element:t,autoPan:!0,autoPanAnimation:{duration:250}}),this.map.addOverlay(this.popup),s.onclick=()=>(this.popupClose(),s.blur(),!1),this.map.on("click",(t=>{const e=t.coordinate,s=this.map.forEachFeatureAtPixel(t.pixel,((t,e)=>"Markers"===e.get("name")?t:null));s?this.popupOpen(s.getId(),e):this.popupClose()}))}popupOpen(t,e){this.popup.getElement().firstElementChild.innerHTML="",this.popup.getElement().firstElementChild.appendChild(this.viewModel.getPopupElement(t)),this.popup.setPosition(e),this.viewModel.model.markerSelect=t}popupClose(){this.popup&&(this.popup.setPosition(void 0),this.popup.getElement().firstElementChild.innerHTML=""),this.viewModel.model.markerSelect=null}switchLayer(t){this.map.getLayers().forEach((e=>{e.get("name")===t&&("data"===e.get("type")?e.getVisible()?e.setVisible(!1):e.setVisible(!0):(this.selectedLayer.setVisible(!1),this.selectedLayer=e,e.setVisible(!0)))}))}initLayerSwitcher(){const t=document.createElement("div");t.id="switcher",t.className="ol-control",document.body.appendChild(t);const e=document.createElement("div");e.id="switcher-content",e.className="ol-layerswitcher",t.appendChild(e);const s=document.createElement("a");s.className="ol-popup-closer",t.appendChild(s),this.map.getLayers().forEach((t=>{const s=document.createElement("label");s.innerHTML=t.get("name"),e.appendChild(s);const i=document.createElement("input");"data"===t.get("type")?(i.type="checkbox",s.className="ol-datalayer"):i.type="radio",i.name="layer",i.value=t.get("name"),i.onclick=t=>{const e=t.target;this.switchLayer(e.value)},t.getVisible()&&(i.checked=!0),s.insertBefore(i,s.childNodes[0])}));const i=document.createElement("button"),n=document.createElement("img");n.src="images/layers.svg",n.style.width="60%",i.appendChild(n);const r=()=>{"block"===t.style.display?t.style.display="none":t.style.display="block"};s.addEventListener("click",r,!1),i.addEventListener("click",r,!1),i.addEventListener("touchstart",r,!1);const o=document.createElement("div");o.className="ol-switcher-button ol-unselectable ol-control",o.appendChild(i);const a=new jt.control.Control({element:o});this.map.addControl(a)}cleanup(){this.layerTrack=null,this.layerMarkers=null,this.selectedLayer=null,this.markerStyles=null,a.removeElementById("switcher"),this.map&&this.map.getTargetElement()&&(this.map.getTargetElement().innerHTML=""),this.map=null}displayTrack(t,e){if(!t||!t.hasPositions)return Promise.resolve();this.map.un("moveend",this.saveState);const s=new Promise((t=>{this.map.once("rendercomplete",(()=>{this.map&&(this.saveState(),this.map.on("moveend",this.saveState)),t()}))}));let i=this.layerMarkers?this.layerMarkers.getSource().getFeatures().length:0;i>0&&this.removePoint(--i);for(let e=i;e<t.length;e++)this.setMarker(e,t);if(t instanceof h){let e;if(this.layerTrack&&this.layerTrack.getSource().getFeatures().length)e=this.layerTrack.getSource().getFeatures()[0].getGeometry();else{e=new jt.geom.LineString([]);const t=new jt.Feature({geometry:e});this.layerTrack.getSource().addFeature(t)}for(let s=i;s<t.length;s++){const i=t.positions[s];e.appendCoordinate(jt.proj.fromLonLat([i.longitude,i.latitude]))}}let n=this.layerMarkers.getSource().getExtent();return e&&(n=this.fitToExtent(n)),this.setZoomToExtent(n),s}setZoomToExtent(t){this.map.getControls().forEach((t=>{t instanceof jt.control.ZoomToExtent&&this.map.removeControl(t)})),this.map.addControl(new jt.control.ZoomToExtent({extent:t,label:Nt.getExtentImg()}))}fitToExtent(t){return this.map.getView().fit(t,{padding:Nt.TRACK_PADDING,maxZoom:Nt.ZOOM_MAX}),this.map.getView().calculateExtent()}isPositionVisible(t){const e=this.map.getView().calculateExtent(),s=this.layerMarkers.getSource().getFeatureById(t).getGeometry();return!!s&&jt.extent.containsCoordinate(e,s.getCoordinates())}centerToPosition(t){const e=this.layerMarkers.getSource().getFeatureById(t).getGeometry();e&&("Setting center to position ".concat(t),this.map.getView().setCenter(e.getCoordinates()))}clearMap(){this.popupClose(),this.layerTrack&&this.layerTrack.getSource().clear(),this.layerMarkers&&this.layerMarkers.getSource().clear()}getMarkerStyle(t,e){const s=e.positions[t];let i=this.markerStyles.normal;return s.hasComment()||s.hasImage()?i=e.isLastPosition(t)?this.markerStyles.stopExtra:e.isFirstPosition(t)?this.markerStyles.startExtra:this.markerStyles.extra:e.isLastPosition(t)?i=this.markerStyles.stop:e.isFirstPosition(t)&&(i=this.markerStyles.start),i}setMarker(t,e){const s=e.positions[t],i=new jt.Feature({geometry:new jt.geom.Point(jt.proj.fromLonLat([s.longitude,s.latitude]))}),n=this.getMarkerStyle(t,e);i.setStyle(n),i.setId(t),this.layerMarkers.getSource().addFeature(i)}removePoint(t){const e=this.layerMarkers.getSource().getFeatureById(t);if(e){if(this.layerMarkers.getSource().removeFeature(e),this.layerTrack){const e=this.layerTrack.getSource().getFeatures()[0].getGeometry(),s=e.getCoordinates();s.splice(t,1),e.setCoordinates(s)}this.viewModel.model.markerSelect===t&&this.popupClose()}}animateMarker(t){const e=this.layerMarkers.getSource().getFeatureById(t),s=e.getStyle();e.setStyle(this.markerStyles.hilite),setTimeout((()=>e.setStyle(s)),2e3)}getBounds(){const t=this.map.getView().calculateExtent(),e=jt.proj.toLonLat([t[0],t[1]]),s=jt.proj.toLonLat([t[2],t[3]]);return[e[0],e[1],s[0],s[1]]}zoomToExtent(){this.fitToExtent(this.layerMarkers.getSource().getExtent())}zoomToBounds(t){const e=jt.proj.fromLonLat([t[0],t[1]]),s=jt.proj.fromLonLat([t[2],t[3]]);this.map.getView().fit([e[0],e[1],s[0],s[1]])}updateSize(){this.map.updateSize()}static getExtentImg(){const t=document.createElement("img");return t.src="images/extent.svg",t.style.width="60%",t}updateState(t){this.map.getView().setCenter(t.center),this.map.getView().setZoom(t.zoom),this.map.getView().setRotation(t.rotation)}getState(){const t=this.map?this.map.getView():null;return t?{center:t.getCenter(),zoom:t.getZoom(),rotation:t.getRotation()}:null}saveState(){}}Nt.ZOOM_MAX=20,Nt.TRACK_PADDING=[40,10,10,10];const Ut="hidden";class Vt extends Et{constructor(t,e){super({onPositionDelete:null,onPositionUpdate:null,onCancel:null,comment:null,image:null,onImageDelete:null}),this.state=t,this.positionIndex=e,this.position=this.state.currentTrack.positions[e],this.model.comment=this.position.hasComment()?this.position.comment:"",this.model.image=this.position.image,this.model.onPositionDelete=()=>this.onPositionDelete(),this.model.onPositionUpdate=()=>this.onPositionUpdate(),this.model.onCancel=()=>this.onCancel(),this.model.onImageDelete=()=>this.onImageDelete(),this.onChanged("image",(t=>{t&&t!==this.position.image&&this.readImage()}))}init(){const t=this.getHtml();this.dialog=new Mt(t),this.dialog.show(),this.bindAll(this.dialog.element),this.previewEl=this.getBoundElement("imagePreview"),this.fileEl=this.getBoundElement("image"),this.imageDeleteEl=this.getBoundElement("onImageDelete"),this.initReader()}initReader(){this.reader=new FileReader,this.reader.addEventListener("load",(()=>{this.showThumbnail()}),!1),this.reader.addEventListener("error",(()=>{this.model.image=this.position.image}),!1)}readImage(){const t=this.fileEl.files[0];if(t){if(t.size>b.uploadMaxSize)return Ct.error(x._("isizefailure",b.uploadMaxSize)),void(this.model.image=this.position.image);this.reader.readAsDataURL(t)}}showThumbnail(){this.previewEl.onload=()=>this.toggleImage(),this.previewEl.onerror=()=>{Ct.error(x._("iuploadfailure")),this.model.image=this.position.image},this.previewEl.src=this.reader.result}toggleImage(){this.previewEl.classList.contains(Ut)?(this.previewEl.classList.remove(Ut),this.imageDeleteEl.classList.remove(Ut),this.fileEl.classList.add(Ut)):(this.previewEl.classList.add(Ut),this.imageDeleteEl.classList.add(Ut),this.fileEl.classList.remove(Ut))}onImageDelete(){this.model.image=null,this.toggleImage()}getHtml(){return'<div class="red-button button-resolve"><b><a data-bind="onPositionDelete">'.concat(x._("delposition"),"</a></b></div>\n      <div>").concat(x._("editingposition",this.positionIndex+1,"<b>".concat(a.htmlEncode(this.position.trackname),"</b>")),'</div>\n      <div style="clear: both; padding-bottom: 1em;"></div>\n      <form id="positionForm">\n        <label><b>').concat(x._("comment"),'</b></label><br>\n        <textarea style="width:100%;" maxlength="255" rows="5" placeholder="').concat(x._("comment"),'" name="comment" \n        data-bind="comment" autofocus>').concat(a.htmlEncode(this.model.comment),"</textarea>\n        <br><br>\n        <label><b>").concat(x._("image"),'</b></label><br>\n        <input type="file" name="image" data-bind="image" accept="image/png, image/jpeg, image/gif, image/bmp"').concat(this.position.hasImage()?' class="hidden"':"",'>\n        <img style="max-width:50px; max-height:50px" data-bind="imagePreview" ').concat(this.position.hasImage()?'src="'.concat(this.position.getImagePath(),'"'):'class="hidden"','>\n        <a data-bind="onImageDelete" ').concat(this.position.hasImage()?"":' class="hidden"',">").concat(x._("delimage"),'</a>\n        <div class="buttons">\n          <button class="button-reject" data-bind="onCancel" type="button">').concat(x._("cancel"),'</button>\n          <button class="button-resolve" data-bind="onPositionUpdate" type="submit">').concat(x._("submit"),"</button>\n        </div>\n      </form>")}onPositionDelete(){Mt.isConfirmed(x._("positiondelwarn",this.positionIndex+1,a.htmlEncode(this.position.trackname)))&&this.position.delete().then((()=>{const t=this.state.currentTrack;this.state.currentTrack=null,t.positions.splice(this.positionIndex,1),t.recalculatePositions(),this.state.currentTrack=t,this.dialog.destroy()})).catch((t=>{Ct.error("".concat(x._("actionfailure"),"\n").concat(t.message),t)}))}updateImage(){let t=Promise.resolve();return this.model.image!==this.position.image&&(t=null===this.model.image?this.position.imageDelete():this.position.imageAdd(this.fileEl.files[0])),t}onPositionUpdate(){this.model.comment.trim(),this.validate()&&(this.position.comment=this.model.comment,this.updateImage().then((()=>this.position.save())).then((()=>{i.forceUpdate(this.state,"currentTrack"),this.dialog.destroy()})).catch((t=>{Ct.error("".concat(x._("actionfailure"),"\n").concat(t.message),t)})))}onCancel(){this.dialog.destroy()}validate(){return!(this.model.comment===this.position.comment&&this.model.image===this.position.image)}}class Dt extends Et{constructor(t){super({markerOver:null,markerSelect:null,onMenuToggle:null,speedVisible:!1,altitudeVisible:!1}),this.state=t,this.mapElement=document.querySelector("#map-canvas"),this.speedEl=this.getBoundElement("speedVisible"),this.altitudeEl=this.getBoundElement("altitudeVisible"),this.styleEl=this.getBoundElement("trackColor"),this.savedBounds=null,this.api=null}init(){return this.bindAll(),this.setObservers(),this}loadMapAPI(t){let e=this.api;if(this.api=null,e){try{this.savedBounds=e.getBounds()}catch(t){this.savedBounds=null}e.cleanup()}e=this.getApi(t),e.init().then((()=>{this.api=e,this.onReady()})).catch((e=>{let s=x._("apifailure",t);e&&e.message&&(s+=" (".concat(e.message,")")),Ct.error(s,e),b.mapApi="gmaps"===t?"openlayers":"gmaps"}))}getApi(t){return"gmaps"===t?new It(this):new Nt(this)}onReady(){if(this.state.currentTrack){let t=!0;this.savedBounds&&(this.api.zoomToBounds(this.savedBounds),t=!1),this.displayTrack(this.state.currentTrack,t)}}setObservers(){b.onChanged("mapApi",(t=>{this.loadMapAPI(t),this.toggleStyleOptions(),this.toggleStyleMenu()})),this.state.onChanged("currentTrack",(t=>{this.api&&(this.api.clearMap(),t&&(i.observe(t,"positions",(()=>{this.displayTrack(t,!1),t instanceof h&&!this.api.isPositionVisible(t.length-1)&&this.api.centerToPosition(t.length-1),this.toggleStyleOptions()})),this.displayTrack(t,!0)),this.toggleStyleOptions())})),this.state.onChanged("history",(()=>{const t=this.state.history;this.api&&t&&!t.trackId&&(t.mapApi?b.mapApi=t.mapApi:(t.mapParams?this.api.updateState(t.mapParams):this.api.zoomToExtent(),this.state.history=null))})),this.model.onMenuToggle=()=>this.onMapResize(),this.onChanged("speedVisible",(t=>{t&&(this.model.altitudeVisible=!1),this.setTrackStyle()})),this.onChanged("altitudeVisible",(t=>{t&&(this.model.speedVisible=!1),this.setTrackStyle()}))}displayTrack(t,e){this.state.jobStart(),e&&this.state.history&&this.state.history.mapParams&&(this.api.updateState(this.state.history.mapParams),e=!1),this.state.history=null,this.setTrackStyle(),this.api.displayTrack(t,e).finally((()=>this.state.jobStop()))}onMapResize(){this.api&&this.api.updateSize()}toggleStyleOptions(){const t=this.state.currentTrack;this.speedEl.disabled=!t||!t.hasSpeeds||t.length<=1,this.altitudeEl.disabled=!t||!t.hasAltitudes||t.length<=1}toggleStyleMenu(){"openlayers"===b.mapApi?this.styleEl.style.display="block":this.styleEl.style.display="none"}setTrackStyle(){const t=this.state.currentTrack;this.api&&t&&(this.model.speedVisible&&t.hasSpeeds?this.setSpeedStyle():this.model.altitudeVisible&&t.hasAltitudes?this.setAltitudeStyle():this.api.setTrackDefaultStyle())}setSpeedStyle(){const t=this.state.currentTrack,e={minValue:0,maxValue:t.maxSpeed,minColor:[0,255,0],maxColor:[255,0,0]};this.api.setTrackGradientStyle(t,"speed",e)}setAltitudeStyle(){const t=this.state.currentTrack,e={minValue:t.minAltitude,maxValue:t.maxAltitude,minColor:[0,255,0],maxColor:[255,0,0]};this.api.setTrackGradientStyle(t,"altitude",e)}getPopupElement(t){const e=this.state.currentTrack.positions[t],s=this.state.currentTrack.length,i=this.state.currentTrack.user,n=w.user&&(w.isAdmin||w.user.id===i.id);let r="–––",o="–––";if(e.timestamp>0){const t=a.getTimeString(new Date(1e3*e.timestamp));r=t.date,o="".concat(t.time,'<span class="smaller">').concat(t.zone,"</span>")}let l="";"gps"===e.provider?l=' <img class="icon" alt="'.concat(x._("gps"),'" title="').concat(x._("gps"),'"  src="images/gps_dark.svg">'):"network"===e.provider&&(l=' <img class="icon" alt="'.concat(x._("network"),'" title="').concat(x._("network"),'"  src="images/network_dark.svg">'));let c="";n&&(c='<a id="editposition" class="menu-link" data-bind="onUserAdd">'.concat(x._("editposition"),"</a>"));let h="";this.state.showLatest||(h='<div id="pright">\n        <img class="icon" alt="'.concat(x._("track"),'" src="images/stats_blue.svg" style="margin-left: 3em;"><br>\n        <img class="icon" alt="').concat(x._("ttime"),'" title="').concat(x._("ttime"),'" src="images/time_blue.svg"> ').concat(x.getLocaleDuration(e.totalSeconds),'<br>\n        <img class="icon" alt="').concat(x._("aspeed"),'" title="').concat(x._("aspeed"),'" src="images/speed_blue.svg"> ').concat(x.getLocaleSpeed(e.totalSpeed,!0),'<br>\n        <img class="icon" alt="').concat(x._("tdistance"),'" title="').concat(x._("tdistance"),'" src="images/distance_blue.svg"> ').concat(x.getLocaleDistanceMajor(e.totalMeters,!0),"<br>\n        </div>"));const u='<div id="pheader">\n        <div><img alt="'.concat(x._("user"),'" title="').concat(x._("user"),'" src="images/user_dark.svg"> ').concat(a.htmlEncode(e.username),'</div>\n        <div><img alt="').concat(x._("track"),'" title="').concat(x._("track"),'" src="images/route_dark.svg"> ').concat(a.htmlEncode(e.trackname),'</div>\n        </div>\n        <div id="pbody">\n        ').concat(e.hasComment()?'<div id="pcomments">'.concat(a.htmlEncode(e.comment).replace(/\n/,"<br>"),"</div>"):"","\n        ").concat(e.hasImage()?'<div id="pimage"><img src="uploads/'.concat(e.image,'" alt="image"></div>'):"",'\n        <div id="pleft">\n        <img class="icon" alt="').concat(x._("time"),'" title="').concat(x._("time"),'" src="images/calendar_dark.svg"> ').concat(r,'<br>\n        <img class="icon" alt="').concat(x._("time"),'" title="').concat(x._("time"),'" src="images/clock_dark.svg"> ').concat(o,"<br>\n        ").concat(null!==e.speed?'<img class="icon" alt="'.concat(x._("speed"),'" title="').concat(x._("speed"),'" src="images/speed_dark.svg">').concat(x.getLocaleSpeed(e.speed,!0),"<br>"):"","\n        ").concat(null!==e.altitude?'<img class="icon" alt="'.concat(x._("altitude"),'" title="').concat(x._("altitude"),'" src="images/altitude_dark.svg">').concat(x.getLocaleAltitude(e.altitude,!0),"<br>"):"","\n        ").concat(null!==e.accuracy?'<img class="icon" alt="'.concat(x._("accuracy"),'" title="').concat(x._("accuracy"),'" src="images/accuracy_dark.svg">').concat(x.getLocaleAccuracy(e.accuracy,!0)).concat(l,"<br>"):"","\n        ").concat(null!==e.bearing?'<img class="icon" alt="'.concat(x._("bearing"),'" title="').concat(x._("bearing"),'" src="images/bearing.svg" style="transform: rotate(').concat(e.bearing,'deg) scale(1.2);">').concat(e.bearing,"°<br>"):"",'\n        <img class="icon" alt="').concat(x._("position"),'" title="').concat(x._("position"),'" src="images/position.svg">').concat(x.getLocaleCoordinates(e),"<br>\n        </div>").concat(h,'</div>\n        <div id="pfooter"><div>').concat(x._("pointof",t+1,s),"</div><div>").concat(c,"</div></div>"),d=document.createElement("div");if(d.setAttribute("id","popup"),d.innerHTML=u,e.hasImage()){d.querySelector("#pimage img").onclick=()=>{const t=new Mt('<img src="'.concat(e.getImagePath(),'" alt="image">'));t.element.querySelector("#modal-close").onclick=()=>t.destroy(),t.element.classList.add("image"),t.show()}}if(n){d.querySelector("#editposition").onclick=()=>{new Vt(this.state,t).init()}}return d}static getMarkerPath(t){return t?"M15,34.911c0,0,0.359-3.922,1.807-8.588c0.414-1.337,1.011-2.587,2.495-4.159c1.152-1.223,3.073-2.393,3.909-4.447c1.681-6.306-3.676-9.258-8.211-9.258c-4.536,0-9.893,2.952-8.211,9.258c0.836,2.055,2.756,3.225,3.91,4.447c1.484,1.572,2.08,2.822,2.495,4.159C14.64,30.989,15,34.911,15,34.911z M18,15.922c0,1.705-1.342,3.087-2.999,3.087c-1.657,0-3-1.382-3-3.087c0-1.704,1.343-3.086,3-3.086C16.658,12.836,18,14.218,18,15.922z":"M14.999,34.911c0,0,0.232-1.275,1.162-4.848c0.268-1.023,0.652-1.98,1.605-3.184c0.742-0.937,1.975-1.832,2.514-3.404c1.082-4.828-2.363-7.088-5.281-7.088c-2.915,0-6.361,2.26-5.278,7.088c0.538,1.572,1.771,2.468,2.514,3.404c0.953,1.203,1.337,2.16,1.604,3.184C14.77,33.635,14.999,34.911,14.999,34.911z"}static getMarkerExtra(t){const e=t?"M28.232,10.942":"M25.486,18.141";return'<path fill="none" stroke="red" stroke-width="2" d="'.concat(t?"M26.074,13.517":"M23.328,20.715",'c0-3.961-3.243-7.167-7.251-7.167"/>\n            <path fill="none" stroke="red" stroke-width="2" d="').concat(e,'c-0.5-4.028-3.642-7.083-7.724-7.542"/>')}static getSvgSrc(t,e,s){const i='<svg viewBox="0 0 30 35" width="30px" height="35px" xmlns="http://www.w3.org/2000/svg">\n      <g><path stroke="black" fill="'.concat(t,'" d="').concat(Dt.getMarkerPath(e),'"/>').concat(s?Dt.getMarkerExtra(e):"","</g></svg>");return"data:image/svg+xml,".concat(encodeURIComponent(i))}}class Bt extends Et{constructor(t){super({onTrackDelete:null,onTrackUpdate:null,onCancel:null,trackname:""}),this.track=t.state.currentTrack,this.trackVM=t,this.model.onTrackDelete=()=>this.onTrackDelete(),this.model.onTrackUpdate=()=>this.onTrackUpdate(),this.model.onCancel=()=>this.onCancel()}init(){const t=this.getHtml();this.dialog=new Mt(t),this.dialog.show(),this.bindAll(this.dialog.element)}getHtml(){return'<div class="red-button button-resolve"><b><a data-bind="onTrackDelete">'.concat(x._("deltrack"),"</a></b></div>\n      <div>").concat(x._("editingtrack","<b>".concat(a.htmlEncode(this.track.name),"</b>")),'</div>\n      <div style="clear: both; padding-bottom: 1em;"></div>\n      <form id="trackForm">\n        <label><b>').concat(x._("trackname"),'</b></label>\n        <input type="text" placeholder="').concat(x._("trackname"),'" name="trackname" data-bind="trackname" value="').concat(a.htmlEncode(this.track.name),'" required autofocus>\n        <div class="buttons">\n          <button class="button-reject" data-bind="onCancel" type="button">').concat(x._("cancel"),'</button>\n          <button class="button-resolve" data-bind="onTrackUpdate" type="submit">').concat(x._("submit"),"</button>\n        </div>\n      </form>")}onTrackDelete(){Mt.isConfirmed(x._("trackdelwarn",a.htmlEncode(this.track.name)))&&this.track.delete().then((()=>{this.trackVM.onTrackDeleted(),this.dialog.destroy()})).catch((t=>{Ct.error("".concat(x._("actionfailure"),"\n").concat(t.message),t)}))}onTrackUpdate(){this.validate()&&(this.track.setName(this.model.trackname),this.track.saveMeta().then((()=>this.dialog.destroy())).catch((t=>{Ct.error("".concat(x._("actionfailure"),"\n").concat(t.message),t)})))}onCancel(){this.dialog.destroy()}validate(){return this.model.trackname!==this.track.name&&(!!this.model.trackname||(Ct.error(x._("allrequired")),!1))}}class Rt extends Et{constructor(t){super({trackList:[],currentTrackId:"",showLatest:!1,autoReload:!1,inputFile:!1,summary:!1,onReload:null,onExportGpx:null,onExportKml:null,onImportGpx:null,onTrackEdit:null}),this.setClickHandlers();const e=document.querySelector("#track");this.importEl=document.querySelector("#input-file"),this.editEl=this.getBoundElement("onTrackEdit"),this.select=new r(e),this.state=t,this.timerId=0}init(){return this.setObservers(),this.bindAll(),this}setObservers(){this.onChanged("trackList",(t=>{this.select.setOptions(t)})),this.onChanged("currentTrackId",(t=>{this.onTrackSelect(t)})),this.onChanged("inputFile",(t=>{t&&this.onImport()})),this.onChanged("autoReload",(t=>{this.autoReload(t)})),this.onChanged("showLatest",(t=>{this.state.showLatest=t,this.onReload(!0)})),this.state.onChanged("currentUser",(t=>{if(t){this.loadTrackList();w.user&&(w.isAdmin||w.user.id===t.id)&&Rt.setMenuVisible(this.editEl,!0)}else this.model.currentTrackId="",this.model.trackList=[],Rt.setMenuVisible(this.editEl,!1)})),this.state.onChanged("currentTrack",(t=>{this.renderSummary(),t&&i.observe(t,"positions",(()=>{this.renderSummary()}))})),this.state.onChanged("showAllUsers",(t=>{t&&this.loadAllUsersPosition()})),b.onChanged("interval",(()=>{this.timerId&&(this.stopAutoReload(),this.startAutoReload())})),this.state.onChanged("history",(t=>{t&&!t.userId&&t.trackId&&(this.model.currentTrackId=t.trackId.toString())}))}setClickHandlers(){this.model.onReload=()=>this.onReload();const t=t=>()=>{this.state.currentTrack&&this.state.currentTrack.export(t)};this.model.onExportGpx=t("gpx"),this.model.onExportKml=t("kml"),this.model.onImportGpx=()=>this.importEl.click(),this.model.onTrackEdit=()=>this.showDialog()}onReload(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.state.showLatest?this.state.showAllUsers?this.loadAllUsersPosition():this.state.currentUser&&this.onUserLastPosition():this.state.currentTrack instanceof h?this.onTrackUpdate(t):this.state.currentTrack instanceof c?this.state.currentTrack=null:this.state.currentUser&&this.loadTrackList()}onImport(){const t=this.importEl.parentElement,e=t.elements.MAX_FILE_SIZE.value;this.importEl.files&&1===this.importEl.files.length&&this.importEl.files[0].size>e?Ct.error(x._("isizefailure",e)):w.isAuthenticated?(this.state.jobStart(),h.import(t,w.user).then((t=>{t.length&&(t.length>1&&Ct.toast(x._("imultiple",t.length)),this.model.trackList=t.concat(this.model.trackList),this.model.currentTrackId=t[0].listValue)})).catch((t=>Ct.error("".concat(x._("actionfailure"),"\n").concat(t.message),t))).finally((()=>{this.model.inputFile="",this.state.jobStop()}))):Ct.error(x._("notauthorized"))}onTrackSelect(t){const e=this.model.trackList.find((e=>e.listValue===t));e?e.isEqualTo(this.state.currentTrack)||(this.state.jobStart(),e.fetchPositions().then((()=>{"currentTrack id: ".concat(e.id,", loaded ").concat(e.length," positions"),this.state.currentTrack=e,this.model.showLatest&&(this.model.showLatest=!1)})).catch((t=>{Ct.error("".concat(x._("actionfailure"),"\n").concat(t.message),t)})).finally((()=>this.state.jobStop()))):this.state.currentTrack=null}onTrackUpdate(t){t&&this.state.currentTrack.clear(),this.state.currentTrack.fetchPositions().catch((t=>{Ct.error("".concat(x._("actionfailure"),"\n").concat(t.message),t)}))}onUserLastPosition(){this.state.currentUser.fetchLastPosition().then((t=>{t&&(this.model.trackList.find((e=>e.listValue===t.listValue))||this.model.trackList.unshift(t),this.state.currentTrack=t,this.model.currentTrackId=t.listValue)})).catch((t=>{Ct.error("".concat(x._("actionfailure"),"\n").concat(t.message),t)}))}loadAllUsersPosition(){this.state.jobStart(),c.fetchLatest().then((t=>{t&&(this.model.trackList=[],this.model.currentTrackId="",this.state.currentTrack=t)})).catch((t=>{Ct.error("".concat(x._("actionfailure"),"\n").concat(t.message),t)})).finally((()=>this.state.jobStop()))}loadTrackList(){this.state.jobStart(),h.fetchList(this.state.currentUser).then((t=>{this.model.trackList=t,t.length?this.state.showLatest?this.onUserLastPosition():this.state.history?this.model.currentTrackId=this.state.history.trackId.toString():this.model.currentTrackId=t[0].listValue:this.model.currentTrackId=""})).catch((t=>{Ct.error("".concat(x._("actionfailure"),"\n").concat(t.message),t)})).finally((()=>this.state.jobStop()))}showDialog(){new Bt(this).init()}onTrackDeleted(){let t=this.model.trackList.indexOf(this.state.currentTrack);this.state.currentTrack=null,-1!==t&&(this.model.trackList.splice(t,1),this.model.trackList.length?(t>=this.model.trackList.length&&(t=this.model.trackList.length-1),this.model.currentTrackId=this.model.trackList[t].listValue):this.model.currentTrackId="")}autoReload(t){t?this.startAutoReload():this.stopAutoReload()}startAutoReload(){this.timerId=setInterval((()=>this.onReload()),1e3*b.interval)}stopAutoReload(){clearInterval(this.timerId),this.timerId=0}static setMenuVisible(t,e){t&&(e?t.classList.remove("menu-hidden"):t.classList.add("menu-hidden"))}renderSummary(){const t=this.state.currentTrack;if(!t||!t.hasPositions)return void(this.model.summary="");const e=t.positions[t.length-1];if(this.state.showLatest){const t=new Date,s=new Date(1e3*e.timestamp),i=a.getTimeString(s),n=s.toDateString()!==t.toDateString()?"".concat(i.date,"<br>"):"",r="".concat(i.time,'<span style="font-weight:normal">').concat(i.zone,"</span>");this.model.summary='\n        <div class="menu-title">'.concat(x._("latest"),":</div>\n        ").concat(n,"\n        ").concat(r)}else{let s='\n        <div class="menu-title">'.concat(x._("summary"),'</div>\n        <div><img class="icon" alt="').concat(x._("tdistance"),'" title="').concat(x._("tdistance"),'" src="images/distance.svg"> ').concat(x.getLocaleDistanceMajor(e.totalMeters,!0),'</div>\n        <div><img class="icon" alt="').concat(x._("ttime"),'" title="').concat(x._("ttime"),'" src="images/time.svg"> ').concat(x.getLocaleDuration(e.totalSeconds),"</div>");if(e.totalSeconds>0&&(s+='\n          <div><img class="icon" alt="'.concat(x._("aspeed"),'" title="').concat(x._("aspeed"),'" src="images/speed.svg"><b>&#10547;</b> ').concat(x.getLocaleSpeed(e.totalMeters/e.totalSeconds,!0),"</div>")),t.hasSpeeds&&(s+='<div><img class="icon" alt="'.concat(x._("speed"),'" title="').concat(x._("speed"),'" src="images/speed.svg"><b>&#10138;</b> ').concat(x.getLocaleSpeed(t.maxSpeed,!0),"</div>")),t.hasAltitudes){let e="".concat(x.getLocaleAltitude(t.maxAltitude,!0));t.minAltitude!==t.maxAltitude&&(e="".concat(x.getLocaleAltitude(t.minAltitude),"&ndash;").concat(e)),s+='<div><img class="icon" alt="'.concat(x._("altitude"),'" title="').concat(x._("altitude"),'" src="images/altitude.svg"> ').concat(e,"</div>")}this.model.summary=s}}}class zt extends Et{constructor(t,e){super({onUserDelete:null,onUserUpdate:null,onPassChange:null,onUserAdd:null,onCancel:null,passVisibility:!1,login:null,password:null,password2:null,oldPassword:null,admin:!1}),this.user=t.state.currentUser,this.type=e,this.userVM=t,this.model.onUserDelete=()=>this.onUserDelete(),this.model.onUserUpdate=()=>this.onUserUpdate(),this.model.onPassChange=()=>this.onPassChange(),this.model.onUserAdd=()=>this.onUserAdd(),this.model.onCancel=()=>this.onCancel()}init(){const t=this.getHtml();this.dialog=new Mt(t),this.dialog.show(),this.bindAll(this.dialog.element);const e=this.getBoundElement("passInput");e&&this.onChanged("passVisibility",(()=>{"none"===e.style.display?e.style.display="block":e.style.display="none"}))}onUserDelete(){Mt.isConfirmed(x._("userdelwarn",a.htmlEncode(this.user.login)))&&this.user.delete().then((()=>{this.userVM.onUserDeleted(),this.dialog.destroy()})).catch((t=>{Ct.error("".concat(x._("actionfailure"),"\n").concat(t.message),t)}))}onUserUpdate(){if(this.validate()){const t=this.model.passVisibility?this.model.password:null;this.user.modify(this.model.admin,t).then((()=>this.dialog.destroy())).catch((t=>{Ct.error("".concat(x._("actionfailure"),"\n").concat(t.message),t)}))}}onPassChange(){this.model.passVisibility=!0,this.validate()&&w.user.setPassword(this.model.password,this.model.oldPassword).then((()=>this.dialog.destroy())).catch((t=>{Ct.error("".concat(x._("actionfailure"),"\n").concat(t.message),t)}))}onUserAdd(){this.model.passVisibility=!0,this.validate()&&u.add(this.model.login,this.model.password,this.model.admin).then((t=>{this.userVM.onUserAdded(t),this.dialog.destroy()})).catch((t=>{Ct.error("".concat(x._("actionfailure"),"\n").concat(t.message),t)}))}onCancel(){this.dialog.destroy()}validate(){if("add"===this.type){if(!this.model.login)return Ct.error(x._("allrequired")),!1}else if("pass"===this.type&&!this.model.oldPassword)return Ct.error(x._("allrequired")),!1;if(this.model.passVisibility){if(!this.model.password||!this.model.password2)return Ct.error(x._("allrequired")),!1;if(this.model.password!==this.model.password2)return Ct.error(x._("passnotmatch")),!1;if(!b.validPassStrength(this.model.password))return Ct.error(x.getLocalePassRules()),!1}return!0}getHtml(){let t,e,s="",i="";switch(this.type){case"add":t="onUserAdd",i="<label><b>".concat(x._("username"),'</b></label>\n        <input type="text" placeholder="').concat(x._("usernameenter"),'" name="login" data-bind="login" required autofocus>'),e="<label><b>".concat(x._("password"),'</b></label>\n        <input type="password" placeholder="').concat(x._("passwordenter"),'" name="password" data-bind="password" required>\n        <label><b>').concat(x._("passwordrepeat"),'</b></label>\n        <input type="password" placeholder="').concat(x._("passwordenter"),'" name="password2" data-bind="password2" required>\n        <label><b>').concat(x._("admin"),'</b></label>\n        <input type="checkbox" name="admin" data-bind="admin">');break;case"edit":t="onUserUpdate",s='<div class="red-button button-resolve"><b><a data-bind="onUserDelete">'.concat(x._("deluser"),"</a></b></div>\n        <div>").concat(x._("editinguser","<b>".concat(a.htmlEncode(this.user.login),"</b>")),'</div>\n        <div style="clear: both; padding-bottom: 1em;"></div>'),e="<label><b>".concat(x._("changepass"),'</b></label>\n        <input type="checkbox" name="changepass" data-bind="passVisibility"><br>\n        <div style="display: none;" data-bind="passInput">\n          <label><b>').concat(x._("password"),'</b></label>\n          <input type="password" placeholder="').concat(x._("passwordenter"),'" name="password" data-bind="password" required autofocus>\n          <label><b>').concat(x._("passwordrepeat"),'</b></label>\n          <input type="password" placeholder="').concat(x._("passwordenter"),'" name="password2" data-bind="password2" required>\n        </div>\n        <label><b>').concat(x._("admin"),'</b></label>\n        <input type="checkbox" name="admin" data-bind="admin" ').concat(this.user.isAdmin?"checked":"",">");break;case"pass":t="onPassChange",e="<label><b>".concat(x._("oldpassword"),'</b></label>\n        <input type="password" placeholder="').concat(x._("passwordenter"),'" name="old-password" data-bind="oldPassword" required autofocus>\n        <label><b>').concat(x._("newpassword"),'</b></label>\n        <input type="password" placeholder="').concat(x._("passwordenter"),'" name="password" data-bind="password" required>\n        <label><b>').concat(x._("newpasswordrepeat"),'</b></label>\n        <input type="password" placeholder="').concat(x._("passwordenter"),'" name="password2" data-bind="password2" required>');break;default:throw new Error("Unknown dialog type: ".concat(this.type))}return"".concat(s,'\n      <form id="userForm">\n        ').concat(i,"\n        ").concat(e,'\n        <div class="buttons">\n          <button class="button-reject" type="button" data-bind="onCancel">').concat(x._("cancel"),'</button>\n          <button class="button-resolve" type="submit" data-bind="').concat(t,'">').concat(x._("submit"),"</button>\n        </div>\n      </form>")}}class Ft extends Et{constructor(t){super({userList:[],currentUserId:"0",onUserEdit:null,onUserAdd:null,onPasswordChange:null}),this.setClickHandlers();const e=document.querySelector("#user");this.editEl=this.getBoundElement("onUserEdit"),this.select=new r(e,x._("suser"),"- ".concat(x._("allusers")," -")),this.state=t}setClickHandlers(){this.model.onUserEdit=()=>this.showDialog("edit"),this.model.onUserAdd=()=>this.showDialog("add"),this.model.onPasswordChange=()=>this.showDialog("pass")}init(){return this.setObservers(this.state),this.bindAll(),u.fetchList().then((t=>{if(this.model.userList=t,t.length){let e=t[0].listValue;if(this.state.history)e=this.state.history.userId.toString();else if(w.isAuthenticated){const t=this.model.userList.find((t=>t.listValue===w.user.listValue));t&&(e=t.listValue)}this.model.currentUserId=e}})).catch((t=>{Ct.error("".concat(x._("actionfailure"),"\n").concat(t.message),t)})),this}setObservers(t){this.onChanged("userList",(t=>{this.select.setOptions(t)})),this.onChanged("currentUserId",(t=>{this.state.showAllUsers=t===r.allValue,this.state.currentUser=this.model.userList.find((e=>e.listValue===t))||null,Ft.setMenuVisible(this.editEl,null!==this.state.currentUser&&!this.state.currentUser.isEqualTo(w.user))})),t.onChanged("showLatest",(t=>{t?this.select.showAllOption():this.select.hideAllOption()})),t.onChanged("history",(t=>{t&&t.userId&&(this.model.currentUserId=t.userId.toString())}))}showDialog(t){new zt(this,t).init()}onUserAdded(t){this.model.userList.push(t),this.model.userList.sort(((t,e)=>t.login>e.login?1:-1))}onUserDeleted(){let t=this.model.userList.indexOf(this.state.currentUser);this.state.currentUser=null,-1!==t&&(this.model.userList.splice(t,1),this.model.userList.length?(t>=this.model.userList.length&&(t=this.model.userList.length-1),this.model.currentUserId=this.model.userList[t].listValue):this.model.currentUserId="0")}static setMenuVisible(t,e){t&&(e?t.classList.remove("menu-hidden"):t.classList.add("menu-hidden"))}}class Ht{constructor(t){this.state=t,this.skipPush=!1}init(){return this.state.onChanged("mapParams",(()=>this.pushState())),window.addEventListener("popstate",(t=>{if(null===t.state)return;const e=this.state.currentTrack,s=this.state.currentUser,i={title:t.state.title,userId:s&&s.id===t.state.userId?null:t.state.userId,trackId:e&&e.id===t.state.trackId?null:t.state.trackId,mapApi:b.mapApi===t.state.mapApi?null:t.state.mapApi,mapParams:t.state.mapParams};this.onPop(i),this.skipPush=!0})),this}static parseHash(){return Ht.parse(window.location.hash)}static parse(t){const e=t.replace("#","").split("/");e.reverse();const s=parseInt(e.pop());if(!isNaN(s)){let t="openlayers";"g"===e.pop()&&(t="gmaps");let i=null;return e.length>=4&&(i={},i.center=[parseFloat(e.pop()),parseFloat(e.pop())],i.zoom=parseFloat(e.pop()),i.rotation=parseFloat(e.pop())),h.getMeta(s).then((e=>{const n=e.userId;return{title:e.name,userId:n,trackId:s,mapApi:t,mapParams:i}})).catch((t=>("Ignoring unknown track ".concat(s," ").concat(t),null)))}return Promise.resolve(null)}onPop(t){t&&"".concat(t.trackId,"/").concat(t.mapApi,"/").concat(t.mapParams),this.state.history=t,t&&(document.title="".concat(x._("title")," ").concat(t.title))}pushState(){if(this.skipPush)return void(this.skipPush=!1);if(null===this.state.currentUser||null===this.state.currentTrack)return;const t=this.getState(),e=window.history.state;if(!e||!a.isDeepEqual(e,t)){const e=Ht.getHash(t);"pushState: ".concat(e," => ").concat(t),window.history.pushState(t,t.title,e),document.title="".concat(x._("title")," ").concat(t.title)}}getState(){return{title:this.state.currentTrack.name,userId:this.state.currentUser.id,trackId:this.state.currentTrack.id,mapApi:b.mapApi,mapParams:this.state.mapParams}}static getHash(t){let e="#".concat(t.trackId,"/").concat(t.mapApi.charAt(0));return t.mapParams&&(e+="/".concat(t.mapParams.center[0],"/").concat(t.mapParams.center[1]),e+="/".concat(t.mapParams.zoom,"/").concat(t.mapParams.rotation)),e}}class qt{constructor(t){this.spinner=null,this.state=t}init(){this.state.onChanged("activeJobs",(t=>{t>0?this.spinner||(this.spinner=Ct.spinner()):this.spinner&&(this.spinner.destroy(),this.spinner=null)}))}}class Xt{constructor(){this.currentTrack=null,this.currentUser=null,this.showLatest=!1,this.showAllUsers=!1,this.activeJobs=0,this.mapParams=null,this.history=null}jobStart(){this.activeJobs++}jobStop(){this.activeJobs--}onChanged(t,e){i.observe(this,t,e)}}const Gt=v.waitForDom(),Yt=y.initialize(),Zt=Ht.parseHash();Promise.all([Gt,Yt,Zt]).then((t=>{!function(t){const e=new Xt,s=new Ht(e),i=new qt(e),n=new Ot(e),r=new Ft(e),o=new Rt(e),a=new Dt(e),l=new At(e),c=new Tt(e);s.init().onPop(t),i.init(),n.init(),r.init(),o.init(),a.init().loadMapAPI(b.mapApi),l.init(),c.init(),a.onChanged("markerOver",(t=>{null!==t?l.onPointOver(t):l.onPointOut()})),a.onChanged("markerSelect",(t=>{null!==t?l.onPointSelect(t):l.onPointUnselect()})),l.onChanged("pointSelected",(t=>{null!==t&&a.api.animateMarker(t)}))}(t[2])})).catch((t=>Ct.error("".concat(x._("actionfailure"),"\n").concat(t))))}()}();
//# sourceMappingURL=bundle.js.map